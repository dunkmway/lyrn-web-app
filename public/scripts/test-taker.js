/*! For license information please see test-taker.js.LICENSE.txt */
(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.d({},{a:()=>Xy});const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++i)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const s=e[t],r=t+1<e.length,o=r?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=s>>2,u=(3&s)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(h=64)),i.push(n[l],n[u],n[h],n[d])}return i.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=e[n++];t[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(r>>10)),t[i++]=String.fromCharCode(56320+(1023&r))}else{const r=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let t=0;t<e.length;){const r=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==r||null==o||null==a||null==c)throw new i;const l=r<<2|o>>4;if(s.push(l),64!==a){const e=o<<4&240|a>>2;if(s.push(e),64!==c){const e=a<<6&192|c;s.push(e)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(e){return function(e){const i=t(e);return n.encodeByteArray(i,!0)}(e).replace(/\./g,"")},r=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&r(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},a=e=>{var t,n;return null===(n=null===(t=o())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},c=()=>{var e;return null===(e=o())||void 0===e?void 0:e.config},l=e=>{var t;return null===(t=o())||void 0===t?void 0:t[`_${e}`]};class u{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function d(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function f(){try{return"object"==typeof indexedDB}catch(e){return!1}}function p(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class m extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,g.prototype.create)}}class g{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],r=s?function(e,t){return e.replace(y,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new m(i,o,n)}}const y=/\{\$([^}]+)}/g;function v(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const n=e[s],r=t[s];if(w(n)&&w(r)){if(!v(n,r))return!1}else if(n!==r)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function w(e){return null!==e&&"object"==typeof e}function b(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function I(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function E(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class T{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=_),void 0===i.error&&(i.error=_),void 0===i.complete&&(i.complete=_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function _(){}const S=1e3,C=2,k=144e5,A=.5;function D(e,t=S,n=C){const i=t*Math.pow(n,e),s=Math.round(A*i*(Math.random()-.5)*2);return Math.min(k,i+s)}function N(e){return e&&e._delegate?e._delegate:e}class R{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const O="[DEFAULT]";class L{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new u;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:O})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=O){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=O){return this.instances.has(e)}getOptions(e=O){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&e(r,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===O?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=O){return this.component?this.component.multipleInstances?e:O:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class x{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new L(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const P=[];var M,F;(F=M||(M={}))[F.DEBUG=0]="DEBUG",F[F.VERBOSE=1]="VERBOSE",F[F.INFO=2]="INFO",F[F.WARN=3]="WARN",F[F.ERROR=4]="ERROR",F[F.SILENT=5]="SILENT";const U={debug:M.DEBUG,verbose:M.VERBOSE,info:M.INFO,warn:M.WARN,error:M.ERROR,silent:M.SILENT},V=M.INFO,q={[M.DEBUG]:"log",[M.VERBOSE]:"log",[M.INFO]:"info",[M.WARN]:"warn",[M.ERROR]:"error"},j=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),s=q[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${i}]  ${e.name}:`,...n)};class B{constructor(e){this.name=e,this._logLevel=V,this._logHandler=j,this._userLogHandler=null,P.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in M))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?U[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,M.DEBUG,...e),this._logHandler(this,M.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,M.VERBOSE,...e),this._logHandler(this,M.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,M.INFO,...e),this._logHandler(this,M.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,M.WARN,...e),this._logHandler(this,M.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,M.ERROR,...e),this._logHandler(this,M.ERROR,...e)}}const $=(e,t)=>t.some((t=>e instanceof t));let z,H;const K=new WeakMap,W=new WeakMap,G=new WeakMap,Q=new WeakMap,J=new WeakMap;let X={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return W.get(e);if("objectStoreNames"===t)return e.objectStoreNames||G.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Z(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Y(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(H||(H=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ee(this),e),Z(K.get(this))}:function(...e){return Z(t.apply(ee(this),e))}:function(e,...n){const i=t.call(ee(this),e,...n);return G.set(i,e.sort?e.sort():[e]),Z(i)}:(e instanceof IDBTransaction&&function(e){if(W.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",r),e.removeEventListener("abort",r)},s=()=>{t(),i()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",r),e.addEventListener("abort",r)}));W.set(e,t)}(e),$(e,z||(z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,X):e);var t}function Z(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",r)},s=()=>{t(Z(e.result)),i()},r=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&K.set(t,e)})).catch((()=>{})),J.set(t,e),t}(e);if(Q.has(e))return Q.get(e);const t=Y(e);return t!==e&&(Q.set(e,t),J.set(t,e)),t}const ee=e=>J.get(e),te=["get","getKey","getAll","getAllKeys","count"],ne=["put","add","delete","clear"],ie=new Map;function se(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ie.get(t))return ie.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=ne.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!te.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&r.done]))[0]};return ie.set(t,r),r}var re;re=X,X={...re,get:(e,t,n)=>se(e,t)||re.get(e,t,n),has:(e,t)=>!!se(e,t)||re.has(e,t)};class oe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ae="@firebase/app",ce="0.9.15",le=new B("@firebase/app"),ue="[DEFAULT]",he={[ae]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},de=new Map,fe=new Map;function pe(e,t){try{e.container.addComponent(t)}catch(n){le.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function me(e){const t=e.name;if(fe.has(t))return le.debug(`There were multiple attempts to register component ${t}.`),!1;fe.set(t,e);for(const t of de.values())pe(t,e);return!0}function ge(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ye=new g("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ve{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new R("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ye.create("app-deleted",{appName:this._name})}}const we="10.1.0";function be(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:ue,automaticDataCollectionEnabled:!1},t),s=i.name;if("string"!=typeof s||!s)throw ye.create("bad-app-name",{appName:String(s)});if(n||(n=c()),!n)throw ye.create("no-options");const r=de.get(s);if(r){if(v(n,r.options)&&v(i,r.config))return r;throw ye.create("duplicate-app",{appName:s})}const o=new x(s);for(const e of fe.values())o.addComponent(e);const a=new ve(n,i,o);return de.set(s,a),a}function Ie(e=ue){const t=de.get(e);if(!t&&e===ue&&c())return be();if(!t)throw ye.create("no-app",{appName:e});return t}function Ee(e,t,n){var i;let s=null!==(i=he[e])&&void 0!==i?i:e;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const e=[`Unable to register library "${s}" with version "${t}":`];return r&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void le.warn(e.join(" "))}me(new R(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}const Te="firebase-heartbeat-database",_e=1,Se="firebase-heartbeat-store";let Ce=null;function ke(){return Ce||(Ce=function(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=Z(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(Z(o.result),e.oldVersion,e.newVersion,Z(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{r&&e.addEventListener("close",(()=>r())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(Te,_e,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Se)}}).catch((e=>{throw ye.create("idb-open",{originalErrorMessage:e.message})}))),Ce}async function Ae(e,t){try{const n=(await ke()).transaction(Se,"readwrite"),i=n.objectStore(Se);await i.put(t,De(e)),await n.done}catch(e){if(e instanceof m)le.warn(e.message);else{const t=ye.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});le.warn(t.message)}}}function De(e){return`${e.name}!${e.options.appId}`}class Ne{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Oe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Re();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Re(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let i=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),Le(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Le(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=s(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Re(){return(new Date).toISOString().substring(0,10)}class Oe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!f()&&p().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await ke();return await t.transaction(Se).objectStore(Se).get(De(e))}catch(e){if(e instanceof m)le.warn(e.message);else{const t=ye.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});le.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ae(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ae(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Le(e){return s(JSON.stringify({version:2,heartbeats:e})).length}me(new R("platform-logger",(e=>new oe(e)),"PRIVATE")),me(new R("heartbeat",(e=>new Ne(e)),"PRIVATE")),Ee(ae,ce,""),Ee(ae,ce,"esm2017"),Ee("fire-js",""),Ee("firebase","10.1.0","app");const xe=(e,t)=>t.some((t=>e instanceof t));let Pe,Me;const Fe=new WeakMap,Ue=new WeakMap,Ve=new WeakMap,qe=new WeakMap,je=new WeakMap;let Be={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ue.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ve.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ze(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function $e(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Me||(Me=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(He(this),e),ze(Fe.get(this))}:function(...e){return ze(t.apply(He(this),e))}:function(e,...n){const i=t.call(He(this),e,...n);return Ve.set(i,e.sort?e.sort():[e]),ze(i)}:(e instanceof IDBTransaction&&function(e){if(Ue.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",r),e.removeEventListener("abort",r)},s=()=>{t(),i()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",r),e.addEventListener("abort",r)}));Ue.set(e,t)}(e),xe(e,Pe||(Pe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Be):e);var t}function ze(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",r)},s=()=>{t(ze(e.result)),i()},r=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&Fe.set(t,e)})).catch((()=>{})),je.set(t,e),t}(e);if(qe.has(e))return qe.get(e);const t=$e(e);return t!==e&&(qe.set(e,t),je.set(t,e)),t}const He=e=>je.get(e),Ke=["get","getKey","getAll","getAllKeys","count"],We=["put","add","delete","clear"],Ge=new Map;function Qe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Ge.get(t))return Ge.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=We.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!Ke.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&r.done]))[0]};return Ge.set(t,r),r}Be=(e=>({...e,get:(t,n,i)=>Qe(t,n)||e.get(t,n,i),has:(t,n)=>!!Qe(t,n)||e.has(t,n)}))(Be);const Je="@firebase/installations",Xe="0.6.4",Ye=1e4,Ze=`w:${Xe}`,et="FIS_v2",tt="https://firebaseinstallations.googleapis.com/v1",nt=36e5,it=new g("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function st(e){return e instanceof m&&e.code.includes("request-failed")}function rt({projectId:e}){return`${tt}/projects/${e}/installations`}function ot(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function at(e,t){const n=(await t.json()).error;return it.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function ct({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function lt(e){const t=await e();return t.status>=500&&t.status<600?e():t}function ut(e){return new Promise((t=>{setTimeout(t,e)}))}const ht=/^[cdef][\w-]{21}$/,dt="";function ft(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return ht.test(t)?t:dt}catch(e){return dt}}function pt(e){return`${e.appName}!${e.appId}`}const mt=new Map;function gt(e,t){const n=pt(e);yt(n,t),function(e,t){const n=(!vt&&"BroadcastChannel"in self&&(vt=new BroadcastChannel("[Firebase] FID Change"),vt.onmessage=e=>{yt(e.data.key,e.data.fid)}),vt);n&&n.postMessage({key:e,fid:t}),0===mt.size&&vt&&(vt.close(),vt=null)}(n,t)}function yt(e,t){const n=mt.get(e);if(n)for(const e of n)e(t)}let vt=null;const wt="firebase-installations-database",bt=1,It="firebase-installations-store";let Et=null;function Tt(){return Et||(Et=function(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=ze(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(ze(o.result),e.oldVersion,e.newVersion,ze(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),s&&e.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}(wt,bt,{upgrade:(e,t)=>{0===t&&e.createObjectStore(It)}})),Et}async function _t(e,t){const n=pt(e),i=(await Tt()).transaction(It,"readwrite"),s=i.objectStore(It),r=await s.get(n);return await s.put(t,n),await i.done,r&&r.fid===t.fid||gt(e,t.fid),t}async function St(e){const t=pt(e),n=(await Tt()).transaction(It,"readwrite");await n.objectStore(It).delete(t),await n.done}async function Ct(e,t){const n=pt(e),i=(await Tt()).transaction(It,"readwrite"),s=i.objectStore(It),r=await s.get(n),o=t(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||gt(e,o.fid),o}async function kt(e){let t;const n=await Ct(e.appConfig,(n=>{const i=function(e){return Nt(e||{fid:ft(),registrationStatus:0})}(n),s=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(it.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=rt(e),s=ct(e),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const o={fid:n,authVersion:et,appId:e.appId,sdkVersion:Ze},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await lt((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:ot(e.authToken)}}throw await at("Create Installation",c)}(e,t);return _t(e.appConfig,n)}catch(n){throw st(n)&&409===n.customData.serverCode?await St(e.appConfig):await _t(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:At(e)}:{installationEntry:t}}(e,i);return t=s.registrationPromise,s.installationEntry}));return n.fid===dt?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function At(e){let t=await Dt(e.appConfig);for(;1===t.registrationStatus;)await ut(100),t=await Dt(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await kt(e);return n||t}return t}function Dt(e){return Ct(e,(e=>{if(!e)throw it.create("installation-not-found");return Nt(e)}))}function Nt(e){return 1===(t=e).registrationStatus&&t.registrationTime+Ye<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Rt({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${rt(e)}/${t}/authTokens:generate`}(e,n),s=function(e,{refreshToken:t}){const n=ct(e);return n.append("Authorization",function(e){return`${et} ${e}`}(t)),n}(e,n),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const o={installation:{sdkVersion:Ze,appId:e.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await lt((()=>fetch(i,a)));if(c.ok)return ot(await c.json());throw await at("Generate Auth Token",c)}async function Ot(e,t=!1){let n;const i=await Ct(e.appConfig,(i=>{if(!xt(i))throw it.create("not-registered");const s=i.authToken;if(!t&&(2===(r=s).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+nt}(r)))return i;var r;if(1===s.requestStatus)return n=async function(e,t){let n=await Lt(e.appConfig);for(;1===n.authToken.requestStatus;)await ut(100),n=await Lt(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Ot(e,t):i}(e,t),i;{if(!navigator.onLine)throw it.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await Rt(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await _t(e.appConfig,i),n}catch(n){if(!st(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await _t(e.appConfig,n)}else await St(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function Lt(e){return Ct(e,(e=>{if(!xt(e))throw it.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+Ye<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function xt(e){return void 0!==e&&2===e.registrationStatus}function Pt(e){return it.create("missing-app-config-values",{valueName:e})}const Mt="installations";me(new R(Mt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Pt("App Configuration");if(!e.name)throw Pt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Pt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:ge(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),me(new R("installations-internal",(e=>{const t=ge(e.getProvider("app").getImmediate(),Mt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await kt(t);return i?i.catch(console.error):Ot(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await kt(e);t&&await t}(n),(await Ot(n,t)).token}(t,e)}}),"PRIVATE")),Ee(Je,Xe),Ee(Je,Xe,"esm2017");const Ft="analytics",Ut="firebase_id",Vt="origin",qt=6e4,jt="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Bt="https://www.googletagmanager.com/gtag/js",$t=new B("@firebase/analytics"),zt=new g("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Ht(e){if(!e.startsWith(Bt)){const t=zt.create("invalid-gtag-resource",{gtagURL:e});return $t.warn(t.message),""}return e}function Kt(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const Wt=30,Gt=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Qt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Jt(e,t=Gt,n){const{appId:i,apiKey:s,measurementId:r}=e.options;if(!i)throw zt.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw zt.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Yt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:qt),Xt({appId:i,apiKey:s,measurementId:r},o,a,t)}async function Xt(e,{throttleEndTimeMillis:t,backoffCount:n},i,s=Gt){var r;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,i)=>{const s=Math.max(t-Date.now(),0),r=setTimeout(n,s);e.addEventListener((()=>{clearTimeout(r),i(zt.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(a)return $t.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,s={method:"GET",headers:Qt(i)},r=jt.replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw zt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return s.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof m&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(s.deleteThrottleMetadata(o),a)return $t.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const l=503===Number(null===(r=null==c?void 0:c.customData)||void 0===r?void 0:r.httpStatus)?D(n,s.intervalMillis,Wt):D(n,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return s.setThrottleMetadata(o,u),$t.debug(`Calling attemptFetch again in ${l} millis`),Xt(e,u,i,s)}}class Yt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Zt,en;async function tn(e,t,n,i,s,r,o){var a;const c=Jt(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&$t.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>$t.error(e))),t.push(c);const l=async function(){if(!f())return $t.warn(zt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await p()}catch(e){return $t.warn(zt.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[u,h]=await Promise.all([c,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Bt)&&n.src.includes(e))return n;return null})(r)||function(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),n}(0,{createScriptURL:Ht}),i=document.createElement("script"),s=`${Bt}?l=${e}&id=${t}`;i.src=n?null==n?void 0:n.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}(r,u.measurementId),en&&(s("consent","default",en),en=void 0),s("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[Vt]="firebase",d.update=!0,null!=h&&(d[Ut]=h),s("config",u.measurementId,d),Zt&&(s("set",Zt),Zt=void 0),u.measurementId}class nn{constructor(e){this.app=e}_delete(){return delete sn[this.app.options.appId],Promise.resolve()}}let sn={},rn=[];const on={};let an,cn,ln="dataLayer",un=!1;function hn(e,t,n){!function(){const e=[];if(d()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=zt.create("invalid-analytics-context",{errorInfo:t});$t.warn(n.message)}}();const i=e.options.appId;if(!i)throw zt.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw zt.create("no-api-key");$t.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=sn[i])throw zt.create("already-exists",{id:i});if(!un){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ln);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,s){let r=function(...e){window[i].push(arguments)};return window[s]&&"function"==typeof window[s]&&(r=window[s]),window[s]=function(e,t,n,i){return async function(s,...r){try{if("event"===s){const[i,s]=r;await async function(e,t,n,i,s){try{let r=[];if(s&&s.send_to){let e=s.send_to;Array.isArray(e)||(e=[e]);const i=await Kt(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),s=e&&t[e.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(t)),await Promise.all(r),e("event",i,s||{})}catch(e){$t.error(e)}}(e,t,n,i,s)}else if("config"===s){const[s,o]=r;await async function(e,t,n,i,s,r){const o=i[s];try{if(o)await t[o];else{const e=(await Kt(n)).find((e=>e.measurementId===s));e&&await t[e.appId]}}catch(e){$t.error(e)}e("config",s,r)}(e,t,n,i,s,o)}else if("consent"===s){const[t]=r;e("consent","update",t)}else if("get"===s){const[t,n,i]=r;e("get",t,n,i)}else if("set"===s){const[t]=r;e("set",t)}else e(s,...r)}catch(e){$t.error(e)}}}(r,e,t,n),{gtagCore:r,wrappedGtag:window[s]}}(sn,rn,on,ln,"gtag");cn=e,an=t,un=!0}return sn[i]=tn(e,rn,on,t,an,ln,n),new nn(e)}const dn="@firebase/analytics",fn="0.10.0";me(new R(Ft,((e,{options:t})=>hn(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),me(new R("analytics-internal",(function(e){try{const t=e.getProvider(Ft).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=N(e),async function(e,t,n,i,s){if(s&&s.global)e("event",n,i);else{const s=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(cn,sn[e.app.options.appId],t,n,i).catch((e=>$t.error(e)))}(t,e,n,i)}}catch(e){throw zt.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ee(dn,fn),Ee(dn,fn,"esm2017");const pn=be({apiKey:"AIzaSyD8GSMZzjbubQ7AGcQKIV-enpDYpz_07mo",authDomain:"lyrn-web-app.firebaseapp.com",projectId:"lyrn-web-app",storageBucket:"lyrn-web-app.appspot.com",messagingSenderId:"80732012862",appId:"1:80732012862:web:22ffb978c80a1d2a0f2c6f",measurementId:"G-F2QZT3W2CX"});!function(e=Ie()){const t=ge(e=N(e),Ft);t.isInitialized()?t.getImmediate():function(e,t={}){const n=ge(e,Ft);if(n.isInitialized()){const e=n.getImmediate();if(v(t,n.getOptions()))return e;throw zt.create("already-initialized")}n.initialize({options:t})}(e)}(pn),"localhost"===location.hostname||location.hostname;const mn=pn;function gn(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const yn=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},vn=new g("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),wn=new B("@firebase/auth");function bn(e,...t){wn.logLevel<=M.ERROR&&wn.error(`Auth (${we}): ${e}`,...t)}function In(e,...t){throw Tn(e,...t)}function En(e,...t){return Tn(e,...t)}function Tn(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return vn.create(e,...t)}function _n(e,t,...n){if(!e)throw Tn(t,...n)}function Sn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw bn(t),new Error(t)}function Cn(e,t){e||Sn(t)}function kn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function An(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Dn{constructor(e,t){this.shortDelay=e,this.longDelay=t,Cn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===An()||"https:"===An()||d()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Nn(e,t){Cn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Rn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Sn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Sn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Sn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const On={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ln=new Dn(3e4,6e4);function xn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Pn(e,t,n,i,s={}){return Mn(e,s,(async()=>{let s={},r={};i&&("GET"===t?r=i:s={body:JSON.stringify(i)});const o=b(Object.assign({key:e.config.apiKey},r)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Rn.fetch()(Un(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},s))}))}async function Mn(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},On),t);try{const t=new Vn(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw qn(e,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const t=s.ok?r.errorMessage:r.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw qn(e,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw qn(e,"email-already-in-use",r);if("USER_DISABLED"===n)throw qn(e,"user-disabled",r);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},yn()),{[t]:n});return new g("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);In(e,a)}}catch(t){if(t instanceof m)throw t;In(e,"network-request-failed",{message:String(t)})}}async function Fn(e,t,n,i,s={}){const r=await Pn(e,t,n,i,s);return"mfaPendingCredential"in r&&In(e,"multi-factor-auth-required",{_serverResponse:r}),r}function Un(e,t,n,i){const s=`${t}${n}?${i}`;return e.config.emulator?Nn(e.config,s):`${e.config.apiScheme}://${s}`}class Vn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(En(this.auth,"network-request-failed"))),Ln.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function qn(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=En(e,t,i);return s.customData._tokenResponse=n,s}function jn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function Bn(e,t=!1){const n=N(e),i=await n.getIdToken(t),s=zn(i);_n(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"==typeof s.firebase?s.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:jn($n(s.auth_time)),issuedAtTime:jn($n(s.iat)),expirationTime:jn($n(s.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}function $n(e){return 1e3*Number(e)}function zn(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return bn("JWT malformed, contained fewer than 3 sections"),null;try{const e=r(n);return e?JSON.parse(e):(bn("Failed to decode base64 JWT payload"),null)}catch(e){return bn("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function Hn(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof m&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Kn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Wn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jn(this.lastLoginAt),this.creationTime=jn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Gn(e){var t;const n=e.auth,i=await e.getIdToken(),s=await Hn(e,async function(e,t){return Pn(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));_n(null==s?void 0:s.users.length,n,"internal-error");const r=s.users[0];e._notifyReloadListener(r);const o=(null===(t=r.providerUserInfo)||void 0===t?void 0:t.length)?r.providerUserInfo.map((e=>{var{providerId:t}=e,n=gn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&r.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Wn(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class Qn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_n(e.idToken,"internal-error"),_n(void 0!==e.idToken,"internal-error"),_n(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=zn(e);return _n(t,"internal-error"),_n(void 0!==t.exp,"internal-error"),_n(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return _n(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await Mn(e,{},(async()=>{const n=b({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,r=Un(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Rn.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,r=new Qn;return n&&(_n("string"==typeof n,"internal-error",{appName:e}),r.refreshToken=n),i&&(_n("string"==typeof i,"internal-error",{appName:e}),r.accessToken=i),s&&(_n("number"==typeof s,"internal-error",{appName:e}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qn,this.toJSON())}_performRefresh(){return Sn("not implemented")}}function Jn(e,t){_n("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Xn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=gn(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Kn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wn(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Hn(this,this.stsTokenManager.getToken(this.auth,e));return _n(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Bn(this,e)}reload(){return async function(e){const t=N(e);await Gn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(_n(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){_n(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Gn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Hn(this,async function(e,t){return Pn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,r,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,f=null!==(r=t.photoURL)&&void 0!==r?r:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:I,stsTokenManager:E}=t;_n(v&&E,e,"internal-error");const T=Qn.fromJSON(this.name,E);_n("string"==typeof v,e,"internal-error"),Jn(u,e.name),Jn(h,e.name),_n("boolean"==typeof w,e,"internal-error"),_n("boolean"==typeof b,e,"internal-error"),Jn(d,e.name),Jn(f,e.name),Jn(p,e.name),Jn(m,e.name),Jn(g,e.name),Jn(y,e.name);const _=new Xn({uid:v,auth:e,email:h,emailVerified:w,displayName:u,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:g,lastLoginAt:y});return I&&Array.isArray(I)&&(_.providerData=I.map((e=>Object.assign({},e)))),m&&(_._redirectEventId=m),_}static async _fromIdTokenResponse(e,t,n=!1){const i=new Qn;i.updateFromServerResponse(t);const s=new Xn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Gn(s),s}}const Yn=new Map;function Zn(e){Cn(e instanceof Function,"Expected a class definition");let t=Yn.get(e);return t?(Cn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Yn.set(e,t),t)}class ei{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ei.type="NONE";const ti=ei;function ni(e,t,n){return`firebase:${e}:${t}:${n}`}class ii{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ni(this.userKey,i.apiKey,s),this.fullPersistenceKey=ni("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ii(Zn(ti),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=i[0]||Zn(ti);const r=ni(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(r);if(t){const i=Xn._fromJSON(e,t);n!==s&&(o=i),s=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(r)}catch(e){}}))),new ii(s,e,n)):new ii(s,e,n)}}function si(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ci(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ri(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ui(t))return"Blackberry";if(hi(t))return"Webos";if(oi(t))return"Safari";if((t.includes("chrome/")||ai(t))&&!t.includes("edge/"))return"Chrome";if(li(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ri(e=h()){return/firefox\//i.test(e)}function oi(e=h()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ai(e=h()){return/crios\//i.test(e)}function ci(e=h()){return/iemobile/i.test(e)}function li(e=h()){return/android/i.test(e)}function ui(e=h()){return/blackberry/i.test(e)}function hi(e=h()){return/webos/i.test(e)}function di(e=h()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function fi(e=h()){return di(e)||li(e)||hi(e)||ui(e)||/windows phone/i.test(e)||ci(e)}function pi(e,t=[]){let n;switch(e){case"Browser":n=si(h());break;case"Worker":n=`${si(h())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${we}/${i}`}async function mi(e,t){return Pn(e,"GET","/v2/recaptchaConfig",xn(e,t))}function gi(e){return void 0!==e&&void 0!==e.enterprise}class yi{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function vi(e){return new Promise(((t,n)=>{const i=document.createElement("script");var s,r;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=En("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(r=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==r?r:document).appendChild(i)}))}function wi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class bi{constructor(e){this.type="recaptcha-enterprise",this.auth=_i(e)}async verify(e="verify",t=!1){function n(t,n,i){const s=window.grecaptcha;gi(s)?s.enterprise.ready((()=>{s.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{mi(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new yi(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((s=>{if(!t&&gi(window.grecaptcha))n(s,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));vi("https://www.google.com/recaptcha/enterprise.js?render="+s).then((()=>{n(s,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function Ii(e,t,n,i=!1){const s=new bi(e);let r;try{r=await s.verify(n)}catch(e){r=await s.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class Ei{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Ti{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Si(this),this.idTokenSubscription=new Si(this),this.beforeStateQueue=new Ei(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zn(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ii.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _n(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gn(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?N(e):null;return t&&_n(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_n(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Zn(e))}))}async initializeRecaptchaConfig(){const e=await mi(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new yi(e);null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new bi(this).verify()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new g("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zn(e)||this._popupRedirectResolver;_n(t,this,"argument-error"),this.redirectPersistenceManager=await ii.create(this,[Zn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),r=this._isInitialized?Promise.resolve():this._initializationPromise;return _n(r,this,"internal-error"),r.then((()=>s(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _n(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){wn.logLevel<=M.WARN&&wn.warn(`Auth (${we}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function _i(e){return N(e)}class Si{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new T(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return _n(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ci(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ki(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ai{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Sn("not implemented")}_getIdTokenResponse(e){return Sn("not implemented")}_linkToIdToken(e,t){return Sn("not implemented")}_getReauthenticationResolver(e){return Sn("not implemented")}}async function Di(e,t){return Fn(e,"POST","/v1/accounts:signInWithPassword",xn(e,t))}class Ni extends Ai{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ni(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ni(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Ii(e,n,"signInWithPassword");return Di(e,t)}return Di(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await Ii(e,n,"signInWithPassword");return Di(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return Fn(e,"POST","/v1/accounts:signInWithEmailLink",xn(e,t))}(e,{email:this._email,oobCode:this._password});default:In(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Pn(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Fn(e,"POST","/v1/accounts:signInWithEmailLink",xn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:In(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ri(e,t){return Fn(e,"POST","/v1/accounts:signInWithIdp",xn(e,t))}class Oi extends Ai{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Oi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):In("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=gn(t,["providerId","signInMethod"]);if(!n||!i)return null;const r=new Oi(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(e){return Ri(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ri(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ri(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=b(t)}return e}}const Li={USER_NOT_FOUND:"user-not-found"};class xi extends Ai{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new xi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new xi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Fn(e,"POST","/v1/accounts:signInWithPhoneNumber",xn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Fn(e,"POST","/v1/accounts:signInWithPhoneNumber",xn(e,t));if(n.temporaryProof)throw qn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Fn(e,"POST","/v1/accounts:signInWithPhoneNumber",xn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Li)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s}=e;return n||t||i||s?new xi({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class Pi{constructor(e){var t,n,i,s,r,o;const a=I(E(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);_n(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=I(E(e)).link,n=t?I(E(t)).deep_link_id:null,i=I(E(e)).deep_link_id;return(i?I(E(i)).link:null)||i||n||t||e}(e);try{return new Pi(t)}catch(e){return null}}}class Mi{constructor(){this.providerId=Mi.PROVIDER_ID}static credential(e,t){return Ni._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Pi.parseLink(t);return _n(n,"argument-error"),Ni._fromEmailAndCode(e,n.code,n.tenantId)}}Mi.PROVIDER_ID="password",Mi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Mi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Fi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ui extends Fi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Vi extends Ui{constructor(){super("facebook.com")}static credential(e){return Oi._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vi.credentialFromTaggedObject(e)}static credentialFromError(e){return Vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Vi.credential(e.oauthAccessToken)}catch(e){return null}}}Vi.FACEBOOK_SIGN_IN_METHOD="facebook.com",Vi.PROVIDER_ID="facebook.com";class qi extends Ui{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Oi._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return qi.credential(t,n)}catch(e){return null}}}qi.GOOGLE_SIGN_IN_METHOD="google.com",qi.PROVIDER_ID="google.com";class ji extends Ui{constructor(){super("github.com")}static credential(e){return Oi._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ji.credential(e.oauthAccessToken)}catch(e){return null}}}ji.GITHUB_SIGN_IN_METHOD="github.com",ji.PROVIDER_ID="github.com";class Bi extends Ui{constructor(){super("twitter.com")}static credential(e,t){return Oi._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Bi.credential(t,n)}catch(e){return null}}}Bi.TWITTER_SIGN_IN_METHOD="twitter.com",Bi.PROVIDER_ID="twitter.com";class $i{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await Xn._fromIdTokenResponse(e,n,i),r=zi(n);return new $i({user:s,providerId:r,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=zi(n);return new $i({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function zi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Hi extends m{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Hi.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Hi(e,t,n,i)}}function Ki(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Hi._fromErrorAndOperation(e,n,t,i);throw n}))}function Wi(e,t,n,i){return N(e).onAuthStateChanged(t,n,i)}function Gi(e){return N(e).signOut()}new WeakMap;const Qi="__sak";class Ji{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qi,"1"),this.storage.removeItem(Qi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Xi extends Ji{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=h();return oi(e)||di(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=fi(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);!function(){const e=h();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||s===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xi.type="LOCAL";const Yi=Xi;class Zi extends Ji{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Zi.type="SESSION";const es=Zi;class ts{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ts(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async e=>e(t.origin,s))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ns(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ts.receivers=[];class is{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const c=ns("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function ss(){return window}function rs(){return void 0!==ss().WorkerGlobalScope&&"function"==typeof ss().importScripts}const os="firebaseLocalStorageDb",as="firebaseLocalStorage",cs="fbase_key";class ls{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function us(e,t){return e.transaction([as],t?"readwrite":"readonly").objectStore(as)}function hs(){const e=indexedDB.open(os,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(as,{keyPath:cs})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(as)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(os);return new ls(e).toPromise()}(),t(await hs()))}))}))}async function ds(e,t,n){const i=us(e,!0).put({[cs]:t,value:n});return new ls(i).toPromise()}function fs(e,t){const n=us(e,!0).delete(t);return new ls(n).toPromise()}class ps{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await hs()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rs()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ts._getInstance(rs()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new is(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hs();return await ds(e,Qi,"1"),await fs(e,Qi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>ds(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=us(e,!1).get(t),i=await new ls(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>fs(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=us(e,!1).getAll();return new ls(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ps.type="LOCAL";const ms=ps;wi("rcb"),new Dn(3e4,6e4);class gs{constructor(e){this.providerId=gs.PROVIDER_ID,this.auth=_i(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const s=await n.verify();try{let r;if(_n("string"==typeof s,e,"argument-error"),_n("recaptcha"===n.type,e,"argument-error"),r="string"==typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){_n("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Pn(e,"POST","/v2/accounts/mfaEnrollment:start",xn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{_n("signin"===t.type,e,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;_n(n,e,"missing-multi-factor-info");const o=await function(e,t){return Pn(e,"POST","/v2/accounts/mfaSignIn:start",xn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Pn(e,"POST","/v1/accounts:sendVerificationCode",xn(e,t))}(e,{phoneNumber:r.phoneNumber,recaptchaToken:s});return t}}finally{n._reset()}}(this.auth,e,N(t))}static credential(e,t){return xi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return gs.credentialFromTaggedObject(t)}static credentialFromError(e){return gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?xi._fromTokenResponse(t,n):null}}gs.PROVIDER_ID="phone",gs.PHONE_SIGN_IN_METHOD="phone";class ys extends Ai{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ri(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ri(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ri(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function vs(e){return async function(e,t,n=!1){const i="signIn",s=await Ki(e,i,t),r=await $i._fromIdTokenResponse(e,i,s);return n||await e._updateCurrentUser(r.user),r}(e.auth,new ys(e),e.bypassAuthState)}function ws(e){const{auth:t,user:n}=e;return _n(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e,s="reauthenticate";try{const r=await Hn(e,Ki(i,s,t,e),n);_n(r.idToken,i,"internal-error");const o=zn(r.idToken);_n(o,i,"internal-error");const{sub:a}=o;return _n(e.uid===a,i,"user-mismatch"),$i._forOperation(e,s,r)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&In(i,"user-mismatch"),e}}(n,new ys(e),e.bypassAuthState)}async function bs(e){const{auth:t,user:n}=e;return _n(n,t,"internal-error"),async function(e,t,n=!1){const i=await Hn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return $i._forOperation(e,"link",i)}(n,new ys(e),e.bypassAuthState)}class Is{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=e;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vs;case"linkViaPopup":case"linkViaRedirect":return bs;case"reauthViaPopup":case"reauthViaRedirect":return ws;default:In(this.auth,"internal-error")}}resolve(e){Cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Es=new Dn(2e3,1e4);class Ts extends Is{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Ts.currentPopupAction&&Ts.currentPopupAction.cancel(),Ts.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _n(e,this.auth,"internal-error"),e}async onExecution(){Cn(1===this.filter.length,"Popup operations only handle one event");const e=ns();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(En(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ts.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Es.get())};e()}}Ts.currentPopupAction=null;const _s="pendingRedirect",Ss=new Map;class Cs extends Is{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Ss.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return ni(_s,e.config.apiKey,e.name)}(t),i=function(e){return Zn(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Ss.set(this.auth._key(),e)}return this.bypassAuthState||Ss.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ks(e,t){Ss.set(e._key(),t)}async function As(e,t,n=!1){const i=_i(e),s=function(e,t){return t?Zn(t):(_n(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),r=new Cs(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class Ds{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rs(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Rs(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(En(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ns(e))}saveEventToCache(e){this.cachedEventUids.add(Ns(e)),this.lastProcessedEventTime=Date.now()}}function Ns(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Rs({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Os=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ls=/^https?/;function xs(e){const t=kn(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!Ls.test(n))return!1;if(Os.test(e))return i===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const Ps=new Dn(3e4,6e4);function Ms(){const e=ss().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Fs=null;function Us(e){return Fs=Fs||function(e){return new Promise(((t,n)=>{var i,s,r;function o(){Ms(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ms(),n(En(e,"network-request-failed"))},timeout:Ps.get()})}if(null===(s=null===(i=ss().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(r=ss().gapi)||void 0===r?void 0:r.load)){const t=wi("iframefcb");return ss()[t]=()=>{gapi.load?o():n(En(e,"network-request-failed"))},vi(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Fs=null,e}))}(e),Fs}const Vs=new Dn(5e3,15e3),qs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},js=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bs(e){const t=e.config;_n(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Nn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:we},s=js.get(e.config.apiHost);s&&(i.eid=s);const r=e._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${b(i).slice(1)}`}const $s={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class zs{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const Hs=encodeURIComponent("fac");async function Ks(e,t,n,i,s,r){_n(e.config.authDomain,e,"auth-domain-config-required"),_n(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:we,eventId:s};if(t instanceof Fi){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(r||{}))o[e]=t}if(t instanceof Ui){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),l=c?`#${Hs}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?Nn(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${b(a).slice(1)}${l}`}const Ws="webStorageSupport",Gs=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=es,this._completeRedirectFn=As,this._overrideRedirectResult=ks}async _openPopup(e,t,n,i){var s;return Cn(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,s=600){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},$s),{width:i.toString(),height:s.toString(),top:r,left:o}),l=h().toLowerCase();n&&(a=ai(l)?"_blank":n),ri(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=h()){var t;return di(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new zs(null);const d=window.open(t||"",a,u);_n(d,e,"popup-blocked");try{d.focus()}catch(e){}return new zs(d)}(e,await Ks(e,t,n,kn(),i),ns())}async _openRedirect(e,t,n,i){return await this._originValidation(e),s=await Ks(e,t,n,kn(),i),ss().location.href=s,new Promise((()=>{}));var s}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Cn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Us(e),n=ss().gapi;return _n(n,e,"internal-error"),t.open({where:document.body,url:Bs(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qs,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const s=En(e,"network-request-failed"),r=ss().setTimeout((()=>{i(s)}),Vs.get());function o(){ss().clearTimeout(r),n(t)}t.ping(o).then(o,(()=>{i(s)}))}))))}(e),n=new Ds(e);return t.register("authEvent",(t=>(_n(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ws,{type:Ws},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Ws];void 0!==s&&t(!!s),In(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Pn(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(xs(e))return}catch(e){}In(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fi()||oi()||di()}};var Qs="@firebase/auth",Js="1.1.0";class Xs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_n(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ys=l("authIdTokenMaxAge")||300;let Zs=null;function er(e=Ie()){const t=ge(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=ge(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(v(n.getOptions(),null!=t?t:{}))return e;In(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Gs,persistence:[ms,Yi,es]}),i=l("authTokenSyncURL");if(i){const e=(s=i,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ys)return;const i=null==t?void 0:t.token;Zs!==i&&(Zs=i,await fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){N(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,i,s){N(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var s;const r=a("auth");return r&&function(e,t,n){const i=_i(e);_n(i._canInitEmulator,i,"emulator-config-failed"),_n(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),r=Ci(t),{host:o,port:a}=function(e){const t=Ci(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const e=s[1];return{host:e,port:ki(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:ki(t)}}}(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${r}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${r}`),n}var tr;tr="Browser",me(new R("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:r,authDomain:o}=n.options;_n(r&&!r.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:r,authDomain:o,clientPlatform:tr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pi(tr)},c=new Ti(n,i,s,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Zn);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),me(new R("auth-internal",(e=>(e=>new Xs(e))(_i(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ee(Qs,Js,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(tr)),Ee(Qs,Js,"esm2017");class nr{constructor(e){this.message=e.message??document.createElement("div"),this.choices=e.choices??[],this.values=e.values??[],this.slideInDir=e.slideInDir??null,this.slideInDist=e.slideInDist??100,this.slideInDuration=e.slideInDuration??500,this.slideInTiming=e.slideInTiming??"ease",this.slideOutDir=e.slideOutDir??null,this.slideOutDist=e.slideOutDist??100,this.slideOutDuration=e.slideOutDuration??500,this.slideOutTiming=e.slideOutTiming??"ease",this.fadeIn=e.fadeIn??null,this.fadeInDuration=e.fadeInDuration??500,this.fadeInTiming=e.fadeInTiming??"ease",this.fadeOut=e.fadeOut??null,this.fadeOutDuration=e.fadeOutDuration??500,this.fadeOutTiming=e.fadeOutTiming??"ease",this.container=document.createElement("div"),this.blocking=e.blocking??!0,this.windowBackgroundColor=e.windowBackgroundColor??(this.blocking?"rgb(0, 0, 0, 0.5)":"transparent"),this.windowPadding=e.windowPadding??"2em",this.hideOnWindow=e.hideOnWindow??this.blocking,this.wrapper=document.createElement("div"),this.width=e.width??"auto",this.justify=e.justify??"center",this.align=e.align??"center",this.backgroundColor=e.backgroundColor??"#FFFFFF",this.messageColor=e.messageColor??"#5B5B5B",this.messageFontSize=e.messageFontSize??"inherit",this.messageFontWeight=e.messageFontWeight??"inherit",this.choiceColor=e.choiceColor??"#057AFB",this.choiceFontSize=e.choiceFontSize??"inherit",this.choiceFontWeight=e.choiceFontWeight??"inherit",this.borderRadius=e.borderRadius??"0.5em",this.shadow=e.shadow??"0 0 10px 1px rgba(0, 0, 0, 0.3)",this.padding=e.padding??"1em 2em",this.choicesBorderTop=e.choicesBorderTop??"1px solid #D5D5D5",this.justifyChoices=e.justifyChoices??"end",this.hideOnDialog=e.hideOnDialog??!this.blocking,this.timeout=e.timeout??null}show(){return new Promise(((e,t)=>{for(;this.wrapper.firstChild;)this.wrapper.removeChild(this.wrapper.firstChild);if(this.container.style.boxSizing="border-box",this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.justifyContent=this.justify,this.container.style.alignItems=this.align,this.container.style.position="fixed",this.container.style.top=0,this.container.style.left=0,this.container.style.zIndex=9999,this.container.style.width="100vw",this.container.style.height="100vh",this.container.style.padding=this.windowPadding,this.container.style.backgroundColor=this.windowBackgroundColor,this.blocking?this.container.style.pointerEvents="auto":this.container.style.pointerEvents="none",this.hideOnWindow&&this.container.addEventListener("click",(t=>{t.target===t.currentTarget&&(e(null),this.hide())})),this.wrapper.style.width=this.width,this.wrapper.style.backgroundColor=this.backgroundColor,this.wrapper.style.color=this.messageColor,this.wrapper.style.borderRadius=this.borderRadius,this.wrapper.style.boxShadow=this.shadow,this.wrapper.style.pointerEvents="auto",this.slideInDir)switch(this.slideInDir){case"down":this.wrapper.style.transform=`translateY(-${this.slideInDist}px)`;break;case"right":this.wrapper.style.transform=`translateX(-${this.slideInDist}px)`;break;case"up":this.wrapper.style.transform=`translateY(${this.slideInDist}px)`;break;case"left":this.wrapper.style.transform=`translateX(${this.slideInDist}px)`;break;default:this.wrapper.style.transform="transform(0px)"}this.fadeIn&&(this.wrapper.style.opacity=0),this.hideOnDialog&&this.wrapper.addEventListener("click",(()=>{e(null),this.hide()})),this.container.appendChild(this.wrapper);const n=document.createElement("div");if(n.style.padding=this.padding,"string"==typeof this.message?(n.textContent=this.message,n.style.fontSize=this.messageFontSize,n.style.fontWeight=this.messageFontWeight):n.appendChild(this.message),this.wrapper.appendChild(n),this.choices.length>0){const t=document.createElement("div");t.style.padding=this.padding,t.style.borderTop=this.choicesBorderTop,t.style.display="flex",t.style.flexDirection="row",t.style.justifyContent=this.justifyChoices,this.choices.forEach(((n,i)=>{let s;"string"==typeof n?(s=document.createElement("p"),s.style.margin="0",s.textContent=n,s.style.fontSize=this.choiceFontSize,s.style.fontWeight=this.choiceFontWeight):s=n,"end"===this.justifyChoices&&(s.style.paddingLeft="1em"),"start"===this.justifyChoices&&(s.style.paddingRight="1em"),s.style.cursor="pointer",s.style.color=this.choiceColor,s.addEventListener("click",(()=>{e(this.values[i]),this.hide()})),t.appendChild(s)})),this.wrapper.appendChild(t)}document.body.appendChild(this.container);let i=null;this.slideInDir&&(i=`transform ${this.slideInDuration}ms ${this.slideInTiming}`,requestAnimationFrame((()=>{this.wrapper.style.transform="translate(0px)"}))),this.fadeIn&&(i?i+=`, opacity ${this.fadeInDuration}ms ${this.fadeInTiming}`:i=`, opacity ${this.fadeInDuration}ms ${this.fadeInTiming}`,requestAnimationFrame((()=>{this.wrapper.style.opacity=1}))),i&&(this.wrapper.style.transition=i),this.timeout&&setTimeout((()=>{e(null),this.hide()}),this.timeout)}))}hide(){let e=null;this.slideOutDir&&(e=`transform ${this.slideOutDuration}ms ${this.slideOutTiming}`,requestAnimationFrame((()=>{switch(this.slideOutDir){case"up":this.wrapper.style.transform=`translateY(-${this.slideOutDist}px)`;break;case"right":this.wrapper.style.transform=`translateX(${this.slideOutDist}px)`;break;case"down":this.wrapper.style.transform=`translateY(${this.slideOutDist}px)`;break;case"left":this.wrapper.style.transform=`translateX(-${this.slideOutDist}px)`;break;default:this.wrapper.style.transform="transform(0px)"}}))),this.fadeOut&&(e?e+=`, opacity ${this.fadeOutDuration}ms ${this.fadeOutTiming}`:e=`, opacity ${this.fadeOutDuration}ms ${this.fadeOutTiming}`,requestAnimationFrame((()=>{this.wrapper.style.opacity=0}))),e&&(this.wrapper.style.transition=e),this.slideOutDir||this.fadeOut?setTimeout((()=>{this.container.remove()}),Math.max(this.slideOutDir?this.slideOutDuration:0,this.fadeOut?this.fadeOutDuration:0)):this.container.remove()}static alert(e,t={}){return new nr({message:e,choices:["Close"],values:[null],width:"auto",...t}).show()}static confirm(e,t={}){return new nr({message:e,choices:["Cancel","OK"],values:[!1,!0],width:"400px",...t}).show()}static prompt(e,t={}){const n=document.createElement("div"),i=document.createElement("textarea");i.style.display="block",i.style.width="400px",i.style.marginTop="1em",i.style.fontSize="16px",n.append(e,i);const s=new nr({message:n,choices:["Cancel","OK"],values:[null,()=>i.value],width:"auto",...t}),r=new Promise(((e,t)=>{i.addEventListener("keyup",(t=>{"Enter"==t.key&&(t.ctrlKey||t.metaKey)&&(e(i.value),s.hide())}))})),o=s.show().then((e=>e&&e()));return Promise.race([r,o])}static toastMessage(e,t={}){return new nr({message:e,backgroundColor:"#61A1EA",messageColor:"#FFFFFF",messageFontSize:"14px",messageFontWeight:700,blocking:!1,justify:"end",align:"start",shadow:"0 0 10px 1px rgba(0, 0, 0, 0.2)",slideInDir:"down",slideInDist:150,slideOutDir:"right",slideOutDist:300,timeout:5e3,...t}).show()}static toastError(e,t={}){return new nr({message:e,backgroundColor:"#E36868",messageColor:"#FFFFFF",messageFontSize:"14px",messageFontWeight:700,blocking:!1,justify:"end",align:"start",shadow:"0 0 10px 1px rgba(0, 0, 0, 0.2)",slideInDir:"down",slideInDist:150,slideOutDir:"right",slideOutDist:300,timeout:5e3,...t}).show()}}class ir{constructor(e,t=(()=>{}),...n){this.date=e,this.callback=()=>t(...n),this.time=this.date.getTime()-(new Date).getTime(),this.elements=[],this.interval=setInterval((()=>{this.update()}),500)}update(){this.time=this.date.getTime()-(new Date).getTime(),this.time<=0?this.finish():this.show()}show(){const e=this.time,t=Math.floor(e/864e5),n=e%864e5,i=Math.floor(n/36e5),s=e%36e5,r=Math.floor(s/6e4),o=e%6e4,a=Math.floor(o/1e3);for(const e of this.elements)e.textContent=t?`${t}:${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:i?`${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}attach(e){this.elements.push(e),this.show()}detach(e){const t=this.elements.indexOf(e);-1!==t&&(this.elements[t].textContent="",this.elements.splice(t,1),this.show())}cleanUp(){clearInterval(this.interval);for(let e=this.elements.length-1;e>=0;e--)this.detach(this.elements[e])}finish(){this.callback(),clearInterval(this.interval),this.time=0,this.show()}}const sr=er(mn),rr=432e6;let or,ar,cr;window.addEventListener("storage",(e=>{"authExpiration"===e.key&&ur()})),window.addEventListener("DOMContentLoaded",(function(){!function(){if(hr("public",location.pathname))return;const e=document.createElement("div");e.id="siteWideLoadingScreen";const t=document.createElement("style");t.innerHTML="\n    #siteWideLoadingScreen {\n        top: 0;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        height: 100vh;\n        width: 100vw;\n        position: absolute;\n        background-color: white;\n        z-index: 9999;\n        display: flex;\n    }\n      \n    body.authorized > #siteWideLoadingScreen {\n        display: none;\n    }\n      \n    #siteWideLoadingScreen:before {\n        content: '';\n        display: block;\n        border: 20px solid white;\n        border-top: 20px solid #110D65;\n        border-radius: 50%;\n        width: 100px;\n        height: 100px;\n        animation: spin 2s linear infinite;\n        left: 0;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        margin: auto;\n        position: absolute;\n    }\n      \n    @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n    }\n    ",document.body.appendChild(t),document.body.appendChild(e),document.body.classList.remove("authorized")}();try{Wi(sr,(async e=>{let t=location.pathname;if(e){if(!localStorage.getItem("authExpiration")||parseInt(localStorage.getItem("authExpiration"))<(new Date).getTime())return void dr(!0);const n=(await Bn(e)).claims.role,i=new URLSearchParams(document.location.search).get("redirect");if(i)return void window.location.replace(location.origin+decodeURI(i));if(!hr(n,t))return void function(e,t){switch(e){case"public":default:window.location.replace(`${location.origin}/sign-in`);break;case"student":window.location.replace(`${location.origin}/test-taker/${t}`);break;case"parent":window.location.replace(`${location.origin}/Dashboard/Parent`);break;case"tutor":window.location.replace(`${location.origin}/Dashboard/Tutor`);break;case"admin":window.location.replace(`${location.origin}/Dashboard/Admin`);break;case"dev":window.location.replace(`${location.origin}/Dashboard/Dev`)}}(n,e.uid);localStorage.setItem("authExpiration",((new Date).getTime()+rr).toString()),ur()}else if(!hr("public",t)){const e=encodeURI(t);return void window.location.replace(location.origin+"/sign-in?redirect="+e)}document.body.classList.add("authorized")}))}catch(e){console.log(e),window.location.replace(location.origin+"/sign-in")}}));let lr={all:["/","/free-test-taker","/pricing","/why","/careers","/sign-up"],public:["/sign-in"],student:["/Dashboard/Student","/test-taker/*"],parent:["/Dashboard/Parent","/test-taker/*"],tutor:["/Dashboard/Tutor","/new-assignment","/view-curriculum","/student-overview/*","/test-taker/*"],admin:["&student","&parent","&tutor","/Dashboard/Admin","/new-parent","/new-student","/new-tutor"],dev:["&student","&parent","&tutor","&admin","/Dashboard/Dev","/testEditor","/analytics"]};async function ur(){cr&&cr.hide(),or&&or.cleanUp(),ar&&ar.cleanUp();const e=localStorage.getItem("authExpiration")&&parseInt(localStorage.getItem("authExpiration"));or=new ir(new Date(e),(()=>{dr(!0)})),ar=new ir(new Date(e-3e5),(async()=>{const e=document.createElement("p");e.style.margin="0",e.textContent="Are you still there? You will be signed out in ";const t=document.createElement("span");or.attach(t),e.appendChild(t),cr=new nr({message:e,choices:["YES","NO"],values:[!0,!1],timeout:or.time,slideInDir:"down",fadeIn:!0});const n=await cr.show();!0===n?(localStorage.setItem("authExpiration",((new Date).getTime()+rr).toString()),ur()):!1===n&&(cr.hide(),localStorage.setItem("authExpiration",((new Date).getTime()+rr).toString()),ur(),dr())}))}function hr(e,t){const n=[...lr[e]??[],...lr.all];for(const e of n){const n=e.split("/"),i=t.split("/");if(n.length>i.length)continue;let s=!0;for(let e=0;e<i.length;e++){if(e<n.length&&i[e]!==n[e]&&"*"!==n[e]&&"**"!==n[e]){s=!1;break}if(e>=n.length&&"**"!==n[n.length-1]){s=!1;break}}if(!0===s)return!0}return!1}async function dr(e=!1){if(e)await Gi(sr);else{const e=new nr({message:"Are you sure you want to sign out?",choices:["YES","NO"],values:[!0,!1],slideInDir:"down",fadeIn:!0});await e.show()&&await Gi(sr)}}!function(){for(const e in lr)lr[e]=lr[e].flatMap((e=>"&"===e.charAt(0)?lr[e.slice(1)]:e))}();var fr,pr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},mr={},gr=gr||{},yr=pr||self;function vr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function wr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var br="closure_uid_"+(1e9*Math.random()>>>0),Ir=0;function Er(e,t,n){return e.call.apply(e.bind,arguments)}function Tr(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _r(e,t,n){return(_r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Er:Tr).apply(null,arguments)}function Sr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Cr(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return t.prototype[n].apply(e,s)}}function kr(){this.s=this.s,this.o=this.o}kr.prototype.s=!1,kr.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,br)&&e[br]||(e[br]=++Ir))},kr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ar=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Dr(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function Nr(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(vr(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let s=0;s<i;s++)e[t+s]=n[s]}else e.push(n)}}function Rr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Rr.prototype.h=function(){this.defaultPrevented=!0};var Or=function(){if(!yr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{yr.addEventListener("test",(()=>{}),t),yr.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();function Lr(e){return/^[\s\xa0]*$/.test(e)}function xr(){var e=yr.navigator;return e&&(e=e.userAgent)?e:""}function Pr(e){return-1!=xr().indexOf(e)}function Mr(e){return Mr[" "](e),e}Mr[" "]=function(){};var Fr,Ur,Vr,qr=Pr("Opera"),jr=Pr("Trident")||Pr("MSIE"),Br=Pr("Edge"),$r=Br||jr,zr=Pr("Gecko")&&!(-1!=xr().toLowerCase().indexOf("webkit")&&!Pr("Edge"))&&!(Pr("Trident")||Pr("MSIE"))&&!Pr("Edge"),Hr=-1!=xr().toLowerCase().indexOf("webkit")&&!Pr("Edge");function Kr(){var e=yr.document;return e?e.documentMode:void 0}e:{var Wr="",Gr=(Ur=xr(),zr?/rv:([^\);]+)(\)|;)/.exec(Ur):Br?/Edge\/([\d\.]+)/.exec(Ur):jr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ur):Hr?/WebKit\/(\S+)/.exec(Ur):qr?/(?:Version)[ \/]?(\S+)/.exec(Ur):void 0);if(Gr&&(Wr=Gr?Gr[1]:""),jr){var Qr=Kr();if(null!=Qr&&Qr>parseFloat(Wr)){Fr=String(Qr);break e}}Fr=Wr}yr.document&&jr?Vr=Kr()||parseInt(Fr,10)||void 0:Vr=void 0;var Jr=Vr;function Xr(e,t){if(Rr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(zr){e:{try{Mr(t.nodeName);var s=!0;break e}catch(e){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Yr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Xr.$.h.call(this)}}Cr(Xr,Rr);var Yr={2:"touch",3:"pen",4:"mouse"};Xr.prototype.h=function(){Xr.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Zr="closure_listenable_"+(1e6*Math.random()|0),eo=0;function to(e,t,n,i,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=s,this.key=++eo,this.fa=this.ia=!1}function no(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function io(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function so(e){const t={};for(const n in e)t[n]=e[n];return t}const ro="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oo(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<ro.length;t++)n=ro[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function ao(e){this.src=e,this.g={},this.h=0}function co(e,t){var n=t.type;if(n in e.g){var i,s=e.g[n],r=Ar(s,t);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(no(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function lo(e,t,n,i){for(var s=0;s<e.length;++s){var r=e[s];if(!r.fa&&r.listener==t&&r.capture==!!n&&r.la==i)return s}return-1}ao.prototype.add=function(e,t,n,i,s){var r=e.toString();(e=this.g[r])||(e=this.g[r]=[],this.h++);var o=lo(e,t,i,s);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new to(t,this.src,r,!!i,s)).ia=n,e.push(t)),t};var uo="closure_lm_"+(1e6*Math.random()|0),ho={};function fo(e,t,n,i,s){if(i&&i.once)return mo(e,t,n,i,s);if(Array.isArray(t)){for(var r=0;r<t.length;r++)fo(e,t[r],n,i,s);return null}return n=Eo(n),e&&e[Zr]?e.O(t,n,wr(i)?!!i.capture:!!i,s):po(e,t,n,!1,i,s)}function po(e,t,n,i,s,r){if(!t)throw Error("Invalid event type");var o=wr(s)?!!s.capture:!!s,a=bo(e);if(a||(e[uo]=a=new ao(e)),(n=a.add(t,n,i,o,r)).proxy)return n;if(i=function(){const e=wo;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Or||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),i,s);else if(e.attachEvent)e.attachEvent(vo(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function mo(e,t,n,i,s){if(Array.isArray(t)){for(var r=0;r<t.length;r++)mo(e,t[r],n,i,s);return null}return n=Eo(n),e&&e[Zr]?e.P(t,n,wr(i)?!!i.capture:!!i,s):po(e,t,n,!0,i,s)}function go(e,t,n,i,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)go(e,t[r],n,i,s);else i=wr(i)?!!i.capture:!!i,n=Eo(n),e&&e[Zr]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=lo(r=e.g[t],n,i,s))&&(no(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete e.g[t],e.h--))):e&&(e=bo(e))&&(t=e.g[t.toString()],e=-1,t&&(e=lo(t,n,i,s)),(n=-1<e?t[e]:null)&&yo(n))}function yo(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Zr])co(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(vo(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=bo(t))?(co(n,e),0==n.h&&(n.src=null,t[uo]=null)):no(e)}}}function vo(e){return e in ho?ho[e]:ho[e]="on"+e}function wo(e,t){if(e.fa)e=!0;else{t=new Xr(t,this);var n=e.listener,i=e.la||e.src;e.ia&&yo(e),e=n.call(i,t)}return e}function bo(e){return(e=e[uo])instanceof ao?e:null}var Io="__closure_events_fn_"+(1e9*Math.random()>>>0);function Eo(e){return"function"==typeof e?e:(e[Io]||(e[Io]=function(t){return e.handleEvent(t)}),e[Io])}function To(){kr.call(this),this.i=new ao(this),this.S=this,this.J=null}function _o(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"==typeof t)t=new Rr(t,e);else if(t instanceof Rr)t.target=t.target||e;else{var s=t;oo(t=new Rr(i,e),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=t.g=n[r];s=So(o,i,!0,t)&&s}if(s=So(o=t.g=e,i,!0,t)&&s,s=So(o,i,!1,t)&&s,n)for(r=0;r<n.length;r++)s=So(o=t.g=n[r],i,!1,t)&&s}function So(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,r=0;r<t.length;++r){var o=t[r];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&co(e.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}Cr(To,kr),To.prototype[Zr]=!0,To.prototype.removeEventListener=function(e,t,n,i){go(this,e,t,n,i)},To.prototype.N=function(){if(To.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)no(n[i]);delete t.g[e],t.h--}}this.J=null},To.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},To.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var Co=yr.JSON.stringify;function ko(){var e=xo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ao=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Do),(e=>e.reset()));class Do{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function No(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ro(e){yr.setTimeout((()=>{throw e}),0)}let Oo,Lo=!1,xo=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ao.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Po=()=>{const e=yr.Promise.resolve(void 0);Oo=()=>{e.then(Mo)}};var Mo=()=>{for(var e;e=ko();){try{e.h.call(e.g)}catch(e){Ro(e)}var t=Ao;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Lo=!1};function Fo(e,t){To.call(this),this.h=e||1,this.g=t||yr,this.j=_r(this.qb,this),this.l=Date.now()}function Uo(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Vo(e,t,n){if("function"==typeof e)n&&(e=_r(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_r(e.handleEvent,e)}return 2147483647<Number(t)?-1:yr.setTimeout(e,t||0)}function qo(e){e.g=Vo((()=>{e.g=null,e.i&&(e.i=!1,qo(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Cr(Fo,To),(fr=Fo.prototype).ga=!1,fr.T=null,fr.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),_o(this,"tick"),this.ga&&(Uo(this),this.start()))}},fr.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},fr.N=function(){Fo.$.N.call(this),Uo(this),delete this.g};class jo extends kr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:qo(this)}N(){super.N(),this.g&&(yr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bo(e){kr.call(this),this.h=e,this.g={}}Cr(Bo,kr);var $o=[];function zo(e,t,n,i){Array.isArray(n)||(n&&($o[0]=n.toString()),n=$o);for(var s=0;s<n.length;s++){var r=fo(t,n[s],i||e.handleEvent,!1,e.h||e);if(!r)break;e.g[r.key]=r}}function Ho(e){io(e.g,(function(e,t){this.g.hasOwnProperty(t)&&yo(e)}),e),e.g={}}function Ko(){this.g=!0}function Wo(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return Co(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}Bo.prototype.N=function(){Bo.$.N.call(this),Ho(this)},Bo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ko.prototype.Ea=function(){this.g=!1},Ko.prototype.info=function(){};var Go={},Qo=null;function Jo(){return Qo=Qo||new To}function Xo(e){Rr.call(this,Go.Ta,e)}function Yo(e){const t=Jo();_o(t,new Xo(t))}function Zo(e,t){Rr.call(this,Go.STAT_EVENT,e),this.stat=t}function ea(e){const t=Jo();_o(t,new Zo(t,e))}function ta(e,t){Rr.call(this,Go.Ua,e),this.size=t}function na(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return yr.setTimeout((function(){e()}),t)}Go.Ta="serverreachability",Cr(Xo,Rr),Go.STAT_EVENT="statevent",Cr(Zo,Rr),Go.Ua="timingevent",Cr(ta,Rr);var ia={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},sa={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ra(){}function oa(e){return e.h||(e.h=e.i())}function aa(){}ra.prototype.h=null;var ca,la={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ua(){Rr.call(this,"d")}function ha(){Rr.call(this,"c")}function da(){}function fa(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new Bo(this),this.P=ma,e=$r?125:void 0,this.V=new Fo(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new pa}function pa(){this.i=null,this.g="",this.h=!1}Cr(ua,Rr),Cr(ha,Rr),Cr(da,ra),da.prototype.g=function(){return new XMLHttpRequest},da.prototype.i=function(){return{}},ca=new da;var ma=45e3,ga={},ya={};function va(e,t,n){e.L=1,e.v=Fa(Oa(t)),e.s=n,e.S=!0,wa(e,null)}function wa(e,t){e.G=Date.now(),Ta(e),e.A=Oa(e.v);var n=e.A,i=e.W;Array.isArray(i)||(i=[String(i)]),Ja(n.i,"t",i),e.C=0,n=e.l.J,e.h=new pa,e.g=Qc(e.l,n?t:null,!e.s),0<e.O&&(e.M=new jo(_r(e.Pa,e,e.g),e.O)),zo(e.U,e.g,"readystatechange",e.nb),t=e.I?so(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Yo(),function(e,t,n,i,s,r){e.info((function(){if(e.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function ba(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function Ia(e,t,n){let i,s=!0;for(;!e.J&&e.C<n.length;){if(i=Ea(e,n),i==ya){4==t&&(e.o=4,ea(14),s=!1),Wo(e.j,e.m,null,"[Incomplete Response]");break}if(i==ga){e.o=4,ea(15),Wo(e.j,e.m,n,"[Invalid Chunk]"),s=!1;break}Wo(e.j,e.m,i,null),Aa(e,i)}ba(e)&&i!=ya&&i!=ga&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,ea(16),s=!1),e.i=e.i&&s,s?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),jc(t),t.M=!0,ea(11))):(Wo(e.j,e.m,n,"[Invalid Chunked Response]"),ka(e),Ca(e))}function Ea(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?ya:(n=Number(t.substring(n,i)),isNaN(n)?ga:(i+=1)+n>t.length?ya:(t=t.slice(i,i+n),e.C=i+n,t))}function Ta(e){e.Y=Date.now()+e.P,_a(e,e.P)}function _a(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=na(_r(e.lb,e),t)}function Sa(e){e.B&&(yr.clearTimeout(e.B),e.B=null)}function Ca(e){0==e.l.H||e.J||zc(e.l,e)}function ka(e){Sa(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Uo(e.V),Ho(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Aa(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||nc(n.i,e)))if(!e.K&&nc(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;$c(n),Lc(n)}qc(n),ea(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=na(_r(n.ib,n),6e3));if(1>=tc(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Kc(n,11)}else if((e.K||n.g==e)&&$c(n),!Lr(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let l=s[t];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const t=l[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const s=l[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var r=i.i;r.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(ic(r,r.h),r.h=null))}if(i.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,Ma(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((i=n).wa=Gc(i,i.J?i.pa:null,i.Y),o.K){sc(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.B&&(Sa(a),Ta(a)),i.g=o}else Vc(i);0<n.j.length&&Pc(n)}else"stop"!=l[0]&&"close"!=l[0]||Kc(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Kc(n,7):Oc(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}Yo()}catch(e){}}function Da(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(vr(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(vr(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(vr(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),s=i.length,r=0;r<s;r++)t.call(void 0,i[r],n&&n[r],e)}(fr=fa.prototype).setTimeout=function(e){this.P=e},fr.nb=function(e){e=e.target;const t=this.M;t&&3==Cc(e)?t.l():this.Pa(e)},fr.Pa=function(e){try{if(e==this.g)e:{const u=Cc(this.g);var t=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||$r||this.g&&(this.h.h||this.g.ja()||kc(this.g)))){this.J||4!=u||7==t||Yo(),Sa(this);var n=this.g.da();this.ca=n;t:if(ba(this)){var i=kc(this.g);e="";var s=i.length,r=4==Cc(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ka(this),Ca(this);var o="";break t}this.h.i=new yr.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:r&&t==s-1});i.splice(0,s),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,i,s,r,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Lr(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.o=3,ea(12),ka(this),Ca(this);break e}Wo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Aa(this,n)}this.S?(Ia(this,u,o),$r&&this.i&&3==u&&(zo(this.U,this.V,"tick",this.mb),this.V.start())):(Wo(this.j,this.m,o,null),Aa(this,o)),4==u&&ka(this),this.i&&!this.J&&(4==u?zc(this.l,this):(this.i=!1,Ta(this)))}else(function(e){const t={};e=(e.g&&2<=Cc(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(Lr(e[i]))continue;var n=No(e[i]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const r=t[s]||[];t[s]=r,r.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ea(12)):(this.o=0,ea(13)),ka(this),Ca(this)}}}catch(e){}},fr.mb=function(){if(this.g){var e=Cc(this.g),t=this.g.ja();this.C<t.length&&(Sa(this),Ia(this,e,t),this.i&&4!=e&&Ta(this))}},fr.cancel=function(){this.J=!0,ka(this)},fr.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Yo(),ea(17)),ka(this),this.o=2,Ca(this)):_a(this,this.Y-e)};var Na=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ra(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Ra){this.h=e.h,La(this,e.j),this.s=e.s,this.g=e.g,xa(this,e.m),this.l=e.l;var t=e.i,n=new Ka;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Pa(this,n),this.o=e.o}else e&&(t=String(e).match(Na))?(this.h=!1,La(this,t[1]||"",!0),this.s=Ua(t[2]||""),this.g=Ua(t[3]||"",!0),xa(this,t[4]),this.l=Ua(t[5]||"",!0),Pa(this,t[6]||"",!0),this.o=Ua(t[7]||"")):(this.h=!1,this.i=new Ka(null,this.h))}function Oa(e){return new Ra(e)}function La(e,t,n){e.j=n?Ua(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function xa(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Pa(e,t,n){t instanceof Ka?(e.i=t,function(e,t){t&&!e.j&&(Wa(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ga(this,t),Ja(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Va(t,za)),e.i=new Ka(t,e.h))}function Ma(e,t,n){e.i.set(t,n)}function Fa(e){return Ma(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Ua(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Va(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,qa),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function qa(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ra.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Va(t,ja,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Va(t,ja,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Va(n,"/"==n.charAt(0)?$a:Ba,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Va(n,Ha)),e.join("")};var ja=/[#\/\?@]/g,Ba=/[#\?:]/g,$a=/[#\?]/g,za=/[#\?@]/g,Ha=/#/g;function Ka(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Wa(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),s=null;if(0<=i){var r=e[n].substring(0,i);s=e[n].substring(i+1)}else r=e[n];t(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ga(e,t){Wa(e),t=Xa(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Qa(e,t){return Wa(e),t=Xa(e,t),e.g.has(t)}function Ja(e,t,n){Ga(e,t),0<n.length&&(e.i=null,e.g.set(Xa(e,t),Dr(n)),e.h+=n.length)}function Xa(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ya(e){this.l=e||Za,e=yr.PerformanceNavigationTiming?0<(e=yr.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(yr.g&&yr.g.Ka&&yr.g.Ka()&&yr.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(fr=Ka.prototype).add=function(e,t){Wa(this),this.i=null,e=Xa(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},fr.forEach=function(e,t){Wa(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},fr.ta=function(){Wa(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const s=e[i];for(let e=0;e<s.length;e++)n.push(t[i])}return n},fr.Z=function(e){Wa(this);let t=[];if("string"==typeof e)Qa(this,e)&&(t=t.concat(this.g.get(Xa(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},fr.set=function(e,t){return Wa(this),this.i=null,Qa(this,e=Xa(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},fr.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},fr.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const r=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var s=r;""!==o[i]&&(s+="="+encodeURIComponent(String(o[i]))),e.push(s)}}return this.i=e.join("&")};var Za=10;function ec(e){return!!e.h||!!e.g&&e.g.size>=e.j}function tc(e){return e.h?1:e.g?e.g.size:0}function nc(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ic(e,t){e.g?e.g.add(t):e.h=t}function sc(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function rc(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Dr(e.i)}Ya.prototype.cancel=function(){if(this.i=rc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var oc=class{stringify(e){return yr.JSON.stringify(e,void 0)}parse(e){return yr.JSON.parse(e,void 0)}};function ac(){this.g=new oc}function cc(e,t,n){const i=n||"";try{Da(e,(function(e,n){let s=e;wr(e)&&(s=Co(e)),t.push(i+n+"="+encodeURIComponent(s))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function lc(e,t,n,i,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(i)}catch(e){}}function uc(e){this.l=e.fc||null,this.j=e.ob||!1}function hc(e,t){To.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=dc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Cr(uc,ra),uc.prototype.g=function(){return new hc(this.l,this.j)},uc.prototype.i=function(e){return function(){return e}}({}),Cr(hc,To);var dc=0;function fc(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function pc(e){e.readyState=4,e.l=null,e.j=null,e.A=null,mc(e)}function mc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(fr=hc.prototype).open=function(e,t){if(this.readyState!=dc)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,mc(this)},fr.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||yr).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},fr.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,pc(this)),this.readyState=dc},fr.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,mc(this)),this.g&&(this.readyState=3,mc(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==yr.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;fc(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},fr.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?pc(this):mc(this),3==this.readyState&&fc(this)}},fr.Za=function(e){this.g&&(this.response=this.responseText=e,pc(this))},fr.Ya=function(e){this.g&&(this.response=e,pc(this))},fr.ka=function(){this.g&&pc(this)},fr.setRequestHeader=function(e,t){this.v.append(e,t)},fr.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},fr.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(hc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var gc=yr.JSON.parse;function yc(e){To.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=vc,this.L=this.M=!1}Cr(yc,To);var vc="",wc=/^https?$/i,bc=["POST","PUT"];function Ic(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Ec(e),_c(e)}function Ec(e){e.F||(e.F=!0,_o(e,"complete"),_o(e,"error"))}function Tc(e){if(e.h&&void 0!==gr&&(!e.C[1]||4!=Cc(e)||2!=e.da()))if(e.v&&4==Cc(e))Vo(e.La,0,e);else if(_o(e,"readystatechange"),4==Cc(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===o){var s=String(e.I).match(Na)[1]||null;!s&&yr.self&&yr.self.location&&(s=yr.self.location.protocol.slice(0,-1)),i=!wc.test(s?s.toLowerCase():"")}n=i}if(n)_o(e,"complete"),_o(e,"success");else{e.m=6;try{var r=2<Cc(e)?e.g.statusText:""}catch(e){r=""}e.j=r+" ["+e.da()+"]",Ec(e)}}finally{_c(e)}}}function _c(e,t){if(e.g){Sc(e);const n=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||_o(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function Sc(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(yr.clearTimeout(e.A),e.A=null)}function Cc(e){return e.g?e.g.readyState:0}function kc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case vc:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ac(e){let t="";return io(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Dc(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Ac(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Ma(e,t,n))}function Nc(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Rc(e){this.Ga=0,this.j=[],this.l=new Ko,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Nc("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Nc("baseRetryDelayMs",5e3,e),this.hb=Nc("retryDelaySeedMs",1e4,e),this.eb=Nc("forwardChannelMaxRetries",2,e),this.xa=Nc("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Ya(e&&e.concurrentRequestLimit),this.Ja=new ac,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Oc(e){if(xc(e),3==e.H){var t=e.W++,n=Oa(e.I);if(Ma(n,"SID",e.K),Ma(n,"RID",t),Ma(n,"TYPE","terminate"),Fc(e,n),(t=new fa(e,e.l,t)).L=2,t.v=Fa(Oa(n)),n=!1,yr.navigator&&yr.navigator.sendBeacon)try{n=yr.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&yr.Image&&((new Image).src=t.v,n=!0),n||(t.g=Qc(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Ta(t)}Wc(e)}function Lc(e){e.g&&(jc(e),e.g.cancel(),e.g=null)}function xc(e){Lc(e),e.u&&(yr.clearTimeout(e.u),e.u=null),$c(e),e.i.cancel(),e.m&&("number"==typeof e.m&&yr.clearTimeout(e.m),e.m=null)}function Pc(e){if(!ec(e.i)&&!e.m){e.m=!0;var t=e.Na;Oo||Po(),Lo||(Oo(),Lo=!0),xo.add(t,e),e.C=0}}function Mc(e,t){var n;n=t?t.m:e.W++;const i=Oa(e.I);Ma(i,"SID",e.K),Ma(i,"RID",n),Ma(i,"AID",e.V),Fc(e,i),e.o&&e.s&&Dc(i,e.o,e.s),n=new fa(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Uc(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),ic(e.i,n),va(n,i,t)}function Fc(e,t){e.na&&io(e.na,(function(e,n){Ma(t,n,e)})),e.h&&Da({},(function(e,n){Ma(t,n,e)}))}function Uc(e,t,n){n=Math.min(e.j.length,n);var i=e.h?_r(e.h.Va,e.h,e):null;e:{var s=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let r=!0;for(let o=0;o<n;o++){let n=s[o].g;const a=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),r=!1;else try{cc(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(r){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function Vc(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Oo||Po(),Lo||(Oo(),Lo=!0),xo.add(t,e),e.A=0}}function qc(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=na(_r(e.Ma,e),Hc(e,e.A)),e.A++,0))}function jc(e){null!=e.B&&(yr.clearTimeout(e.B),e.B=null)}function Bc(e){e.g=new fa(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Oa(e.wa);Ma(t,"RID","rpc"),Ma(t,"SID",e.K),Ma(t,"AID",e.V),Ma(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Ma(t,"TO",e.qa),Ma(t,"TYPE","xmlhttp"),Fc(e,t),e.o&&e.s&&Dc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Fa(Oa(t)),n.s=null,n.S=!0,wa(n,e)}function $c(e){null!=e.v&&(yr.clearTimeout(e.v),e.v=null)}function zc(e,t){var n=null;if(e.g==t){$c(e),jc(e),e.g=null;var i=2}else{if(!nc(e.i,t))return;n=t.F,sc(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.G;var s=e.C;_o(i=Jo(),new ta(i,n)),Pc(e)}else Vc(e);else if(3==(s=t.o)||0==s&&0<t.ca||!(1==i&&function(e,t){return!(tc(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=na(_r(e.Na,e,t),Hc(e,e.C)),e.C++,0)))}(e,t)||2==i&&qc(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:Kc(e,5);break;case 4:Kc(e,10);break;case 3:Kc(e,6);break;default:Kc(e,2)}}function Hc(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Kc(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=_r(e.pb,e);n||(n=new Ra("//www.google.com/images/cleardot.gif"),yr.location&&"http"==yr.location.protocol||La(n,"https"),Fa(n)),function(e,t){const n=new Ko;if(yr.Image){const i=new Image;i.onload=Sr(lc,n,i,"TestLoadImage: loaded",!0,t),i.onerror=Sr(lc,n,i,"TestLoadImage: error",!1,t),i.onabort=Sr(lc,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=Sr(lc,n,i,"TestLoadImage: timeout",!1,t),yr.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else ea(2);e.H=0,e.h&&e.h.za(t),Wc(e),xc(e)}function Wc(e){if(e.H=0,e.ma=[],e.h){const t=rc(e.i);0==t.length&&0==e.j.length||(Nr(e.ma,t),Nr(e.ma,e.j),e.i.i.length=0,Dr(e.j),e.j.length=0),e.h.ya()}}function Gc(e,t,n){var i=n instanceof Ra?Oa(n):new Ra(n);if(""!=i.g)t&&(i.g=t+"."+i.g),xa(i,i.m);else{var s=yr.location;i=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var r=new Ra(null);i&&La(r,i),t&&(r.g=t),s&&xa(r,s),n&&(r.l=n),i=r}return n=e.F,t=e.Da,n&&t&&Ma(i,n,t),Ma(i,"VER",e.ra),Fc(e,i),i}function Qc(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new yc(new uc({ob:!0})):new yc(e.va)).Oa(e.J),t}function Jc(){}function Xc(){if(jr&&!(10<=Number(Jr)))throw Error("Environmental error: no available transport.")}function Yc(e,t){To.call(this),this.g=new Rc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Lr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Lr(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new tl(this)}function Zc(e){ua.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function el(){ha.call(this),this.status=1}function tl(e){this.g=e}function nl(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function il(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var s=0;16>s;++s)i[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)i[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var r=e.g[3],o=t+(r^n&(s^r))+i[0]+3614090360&4294967295;o=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=(n=(s=(r=(t=n+(o<<7&4294967295|o>>>25))+((o=r+(s^t&(n^s))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(r^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^n&(s^r))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^t&(n^s))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(r^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^n&(s^r))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^t&(n^s))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(r^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^n&(s^r))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^t&(n^s))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^s&(r^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^r&(n^s))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(r^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^t&(s^r))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^r&(n^s))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(r^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^t&(s^r))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^r&(n^s))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(r^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^t&(s^r))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^r&(n^s))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^n&(r^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^t&(s^r))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^s^r)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=r+(t^n^s)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^s^r)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=r+(t^n^s)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^s^r)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=r+(t^n^s)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^s^r)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=r+(t^n^s)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(s^(n|~r))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(t|~s))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(r|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(s^(n|~r))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(t|~s))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(r|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(s^(n|~r))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(t|~s))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(r|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((r=(t=n+((o=t+(s^(n|~r))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(t|~s))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((s=r+((o=s+(t^(r|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+r&4294967295}function sl(e,t){this.h=t;for(var n=[],i=!0,s=e.length-1;0<=s;s--){var r=0|e[s];i&&r==t||(n[s]=r,i=!1)}this.g=n}(fr=yc.prototype).Oa=function(e){this.M=e},fr.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ca.g(),this.C=this.u?oa(this.u):oa(ca),this.g.onreadystatechange=_r(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void Ic(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=yr.FormData&&e instanceof yr.FormData,!(0<=Ar(bc,t))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Sc(this),0<this.B&&((this.L=function(e){return jr&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_r(this.ua,this)):this.A=Vo(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Ic(this,e)}},fr.ua=function(){void 0!==gr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_o(this,"timeout"),this.abort(8))},fr.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,_o(this,"complete"),_o(this,"abort"),_c(this))},fr.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),_c(this,!0)),yc.$.N.call(this)},fr.La=function(){this.s||(this.G||this.v||this.l?Tc(this):this.kb())},fr.kb=function(){Tc(this)},fr.isActive=function(){return!!this.g},fr.da=function(){try{return 2<Cc(this)?this.g.status:-1}catch(e){return-1}},fr.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},fr.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),gc(t)}},fr.Ia=function(){return this.m},fr.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(fr=Rc.prototype).ra=8,fr.H=1,fr.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const s=new fa(this,this.l,e);let r=this.s;if(this.U&&(r?(r=so(r),oo(r,this.U)):r=this.U),null!==this.o||this.O||(s.I=r,r=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Uc(this,s,t),Ma(n=Oa(this.I),"RID",e),Ma(n,"CVER",22),this.F&&Ma(n,"X-HTTP-Session-Id",this.F),Fc(this,n),r&&(this.O?t="headers="+encodeURIComponent(String(Ac(r)))+"&"+t:this.o&&Dc(n,this.o,r)),ic(this.i,s),this.bb&&Ma(n,"TYPE","init"),this.P?(Ma(n,"$req",t),Ma(n,"SID","null"),s.aa=!0,va(s,n,null)):va(s,n,t),this.H=2}}else 3==this.H&&(e?Mc(this,e):0==this.j.length||ec(this.i)||Mc(this))},fr.Ma=function(){if(this.u=null,Bc(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=na(_r(this.jb,this),e)}},fr.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ea(10),Lc(this),Bc(this))},fr.ib=function(){null!=this.v&&(this.v=null,Lc(this),qc(this),ea(19))},fr.pb=function(e){e?(this.l.info("Successfully pinged google.com"),ea(2)):(this.l.info("Failed to ping google.com"),ea(1))},fr.isActive=function(){return!!this.h&&this.h.isActive(this)},(fr=Jc.prototype).Ba=function(){},fr.Aa=function(){},fr.za=function(){},fr.ya=function(){},fr.isActive=function(){return!0},fr.Va=function(){},Xc.prototype.g=function(e,t){return new Yc(e,t)},Cr(Yc,To),Yc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ea(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Gc(e,null,e.Y),Pc(e)},Yc.prototype.close=function(){Oc(this.g)},Yc.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Co(e),e=n);t.j.push(new class{constructor(e,t){this.g=e,this.map=t}}(t.fb++,e)),3==t.H&&Pc(t)},Yc.prototype.N=function(){this.g.h=null,delete this.j,Oc(this.g),delete this.g,Yc.$.N.call(this)},Cr(Zc,ua),Cr(el,ha),Cr(tl,Jc),tl.prototype.Ba=function(){_o(this.g,"a")},tl.prototype.Aa=function(e){_o(this.g,new Zc(e))},tl.prototype.za=function(e){_o(this.g,new el)},tl.prototype.ya=function(){_o(this.g,"b")},Cr(nl,(function(){this.blockSize=-1})),nl.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},nl.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,s=this.h,r=0;r<t;){if(0==s)for(;r<=n;)il(this,e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s++]=e.charCodeAt(r++),s==this.blockSize){il(this,i),s=0;break}}else for(;r<t;)if(i[s++]=e[r++],s==this.blockSize){il(this,i),s=0;break}}this.h=s,this.i+=t},nl.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var rl={};function ol(e){return-128<=e&&128>e?function(e,t){var n=rl;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new sl([0|e],0>e?-1:0)}(e)}(e):new sl([0|e],0>e?-1:0)}function al(e){if(isNaN(e)||!isFinite(e))return ll;if(0>e)return pl(al(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=cl;return new sl(t,0)}var cl=4294967296,ll=ol(0),ul=ol(1),hl=ol(16777216);function dl(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function fl(e){return-1==e.h}function pl(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new sl(n,~e.h).add(ul)}function ml(e,t){return e.add(pl(t))}function gl(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function yl(e,t){this.g=e,this.h=t}function vl(e,t){if(dl(t))throw Error("division by zero");if(dl(e))return new yl(ll,ll);if(fl(e))return t=vl(pl(e),t),new yl(pl(t.g),pl(t.h));if(fl(t))return t=vl(e,pl(t)),new yl(pl(t.g),t.h);if(30<e.g.length){if(fl(e)||fl(t))throw Error("slowDivide_ only works with positive integers.");for(var n=ul,i=t;0>=i.X(e);)n=wl(n),i=wl(i);var s=bl(n,1),r=bl(i,1);for(i=bl(i,2),n=bl(n,2);!dl(i);){var o=r.add(i);0>=o.X(e)&&(s=s.add(n),r=o),i=bl(i,1),n=bl(n,1)}return t=ml(e,s.R(t)),new yl(s,t)}for(s=ll;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(r=al(n)).R(t);fl(o)||0<o.X(e);)o=(r=al(n-=i)).R(t);dl(r)&&(r=ul),s=s.add(r),e=ml(e,o)}return new yl(s,e)}function wl(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new sl(n,e.h)}function bl(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],r=0;r<i;r++)s[r]=0<t?e.D(r+n)>>>t|e.D(r+n+1)<<32-t:e.D(r+n);return new sl(s,e.h)}(fr=sl.prototype).ea=function(){if(fl(this))return-pl(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:cl+i)*t,t*=cl}return e},fr.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(dl(this))return"0";if(fl(this))return"-"+pl(this).toString(e);for(var t=al(Math.pow(e,6)),n=this,i="";;){var s=vl(n,t).g,r=((0<(n=ml(n,s.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(dl(n=s))return r+i;for(;6>r.length;)r="0"+r;i=r+i}},fr.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},fr.X=function(e){return fl(e=ml(this,e))?-1:dl(e)?0:1},fr.abs=function(){return fl(this)?pl(this):this},fr.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var r=i+(65535&this.D(s))+(65535&e.D(s)),o=(r>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);i=o>>>16,r&=65535,o&=65535,n[s]=o<<16|r}return new sl(n,-2147483648&n[n.length-1]?-1:0)},fr.R=function(e){if(dl(this)||dl(e))return ll;if(fl(this))return fl(e)?pl(this).R(pl(e)):pl(pl(this).R(e));if(fl(e))return pl(this.R(pl(e)));if(0>this.X(hl)&&0>e.X(hl))return al(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var r=this.D(i)>>>16,o=65535&this.D(i),a=e.D(s)>>>16,c=65535&e.D(s);n[2*i+2*s]+=o*c,gl(n,2*i+2*s),n[2*i+2*s+1]+=r*c,gl(n,2*i+2*s+1),n[2*i+2*s+1]+=o*a,gl(n,2*i+2*s+1),n[2*i+2*s+2]+=r*a,gl(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new sl(n,0)},fr.gb=function(e){return vl(this,e).h},fr.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new sl(n,this.h&e.h)},fr.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new sl(n,this.h|e.h)},fr.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new sl(n,this.h^e.h)},Xc.prototype.createWebChannel=Xc.prototype.g,Yc.prototype.send=Yc.prototype.u,Yc.prototype.open=Yc.prototype.m,Yc.prototype.close=Yc.prototype.close,ia.NO_ERROR=0,ia.TIMEOUT=8,ia.HTTP_ERROR=6,sa.COMPLETE="complete",aa.EventType=la,la.OPEN="a",la.CLOSE="b",la.ERROR="c",la.MESSAGE="d",To.prototype.listen=To.prototype.O,yc.prototype.listenOnce=yc.prototype.P,yc.prototype.getLastError=yc.prototype.Sa,yc.prototype.getLastErrorCode=yc.prototype.Ia,yc.prototype.getStatus=yc.prototype.da,yc.prototype.getResponseJson=yc.prototype.Wa,yc.prototype.getResponseText=yc.prototype.ja,yc.prototype.send=yc.prototype.ha,yc.prototype.setWithCredentials=yc.prototype.Oa,nl.prototype.digest=nl.prototype.l,nl.prototype.reset=nl.prototype.reset,nl.prototype.update=nl.prototype.j,sl.prototype.add=sl.prototype.add,sl.prototype.multiply=sl.prototype.R,sl.prototype.modulo=sl.prototype.gb,sl.prototype.compare=sl.prototype.X,sl.prototype.toNumber=sl.prototype.ea,sl.prototype.toString=sl.prototype.toString,sl.prototype.getBits=sl.prototype.D,sl.fromNumber=al,sl.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return pl(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=al(Math.pow(n,8)),s=ll,r=0;r<t.length;r+=8){var o=Math.min(8,t.length-r),a=parseInt(t.substring(r,r+o),n);8>o?(o=al(Math.pow(n,o)),s=s.R(o).add(al(a))):s=(s=s.R(i)).add(al(a))}return s};var Il=mr.createWebChannelTransport=function(){return new Xc},El=mr.getStatEventTarget=function(){return Jo()},Tl=mr.ErrorCode=ia,_l=mr.EventType=sa,Sl=mr.Event=Go,Cl=mr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},kl=mr.FetchXmlHttpFactory=uc,Al=mr.WebChannel=aa,Dl=mr.XhrIo=yc,Nl=mr.Md5=nl,Rl=mr.Integer=sl;const Ol="@firebase/firestore";class Ll{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ll.UNAUTHENTICATED=new Ll(null),Ll.GOOGLE_CREDENTIALS=new Ll("google-credentials-uid"),Ll.FIRST_PARTY=new Ll("first-party-uid"),Ll.MOCK_USER=new Ll("mock-user");let xl="10.1.0";const Pl=new B("@firebase/firestore");function Ml(){return Pl.logLevel}function Fl(e,...t){if(Pl.logLevel<=M.DEBUG){const n=t.map(ql);Pl.debug(`Firestore (${xl}): ${e}`,...n)}}function Ul(e,...t){if(Pl.logLevel<=M.ERROR){const n=t.map(ql);Pl.error(`Firestore (${xl}): ${e}`,...n)}}function Vl(e,...t){if(Pl.logLevel<=M.WARN){const n=t.map(ql);Pl.warn(`Firestore (${xl}): ${e}`,...n)}}function ql(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function jl(e="Unexpected state"){const t=`FIRESTORE (${xl}) INTERNAL ASSERTION FAILED: `+e;throw Ul(t),new Error(t)}function Bl(e,t){e||jl()}function $l(e,t){return e}const zl={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Hl extends m{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Kl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Wl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Gl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ll.UNAUTHENTICATED)))}shutdown(){}}class Ql{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Jl{constructor(e){this.t=e,this.currentUser=Ll.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new Kl;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Kl,e.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{Fl("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Fl("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Kl)}}),0),r()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Fl("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Bl("string"==typeof t.accessToken),new Wl(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Bl(null===e||"string"==typeof e),new Ll(e)}}class Xl{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Ll.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Yl{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Xl(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Ll.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Zl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eu{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&Fl("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,Fl("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{Fl("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):Fl("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Bl("string"==typeof e.token),this.R=e.token,new Zl(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function tu(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class nu{static V(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=tu(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function iu(e,t){return e<t?-1:e>t?1:0}function su(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class ru{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Hl(zl.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Hl(zl.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Hl(zl.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Hl(zl.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ru.fromMillis(Date.now())}static fromDate(e){return ru.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ru(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?iu(this.nanoseconds,e.nanoseconds):iu(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ou{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ou(e)}static min(){return new ou(new ru(0,0))}static max(){return new ou(new ru(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class au{constructor(e,t,n){void 0===t?t=0:t>e.length&&jl(),void 0===n?n=e.length-t:n>e.length-t&&jl(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===au.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof au?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),s=t.get(i);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class cu extends au{construct(e,t,n){return new cu(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Hl(zl.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new cu(t)}static emptyPath(){return new cu([])}}const lu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class uu extends au{construct(e,t,n){return new uu(e,t,n)}static isValidIdentifier(e){return lu.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),uu.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new uu(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Hl(zl.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let r=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Hl(zl.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Hl(zl.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(r=!r,i++):"."!==t||r?(n+=t,i++):(s(),i++)}if(s(),r)throw new Hl(zl.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new uu(t)}static emptyPath(){return new uu([])}}class hu{constructor(e){this.path=e}static fromPath(e){return new hu(cu.fromString(e))}static fromName(e){return new hu(cu.fromString(e).popFirst(5))}static empty(){return new hu(cu.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===cu.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return cu.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new hu(new cu(e.slice()))}}function du(e){return new fu(e.readTime,e.key,-1)}class fu{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new fu(ou.min(),hu.empty(),-1)}static max(){return new fu(ou.max(),hu.empty(),-1)}}function pu(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=hu.comparator(e.documentKey,t.documentKey),0!==n?n:iu(e.largestBatchId,t.largestBatchId))}const mu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gu{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function yu(e){if(e.code!==zl.FAILED_PRECONDITION||e.message!==mu)throw e;Fl("LocalStore","Unexpectedly lost primary lease")}class vu{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&jl(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new vu(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof vu?t:vu.resolve(t)}catch(e){return vu.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):vu.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):vu.reject(t)}static resolve(e){return new vu(((t,n)=>{t(e)}))}static reject(e){return new vu(((t,n)=>{n(e)}))}static waitFor(e){return new vu(((t,n)=>{let i=0,s=0,r=!1;e.forEach((e=>{++i,e.next((()=>{++s,r&&s===i&&t()}),(e=>n(e)))})),r=!0,s===i&&t()}))}static or(e){let t=vu.resolve(!1);for(const n of e)t=t.next((e=>e?vu.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new vu(((n,i)=>{const s=e.length,r=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;t(e[c]).next((e=>{r[c]=e,++o,o===s&&n(r)}),(e=>i(e)))}}))}static doWhile(e,t){return new vu(((n,i)=>{const s=()=>{!0===e()?t().next((()=>{s()}),i):n()};s()}))}}function wu(e){return"IndexedDbTransactionError"===e.name}class bu{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}function Iu(e){return null==e}function Eu(e){return 0===e&&1/e==-1/0}bu.ae=-1;function Tu(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function _u(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Su(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Cu{constructor(e,t){this.comparator=e,this.root=t||Au.EMPTY}insert(e,t){return new Cu(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Au.BLACK,null,null))}remove(e){return new Cu(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Au.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ku(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ku(this.root,e,this.comparator,!1)}getReverseIterator(){return new ku(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ku(this.root,e,this.comparator,!0)}}class ku{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Au{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=null!=n?n:Au.RED,this.left=null!=i?i:Au.EMPTY,this.right=null!=s?s:Au.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Au(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Au.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Au.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Au.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Au.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw jl();if(this.right.isRed())throw jl();const e=this.left.check();if(e!==this.right.check())throw jl();return e+(this.isRed()?0:1)}}Au.EMPTY=null,Au.RED=!0,Au.BLACK=!1,Au.EMPTY=new class{constructor(){this.size=0}get key(){throw jl()}get value(){throw jl()}get color(){throw jl()}get left(){throw jl()}get right(){throw jl()}copy(e,t,n,i,s){return this}insert(e,t,n){return new Au(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Du{constructor(e){this.comparator=e,this.data=new Cu(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Nu(this.data.getIterator())}getIteratorFrom(e){return new Nu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Du))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Du(this.comparator);return t.data=e,t}}class Nu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ru{constructor(e){this.fields=e,e.sort(uu.comparator)}static empty(){return new Ru([])}unionWith(e){let t=new Du(uu.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Ru(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return su(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ou extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Lu{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ou("Invalid base64 string: "+e):e}}(e);return new Lu(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Lu(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return iu(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lu.EMPTY_BYTE_STRING=new Lu("");const xu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pu(e){if(Bl(!!e),"string"==typeof e){let t=0;const n=xu.exec(e);if(Bl(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Mu(e.seconds),nanos:Mu(e.nanos)}}function Mu(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Fu(e){return"string"==typeof e?Lu.fromBase64String(e):Lu.fromUint8Array(e)}function Uu(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Vu(e){const t=e.mapValue.fields.__previous_value__;return Uu(t)?Vu(t):t}function qu(e){const t=Pu(e.mapValue.fields.__local_write_time__.timestampValue);return new ru(t.seconds,t.nanos)}class ju{constructor(e,t,n,i,s,r,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Bu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Bu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Bu&&e.projectId===this.projectId&&e.database===this.database}}const $u={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function zu(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Uu(e)?4:sh(e)?9007199254740991:10:jl()}function Hu(e,t){if(e===t)return!0;const n=zu(e);if(n!==zu(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return qu(e).isEqual(qu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Pu(e.timestampValue),i=Pu(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Fu(e.bytesValue).isEqual(Fu(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Mu(e.geoPointValue.latitude)===Mu(t.geoPointValue.latitude)&&Mu(e.geoPointValue.longitude)===Mu(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Mu(e.integerValue)===Mu(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Mu(e.doubleValue),i=Mu(t.doubleValue);return n===i?Eu(n)===Eu(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return su(e.arrayValue.values||[],t.arrayValue.values||[],Hu);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Tu(n)!==Tu(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!Hu(n[e],i[e])))return!1;return!0}(e,t);default:return jl()}}function Ku(e,t){return void 0!==(e.values||[]).find((e=>Hu(e,t)))}function Wu(e,t){if(e===t)return 0;const n=zu(e),i=zu(t);if(n!==i)return iu(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return iu(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Mu(e.integerValue||e.doubleValue),i=Mu(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Gu(e.timestampValue,t.timestampValue);case 4:return Gu(qu(e),qu(t));case 5:return iu(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Fu(e),i=Fu(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=iu(n[e],i[e]);if(0!==t)return t}return iu(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=iu(Mu(e.latitude),Mu(t.latitude));return 0!==n?n:iu(Mu(e.longitude),Mu(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=Wu(n[e],i[e]);if(t)return t}return iu(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===$u.mapValue&&t===$u.mapValue)return 0;if(e===$u.mapValue)return 1;if(t===$u.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),s=t.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let e=0;e<i.length&&e<r.length;++e){const t=iu(i[e],r[e]);if(0!==t)return t;const o=Wu(n[i[e]],s[r[e]]);if(0!==o)return o}return iu(i.length,r.length)}(e.mapValue,t.mapValue);default:throw jl()}}function Gu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return iu(e,t);const n=Pu(e),i=Pu(t),s=iu(n.seconds,i.seconds);return 0!==s?s:iu(n.nanos,i.nanos)}function Qu(e){return Ju(e)}function Ju(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Pu(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Fu(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return hu.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Ju(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const s of t)i?i=!1:n+=",",n+=`${s}:${Ju(e.fields[s])}`;return n+"}"}(e.mapValue):jl()}function Xu(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Yu(e){return!!e&&"integerValue"in e}function Zu(e){return!!e&&"arrayValue"in e}function eh(e){return!!e&&"nullValue"in e}function th(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function nh(e){return!!e&&"mapValue"in e}function ih(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return _u(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ih(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ih(e.arrayValue.values[n]);return t}return Object.assign({},e)}function sh(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class rh{constructor(e){this.value=e}static empty(){return new rh({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!nh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ih(t)}setAll(e){let t=uu.emptyPath(),n={},i=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=s.popLast()}e?n[s.lastSegment()]=ih(e):i.push(s.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());nh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];nh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){_u(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new rh(ih(this.value))}}function oh(e){const t=[];return _u(e.fields,((e,n)=>{const i=new uu([e]);if(nh(n)){const e=oh(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new Ru(t)}class ah{constructor(e,t,n,i,s,r,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=r,this.documentState=o}static newInvalidDocument(e){return new ah(e,0,ou.min(),ou.min(),ou.min(),rh.empty(),0)}static newFoundDocument(e,t,n,i){return new ah(e,1,t,ou.min(),n,i,0)}static newNoDocument(e,t){return new ah(e,2,t,ou.min(),ou.min(),rh.empty(),0)}static newUnknownDocument(e,t){return new ah(e,3,t,ou.min(),ou.min(),rh.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ou.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rh.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rh.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ou.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ah&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ah(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ch{constructor(e,t){this.position=e,this.inclusive=t}}function lh(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const r=t[s],o=e.position[s];if(i=r.field.isKeyField()?hu.comparator(hu.fromName(o.referenceValue),n.key):Wu(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function uh(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Hu(e.position[n],t.position[n]))return!1;return!0}class hh{constructor(e,t="asc"){this.field=e,this.dir=t}}function dh(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class fh{}class ph extends fh{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ih(e,t,n):"array-contains"===t?new Sh(e,n):"in"===t?new Ch(e,n):"not-in"===t?new kh(e,n):"array-contains-any"===t?new Ah(e,n):new ph(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Eh(e,n):new Th(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Wu(t,this.value)):null!==t&&zu(this.value)===zu(t)&&this.matchesComparison(Wu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return jl()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class mh extends fh{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new mh(e,t)}matches(e){return gh(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le((e=>e.isInequality()));return null!==e?e.field:null}le(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function gh(e){return"and"===e.op}function yh(e){return function(e){for(const t of e.filters)if(t instanceof mh)return!1;return!0}(e)&&gh(e)}function vh(e){if(e instanceof ph)return e.field.canonicalString()+e.op.toString()+Qu(e.value);if(yh(e))return e.filters.map((e=>vh(e))).join(",");{const t=e.filters.map((e=>vh(e))).join(",");return`${e.op}(${t})`}}function wh(e,t){return e instanceof ph?function(e,t){return t instanceof ph&&e.op===t.op&&e.field.isEqual(t.field)&&Hu(e.value,t.value)}(e,t):e instanceof mh?function(e,t){return t instanceof mh&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&wh(n,t.filters[i])),!0)}(e,t):void jl()}function bh(e){return e instanceof ph?function(e){return`${e.field.canonicalString()} ${e.op} ${Qu(e.value)}`}(e):e instanceof mh?function(e){return e.op.toString()+" {"+e.getFilters().map(bh).join(" ,")+"}"}(e):"Filter"}class Ih extends ph{constructor(e,t,n){super(e,t,n),this.key=hu.fromName(n.referenceValue)}matches(e){const t=hu.comparator(e.key,this.key);return this.matchesComparison(t)}}class Eh extends ph{constructor(e,t){super(e,"in",t),this.keys=_h(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Th extends ph{constructor(e,t){super(e,"not-in",t),this.keys=_h(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function _h(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>hu.fromName(e.referenceValue)))}class Sh extends ph{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zu(t)&&Ku(t.arrayValue,this.value)}}class Ch extends ph{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ku(this.value.arrayValue,t)}}class kh extends ph{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ku(this.value.arrayValue,t)}}class Ah extends ph{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ku(this.value.arrayValue,e)))}}class Dh{constructor(e,t=null,n=[],i=[],s=null,r=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.he=null}}function Nh(e,t=null,n=[],i=[],s=null,r=null,o=null){return new Dh(e,t,n,i,s,r,o)}function Rh(e){const t=$l(e);if(null===t.he){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>vh(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Iu(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Qu(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Qu(e))).join(",")),t.he=e}return t.he}function Oh(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!dh(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wh(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!uh(e.startAt,t.startAt)&&uh(e.endAt,t.endAt)}function Lh(e){return hu.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class xh{constructor(e,t=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this.Pe=null,this.Ie=null,this.startAt,this.endAt}}function Ph(e){return new xh(e)}function Mh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Fh(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Uh(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function Vh(e){return null!==e.collectionGroup}function qh(e){const t=$l(e);if(null===t.Pe){t.Pe=[];const e=Uh(t),n=Fh(t);if(null!==e&&null===n)e.isKeyField()||t.Pe.push(new hh(e)),t.Pe.push(new hh(uu.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.Pe.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.Pe.push(new hh(uu.keyField(),e))}}}return t.Pe}function jh(e){const t=$l(e);if(!t.Ie)if("F"===t.limitType)t.Ie=Nh(t.path,t.collectionGroup,qh(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of qh(t)){const t="desc"===n.dir?"asc":"desc";e.push(new hh(n.field,t))}const n=t.endAt?new ch(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new ch(t.startAt.position,t.startAt.inclusive):null;t.Ie=Nh(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t.Ie}function Bh(e,t){t.getFirstInequalityField(),Uh(e);const n=e.filters.concat([t]);return new xh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function $h(e,t,n){return new xh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function zh(e,t){return Oh(jh(e),jh(t))&&e.limitType===t.limitType}function Hh(e){return`${Rh(jh(e))}|lt:${e.limitType}`}function Kh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>bh(e))).join(", ")}]`),Iu(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Qu(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Qu(e))).join(",")),`Target(${t})`}(jh(e))}; limitType=${e.limitType})`}function Wh(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):hu.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of qh(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=lh(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,qh(e),t)||e.endAt&&!function(e,t,n){const i=lh(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,qh(e),t))}(e,t)}function Gh(e){return(t,n)=>{let i=!1;for(const s of qh(e)){const e=Qh(s,t,n);if(0!==e)return e;i=i||s.field.isKeyField()}return 0}}function Qh(e,t,n){const i=e.field.isKeyField()?hu.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),s=n.data.field(e);return null!==i&&null!==s?Wu(i,s):jl()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return jl()}}class Jh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_u(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return Su(this.inner)}size(){return this.innerSize}}const Xh=new Cu(hu.comparator);function Yh(){return Xh}const Zh=new Cu(hu.comparator);function ed(...e){let t=Zh;for(const n of e)t=t.insert(n.key,n);return t}function td(e){let t=Zh;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function nd(){return sd()}function id(){return sd()}function sd(){return new Jh((e=>e.toString()),((e,t)=>e.isEqual(t)))}const rd=new Cu(hu.comparator),od=new Du(hu.comparator);function ad(...e){let t=od;for(const n of e)t=t.add(n);return t}const cd=new Du(iu);function ld(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Eu(t)?"-0":t}}function ud(e){return{integerValue:""+e}}function hd(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Eu(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?ud(t):ld(e,t)}class dd{constructor(){this._=void 0}}function fd(e,t,n){return e instanceof gd?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Uu(t)&&(t=Vu(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof yd?vd(e,t):e instanceof wd?bd(e,t):function(e,t){const n=md(e,t),i=Ed(n)+Ed(e.Te);return Yu(n)&&Yu(e.Te)?ud(i):ld(e.serializer,i)}(e,t)}function pd(e,t,n){return e instanceof yd?vd(e,t):e instanceof wd?bd(e,t):n}function md(e,t){return e instanceof Id?function(e){return Yu(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class gd extends dd{}class yd extends dd{constructor(e){super(),this.elements=e}}function vd(e,t){const n=Td(t);for(const t of e.elements)n.some((e=>Hu(e,t)))||n.push(t);return{arrayValue:{values:n}}}class wd extends dd{constructor(e){super(),this.elements=e}}function bd(e,t){let n=Td(t);for(const t of e.elements)n=n.filter((e=>!Hu(e,t)));return{arrayValue:{values:n}}}class Id extends dd{constructor(e,t){super(),this.serializer=e,this.Te=t}}function Ed(e){return Mu(e.integerValue||e.doubleValue)}function Td(e){return Zu(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class _d{constructor(e,t){this.field=e,this.transform=t}}class Sd{constructor(e,t){this.version=e,this.transformResults=t}}class Cd{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cd}static exists(e){return new Cd(void 0,e)}static updateTime(e){return new Cd(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kd(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ad{}function Dd(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Vd(e.key,Cd.none()):new xd(e.key,e.data,Cd.none());{const n=e.data,i=rh.empty();let s=new Du(uu.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),s=s.add(e)}return new Pd(e.key,i,new Ru(s.toArray()),Cd.none())}}function Nd(e,t,n){e instanceof xd?function(e,t,n){const i=e.value.clone(),s=Fd(e.fieldTransforms,t,n.transformResults);i.setAll(s),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof Pd?function(e,t,n){if(!kd(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Fd(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Md(e)),s.setAll(i),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Rd(e,t,n,i){return e instanceof xd?function(e,t,n,i){if(!kd(e.precondition,t))return n;const s=e.value.clone(),r=Ud(e.fieldTransforms,i,t);return s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,i):e instanceof Pd?function(e,t,n,i){if(!kd(e.precondition,t))return n;const s=Ud(e.fieldTransforms,i,t),r=t.data;return r.setAll(Md(e)),r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return kd(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Od(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),s=md(i.transform,e||null);null!=s&&(null===n&&(n=rh.empty()),n.set(i.field,s))}return n||null}function Ld(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&su(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof yd&&t instanceof yd||e instanceof wd&&t instanceof wd?su(e.elements,t.elements,Hu):e instanceof Id&&t instanceof Id?Hu(e.Te,t.Te):e instanceof gd&&t instanceof gd}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class xd extends Ad{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Pd extends Ad{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Md(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function Fd(e,t,n){const i=new Map;Bl(e.length===n.length);for(let s=0;s<n.length;s++){const r=e[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,pd(o,a,n[s]))}return i}function Ud(e,t,n){const i=new Map;for(const s of e){const e=s.transform,r=n.data.field(s.field);i.set(s.field,fd(e,r,t))}return i}class Vd extends Ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qd extends Ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class jd{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&Nd(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Rd(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Rd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=id();return this.mutations.forEach((i=>{const s=e.get(i.key),r=s.overlayedDocument;let o=this.applyToLocalView(r,s.mutatedFields);o=t.has(i.key)?null:o;const a=Dd(r,o);null!==a&&n.set(i.key,a),r.isValidDocument()||r.convertToNoDocument(ou.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ad())}isEqual(e){return this.batchId===e.batchId&&su(this.mutations,e.mutations,((e,t)=>Ld(e,t)))&&su(this.baseMutations,e.baseMutations,((e,t)=>Ld(e,t)))}}class Bd{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Bl(e.mutations.length===n.length);let i=rd;const s=e.mutations;for(let e=0;e<s.length;e++)i=i.insert(s[e].key,n[e].version);return new Bd(e,t,n,i)}}class $d{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class zd{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hd,Kd;function Wd(e){if(void 0===e)return Ul("GRPC error has no .code"),zl.UNKNOWN;switch(e){case Hd.OK:return zl.OK;case Hd.CANCELLED:return zl.CANCELLED;case Hd.UNKNOWN:return zl.UNKNOWN;case Hd.DEADLINE_EXCEEDED:return zl.DEADLINE_EXCEEDED;case Hd.RESOURCE_EXHAUSTED:return zl.RESOURCE_EXHAUSTED;case Hd.INTERNAL:return zl.INTERNAL;case Hd.UNAVAILABLE:return zl.UNAVAILABLE;case Hd.UNAUTHENTICATED:return zl.UNAUTHENTICATED;case Hd.INVALID_ARGUMENT:return zl.INVALID_ARGUMENT;case Hd.NOT_FOUND:return zl.NOT_FOUND;case Hd.ALREADY_EXISTS:return zl.ALREADY_EXISTS;case Hd.PERMISSION_DENIED:return zl.PERMISSION_DENIED;case Hd.FAILED_PRECONDITION:return zl.FAILED_PRECONDITION;case Hd.ABORTED:return zl.ABORTED;case Hd.OUT_OF_RANGE:return zl.OUT_OF_RANGE;case Hd.UNIMPLEMENTED:return zl.UNIMPLEMENTED;case Hd.DATA_LOSS:return zl.DATA_LOSS;default:return jl()}}(Kd=Hd||(Hd={}))[Kd.OK=0]="OK",Kd[Kd.CANCELLED=1]="CANCELLED",Kd[Kd.UNKNOWN=2]="UNKNOWN",Kd[Kd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kd[Kd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kd[Kd.NOT_FOUND=5]="NOT_FOUND",Kd[Kd.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kd[Kd.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kd[Kd.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kd[Kd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kd[Kd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kd[Kd.ABORTED=10]="ABORTED",Kd[Kd.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kd[Kd.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kd[Kd.INTERNAL=13]="INTERNAL",Kd[Kd.UNAVAILABLE=14]="UNAVAILABLE",Kd[Kd.DATA_LOSS=15]="DATA_LOSS";class Gd{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Qd}static getOrCreateInstance(){return null===Qd&&(Qd=new Gd),Qd}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let Qd=null;const Jd=new Rl([4294967295,4294967295],0);function Xd(e){const t=(new TextEncoder).encode(e),n=new Nl;return n.update(t),new Uint8Array(n.digest())}function Yd(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new Rl([n,i],0),new Rl([s,r],0)]}class Zd{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ef(`Invalid padding: ${t}`);if(n<0)throw new ef(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ef(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ef(`Invalid padding when bitmap length is 0: ${t}`);this.de=8*e.length-t,this.Ae=Rl.fromNumber(this.de)}Re(e,t,n){let i=e.add(t.multiply(Rl.fromNumber(n)));return 1===i.compare(Jd)&&(i=new Rl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ae).toNumber()}Ve(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.de)return!1;const t=Xd(e),[n,i]=Yd(t);for(let e=0;e<this.hashCount;e++){const t=this.Re(n,i,e);if(!this.Ve(t))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),r=new Zd(s,i,t);return n.forEach((e=>r.insert(e))),r}insert(e){if(0===this.de)return;const t=Xd(e),[n,i]=Yd(t);for(let e=0;e<this.hashCount;e++){const t=this.Re(n,i,e);this.me(t)}}me(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ef extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class tf{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,nf.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new tf(ou.min(),i,new Cu(iu),Yh(),ad())}}class nf{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new nf(n,t,ad(),ad(),ad())}}class sf{constructor(e,t,n,i){this.fe=e,this.removedTargetIds=t,this.key=n,this.ge=i}}class rf{constructor(e,t){this.targetId=e,this.pe=t}}class of{constructor(e,t,n=Lu.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class af{constructor(){this.ye=0,this.we=uf(),this.Se=Lu.EMPTY_BYTE_STRING,this.be=!1,this.De=!0}get current(){return this.be}get resumeToken(){return this.Se}get ve(){return 0!==this.ye}get Ce(){return this.De}Fe(e){e.approximateByteSize()>0&&(this.De=!0,this.Se=e)}Me(){let e=ad(),t=ad(),n=ad();return this.we.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:jl()}})),new nf(this.Se,this.be,e,t,n)}xe(){this.De=!1,this.we=uf()}Oe(e,t){this.De=!0,this.we=this.we.insert(e,t)}Ne(e){this.De=!0,this.we=this.we.remove(e)}Be(){this.ye+=1}Le(){this.ye-=1}ke(){this.De=!0,this.be=!0}}class cf{constructor(e){this.qe=e,this.Qe=new Map,this.Ke=Yh(),this.$e=lf(),this.Ue=new Cu(iu)}We(e){for(const t of e.fe)e.ge&&e.ge.isFoundDocument()?this.Ge(t,e.ge):this.ze(t,e.key,e.ge);for(const t of e.removedTargetIds)this.ze(t,e.key,e.ge)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Fe(e.resumeToken);break;case 1:n.Le(),n.ve||n.xe(),n.Fe(e.resumeToken);break;case 2:n.Le(),n.ve||this.removeTarget(t);break;case 3:this.Je(t)&&(n.ke(),n.Fe(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Fe(e.resumeToken));break;default:jl()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){var t,n;const i=e.targetId,s=e.pe.count,r=this.Xe(i);if(r){const o=r.target;if(Lh(o))if(0===s){const e=new hu(o.path);this.ze(i,e,ah.newNoDocument(e,ou.min()))}else Bl(1===s);else{const r=this.et(i);if(r!==s){const s=this.tt(e,r);if(0!==s.status){this.Ye(i);const e=2===s.status?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(i,e)}null===(t=Gd.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n,i){var s,r,o,a,c,l;const u={localCacheCount:n,existenceFilterCount:i.count},h=i.unchangedNames;return h&&(u.bloomFilter={applied:0===e,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(a=null===(o=null===(r=null==h?void 0:h.bits)||void 0===r?void 0:r.bitmap)||void 0===o?void 0:o.length)&&void 0!==a?a:0,padding:null!==(l=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0},t&&(u.bloomFilter.mightContain=t)),u}(s.status,null!==(n=s.nt)&&void 0!==n?n:null,r,e.pe))}}}}tt(e,t){const{unchangedNames:n,count:i}=e.pe;if(!n||!n.bits)return{status:1};const{bits:{bitmap:s="",padding:r=0},hashCount:o=0}=n;let a,c;try{a=Fu(s).toUint8Array()}catch(e){if(e instanceof Ou)return Vl("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),{status:1};throw e}try{c=new Zd(a,r,o)}catch(e){return Vl(e instanceof ef?"BloomFilter error: ":"Applying bloom filter failed: ",e),{status:1}}const l=e=>{const t=this.qe.rt();return c.mightContain(`projects/${t.projectId}/databases/${t.database}/documents/${e}`)};return 0===c.de?{status:1}:{status:i===t-this.it(e.targetId,l)?0:2,nt:l}}it(e,t){const n=this.qe.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{t(n.path.canonicalString())||(this.ze(e,n,null),i++)})),i}st(e){const t=new Map;this.Qe.forEach(((n,i)=>{const s=this.Xe(i);if(s){if(n.current&&Lh(s.target)){const t=new hu(s.target.path);null!==this.Ke.get(t)||this.ot(i,t)||this.ze(i,t,ah.newNoDocument(t,e))}n.Ce&&(t.set(i,n.Me()),n.xe())}}));let n=ad();this.$e.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.Ke.forEach(((t,n)=>n.setReadTime(e)));const i=new tf(e,t,this.Ue,this.Ke,n);return this.Ke=Yh(),this.$e=lf(),this.Ue=new Cu(iu),i}Ge(e,t){if(!this.Je(e))return;const n=this.ot(e,t.key)?2:0;this.He(e).Oe(t.key,n),this.Ke=this.Ke.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const i=this.He(e);this.ot(e,t)?i.Oe(t,1):i.Ne(t),this.$e=this.$e.insert(t,this._t(t).delete(e)),n&&(this.Ke=this.Ke.insert(t,n))}removeTarget(e){this.Qe.delete(e)}et(e){const t=this.He(e).Me();return this.qe.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Be(e){this.He(e).Be()}He(e){let t=this.Qe.get(e);return t||(t=new af,this.Qe.set(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new Du(iu),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||Fl("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.Qe.get(e);return t&&t.ve?null:this.qe.ut(e)}Ye(e){this.Qe.set(e,new af),this.qe.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ot(e,t){return this.qe.getRemoteKeysForTarget(e).has(t)}}function lf(){return new Cu(hu.comparator)}function uf(){return new Cu(hu.comparator)}const hf={asc:"ASCENDING",desc:"DESCENDING"},df={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ff={and:"AND",or:"OR"};class pf{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function mf(e,t){return e.useProto3Json||Iu(t)?t:{value:t}}function gf(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function yf(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function vf(e,t){return gf(e,t.toTimestamp())}function wf(e){return Bl(!!e),ou.fromTimestamp(function(e){const t=Pu(e);return new ru(t.seconds,t.nanos)}(e))}function bf(e,t){return function(e){return new cu(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function If(e){const t=cu.fromString(e);return Bl(Vf(t)),t}function Ef(e,t){return bf(e.databaseId,t.path)}function Tf(e,t){const n=If(t);if(n.get(1)!==e.databaseId.projectId)throw new Hl(zl.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Hl(zl.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new hu(Cf(n))}function _f(e,t){return bf(e.databaseId,t)}function Sf(e){return new cu(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Cf(e){return Bl(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function kf(e,t,n){return{name:Ef(e,t),fields:n.value.mapValue.fields}}function Af(e,t){return{documents:[_f(e,t.path)]}}function Df(e,t){const n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n.parent=_f(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=_f(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const s=function(e){if(0!==e.length)return Ff(mh.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const r=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Pf(e.field),direction:Of(e.dir)}}(e)))}(t.orderBy);r&&(n.structuredQuery.orderBy=r);const o=mf(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Nf(e){let t=function(e){const t=If(e);return 4===t.length?cu.emptyPath():Cf(t)}(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Bl(1===i);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let r=[];n.where&&(r=function(e){const t=Rf(e);return t instanceof mh&&yh(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new hh(Mf(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Iu(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ch(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new ch(n,t)}(n.endAt)),function(e,t,n,i,s,r,o,a){return new xh(e,t,n,i,s,r,o,a)}(t,s,o,r,a,"F",c,l)}function Rf(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Mf(e.unaryFilter.field);return ph.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Mf(e.unaryFilter.field);return ph.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Mf(e.unaryFilter.field);return ph.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Mf(e.unaryFilter.field);return ph.create(s,"!=",{nullValue:"NULL_VALUE"});default:return jl()}}(e):void 0!==e.fieldFilter?function(e){return ph.create(Mf(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return jl()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return mh.create(e.compositeFilter.filters.map((e=>Rf(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return jl()}}(e.compositeFilter.op))}(e):jl()}function Of(e){return hf[e]}function Lf(e){return df[e]}function xf(e){return ff[e]}function Pf(e){return{fieldPath:e.canonicalString()}}function Mf(e){return uu.fromServerFormat(e.fieldPath)}function Ff(e){return e instanceof ph?function(e){if("=="===e.op){if(th(e.value))return{unaryFilter:{field:Pf(e.field),op:"IS_NAN"}};if(eh(e.value))return{unaryFilter:{field:Pf(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(th(e.value))return{unaryFilter:{field:Pf(e.field),op:"IS_NOT_NAN"}};if(eh(e.value))return{unaryFilter:{field:Pf(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pf(e.field),op:Lf(e.op),value:e.value}}}(e):e instanceof mh?function(e){const t=e.getFilters().map((e=>Ff(e)));return 1===t.length?t[0]:{compositeFilter:{op:xf(e.op),filters:t}}}(e):jl()}function Uf(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Vf(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class qf{constructor(e,t,n,i,s=ou.min(),r=ou.min(),o=Lu.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new qf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new qf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class jf{constructor(e){this.ct=e}}function Bf(e){const t=Nf({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?$h(t,t.limit,"L"):t}class $f{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Mu(e.integerValue));else if("doubleValue"in e){const n=Mu(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),Eu(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Fu(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?sh(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):jl()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),hu.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}$f.bt=new $f;class zf{constructor(){this.sn=new Hf}addToCollectionParentIndex(e,t){return this.sn.add(t),vu.resolve()}getCollectionParents(e,t){return vu.resolve(this.sn.getEntries(t))}addFieldIndex(e,t){return vu.resolve()}deleteFieldIndex(e,t){return vu.resolve()}getDocumentsMatchingTarget(e,t){return vu.resolve(null)}getIndexType(e,t){return vu.resolve(0)}getFieldIndexes(e,t){return vu.resolve([])}getNextCollectionGroupToUpdate(e){return vu.resolve(null)}getMinOffset(e,t){return vu.resolve(fu.min())}getMinOffsetFromCollectionGroup(e,t){return vu.resolve(fu.min())}updateCollectionGroup(e,t,n){return vu.resolve()}updateIndexEntries(e,t){return vu.resolve()}}class Hf{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Du(cu.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Du(cu.comparator)).toArray()}}new Uint8Array(0);class Kf{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Kf(e,Kf.DEFAULT_COLLECTION_PERCENTILE,Kf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Kf.DEFAULT_COLLECTION_PERCENTILE=10,Kf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kf.DEFAULT=new Kf(41943040,Kf.DEFAULT_COLLECTION_PERCENTILE,Kf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kf.DISABLED=new Kf(-1,0,0);class Wf{constructor(e){this.Mn=e}next(){return this.Mn+=2,this.Mn}static xn(){return new Wf(0)}static On(){return new Wf(-1)}}class Gf{constructor(){this.changes=new Jh((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ah.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?vu.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Qf{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Jf{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Rd(n.mutation,e,Ru.empty(),ru.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ad()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=ad()){const i=nd();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=ed();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=nd();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ad())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let s=Yh();const r=sd(),o=sd();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof Pd)?s=s.insert(t.key,t):void 0!==o?(r.set(t.key,o.mutation.getFieldMask()),Rd(o.mutation,t,o.mutation.getFieldMask(),ru.now())):r.set(t.key,Ru.empty())})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>r.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Qf(t,null!==(n=r.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=sd();let i=new Cu(((e,t)=>e-t)),s=ad();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{const r=t.get(e);if(null===r)return;let o=n.get(e)||Ru.empty();o=s.applyToLocalView(r,o),n.set(e,o);const a=(i.get(s.batchId)||ad()).add(e);i=i.insert(s.batchId,a)}))})).next((()=>{const r=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=id();c.forEach((e=>{if(!s.has(e)){const i=Dd(t.get(e),n.get(e));null!==i&&l.set(e,i),s=s.add(e)}})),r.push(this.documentOverlayCache.saveOverlays(e,a,l))}return vu.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return hu.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):vu.resolve(nd());let o=-1,a=s;return r.next((t=>vu.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(t)?vu.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,a,t,ad()))).next((e=>({batchId:o,changes:td(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new hu(t)).next((e=>{let t=ed();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let s=ed();return this.indexManager.getCollectionParents(e,i).next((r=>vu.forEach(r,(r=>{const o=function(e,t){return new xh(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,r.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i)))).next((e=>{i.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,ah.newInvalidDocument(i)))}));let n=ed();return e.forEach(((e,s)=>{const r=i.get(e);void 0!==r&&Rd(r.mutation,s,Ru.empty(),ru.now()),Wh(t,s)&&(n=n.insert(e,s))})),n}))}}class Xf{constructor(e){this.serializer=e,this.ar=new Map,this.ur=new Map}getBundleMetadata(e,t){return vu.resolve(this.ar.get(t))}saveBundleMetadata(e,t){return this.ar.set(t.id,function(e){return{id:e.id,version:e.version,createTime:wf(e.createTime)}}(t)),vu.resolve()}getNamedQuery(e,t){return vu.resolve(this.ur.get(t))}saveNamedQuery(e,t){return this.ur.set(t.name,function(e){return{name:e.name,query:Bf(e.bundledQuery),readTime:wf(e.readTime)}}(t)),vu.resolve()}}class Yf{constructor(){this.overlays=new Cu(hu.comparator),this.cr=new Map}getOverlay(e,t){return vu.resolve(this.overlays.get(t))}getOverlays(e,t){const n=nd();return vu.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ht(e,t,i)})),vu.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.cr.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.cr.delete(n)),vu.resolve()}getOverlaysForCollection(e,t,n){const i=nd(),s=t.length+1,r=new hu(t.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const e=o.getNext().value,r=e.getKey();if(!t.isPrefixOf(r.path))break;r.path.length===s&&e.largestBatchId>n&&i.set(e.getKey(),e)}return vu.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Cu(((e,t)=>e-t));const r=this.overlays.getIterator();for(;r.hasNext();){const e=r.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=nd(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=nd(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return vu.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.cr.get(i.largestBatchId).delete(n.key);this.cr.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new $d(t,n));let s=this.cr.get(t);void 0===s&&(s=ad(),this.cr.set(t,s)),this.cr.set(t,s.add(n.key))}}class Zf{constructor(){this.lr=new Du(ep.hr),this.Pr=new Du(ep.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(e,t){const n=new ep(e,t);this.lr=this.lr.add(n),this.Pr=this.Pr.add(n)}Tr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Er(new ep(e,t))}dr(e,t){e.forEach((e=>this.removeReference(e,t)))}Ar(e){const t=new hu(new cu([])),n=new ep(t,e),i=new ep(t,e+1),s=[];return this.Pr.forEachInRange([n,i],(e=>{this.Er(e),s.push(e.key)})),s}Rr(){this.lr.forEach((e=>this.Er(e)))}Er(e){this.lr=this.lr.delete(e),this.Pr=this.Pr.delete(e)}Vr(e){const t=new hu(new cu([])),n=new ep(t,e),i=new ep(t,e+1);let s=ad();return this.Pr.forEachInRange([n,i],(e=>{s=s.add(e.key)})),s}containsKey(e){const t=new ep(e,0),n=this.lr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ep{constructor(e,t){this.key=e,this.mr=t}static hr(e,t){return hu.comparator(e.key,t.key)||iu(e.mr,t.mr)}static Ir(e,t){return iu(e.mr,t.mr)||hu.comparator(e.key,t.key)}}class tp{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.gr=1,this.pr=new Du(ep.hr)}checkEmpty(e){return vu.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.gr;this.gr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new jd(s,t,n,i);this.mutationQueue.push(r);for(const t of i)this.pr=this.pr.add(new ep(t.key,s)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return vu.resolve(r)}lookupMutationBatch(e,t){return vu.resolve(this.yr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.wr(n),s=i<0?0:i;return vu.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return vu.resolve(0===this.mutationQueue.length?-1:this.gr-1)}getAllMutationBatches(e){return vu.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ep(t,0),i=new ep(t,Number.POSITIVE_INFINITY),s=[];return this.pr.forEachInRange([n,i],(e=>{const t=this.yr(e.mr);s.push(t)})),vu.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Du(iu);return t.forEach((e=>{const t=new ep(e,0),i=new ep(e,Number.POSITIVE_INFINITY);this.pr.forEachInRange([t,i],(e=>{n=n.add(e.mr)}))})),vu.resolve(this.Sr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;hu.isDocumentKey(s)||(s=s.child(""));const r=new ep(new hu(s),0);let o=new Du(iu);return this.pr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.mr)),!0)}),r),vu.resolve(this.Sr(o))}Sr(e){const t=[];return e.forEach((e=>{const n=this.yr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Bl(0===this.br(t.batchId,"removed")),this.mutationQueue.shift();let n=this.pr;return vu.forEach(t.mutations,(i=>{const s=new ep(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.pr=n}))}Cn(e){}containsKey(e,t){const n=new ep(t,0),i=this.pr.firstAfterOrEqual(n);return vu.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,vu.resolve()}br(e,t){return this.wr(e)}wr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}yr(e){const t=this.wr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class np{constructor(e){this.Dr=e,this.docs=new Cu(hu.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,r=this.Dr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return vu.resolve(n?n.document.mutableCopy():ah.newInvalidDocument(t))}getEntries(e,t){let n=Yh();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ah.newInvalidDocument(e))})),vu.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Yh();const r=t.path,o=new hu(r.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!r.isPrefixOf(e.path))break;e.path.length>r.length+1||pu(du(o),n)<=0||(i.has(o.key)||Wh(t,o))&&(s=s.insert(o.key,o.mutableCopy()))}return vu.resolve(s)}getAllFromCollectionGroup(e,t,n,i){jl()}vr(e,t){return vu.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new ip(this)}getSize(e){return vu.resolve(this.size)}}class ip extends Gf{constructor(e){super(),this.sr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.sr.addEntry(e,i)):this.sr.removeEntry(n)})),vu.waitFor(t)}getFromCache(e,t){return this.sr.getEntry(e,t)}getAllFromCache(e,t){return this.sr.getEntries(e,t)}}class sp{constructor(e){this.persistence=e,this.Cr=new Jh((e=>Rh(e)),Oh),this.lastRemoteSnapshotVersion=ou.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new Zf,this.targetCount=0,this.Or=Wf.xn()}forEachTarget(e,t){return this.Cr.forEach(((e,n)=>t(n))),vu.resolve()}getLastRemoteSnapshotVersion(e){return vu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return vu.resolve(this.Fr)}allocateTargetId(e){return this.highestTargetId=this.Or.next(),vu.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Fr&&(this.Fr=t),vu.resolve()}Ln(e){this.Cr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Or=new Wf(t),this.highestTargetId=t),e.sequenceNumber>this.Fr&&(this.Fr=e.sequenceNumber)}addTargetData(e,t){return this.Ln(t),this.targetCount+=1,vu.resolve()}updateTargetData(e,t){return this.Ln(t),vu.resolve()}removeTargetData(e,t){return this.Cr.delete(t.target),this.Mr.Ar(t.targetId),this.targetCount-=1,vu.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Cr.forEach(((r,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Cr.delete(r),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),vu.waitFor(s).next((()=>i))}getTargetCount(e){return vu.resolve(this.targetCount)}getTargetData(e,t){const n=this.Cr.get(t)||null;return vu.resolve(n)}addMatchingKeys(e,t,n){return this.Mr.Tr(t,n),vu.resolve()}removeMatchingKeys(e,t,n){this.Mr.dr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((t=>{s.push(i.markPotentiallyOrphaned(e,t))})),vu.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Mr.Ar(t),vu.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Mr.Vr(t);return vu.resolve(n)}containsKey(e,t){return vu.resolve(this.Mr.containsKey(t))}}class rp{constructor(e,t){this.Nr={},this.overlays={},this.Br=new bu(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=e(this),this.kr=new sp(this),this.indexManager=new zf,this.remoteDocumentCache=function(e){return new np(e)}((e=>this.referenceDelegate.qr(e))),this.serializer=new jf(t),this.Qr=new Xf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Yf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Nr[e.toKey()];return n||(n=new tp(t,this.referenceDelegate),this.Nr[e.toKey()]=n),n}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(e,t,n){Fl("MemoryPersistence","Starting transaction:",e);const i=new op(this.Br.next());return this.referenceDelegate.Kr(),n(i).next((e=>this.referenceDelegate.$r(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Ur(e,t){return vu.or(Object.values(this.Nr).map((n=>()=>n.containsKey(e,t))))}}class op extends gu{constructor(e){super(),this.currentSequenceNumber=e}}class ap{constructor(e){this.persistence=e,this.Wr=new Zf,this.Gr=null}static zr(e){return new ap(e)}get jr(){if(this.Gr)return this.Gr;throw jl()}addReference(e,t,n){return this.Wr.addReference(n,t),this.jr.delete(n.toString()),vu.resolve()}removeReference(e,t,n){return this.Wr.removeReference(n,t),this.jr.add(n.toString()),vu.resolve()}markPotentiallyOrphaned(e,t){return this.jr.add(t.toString()),vu.resolve()}removeTarget(e,t){this.Wr.Ar(t.targetId).forEach((e=>this.jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Kr(){this.Gr=new Set}$r(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return vu.forEach(this.jr,(n=>{const i=hu.fromPath(n);return this.Hr(e,i).next((e=>{e||t.removeEntry(i,ou.min())}))})).next((()=>(this.Gr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hr(e,t).next((e=>{e?this.jr.delete(t.toString()):this.jr.add(t.toString())}))}qr(e){return 0}Hr(e,t){return vu.or([()=>vu.resolve(this.Wr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ur(e,t)])}}class cp{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Li=n,this.ki=i}static qi(e,t){let n=ad(),i=ad();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new cp(e,t.fromCache,n,i)}}class lp{constructor(){this.Qi=!1}initialize(e,t){this.Ki=e,this.indexManager=t,this.Qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.$i(e,t).next((s=>s||this.Ui(e,t,i,n))).next((n=>n||this.Wi(e,t)))}$i(e,t){if(Mh(t))return vu.resolve(null);let n=jh(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=$h(t,null,"F"),n=jh(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const s=ad(...i);return this.Ki.getDocuments(e,s).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const r=this.Gi(t,i);return this.zi(t,r,s,n.readTime)?this.$i(e,$h(t,null,"F")):this.ji(e,r,t,n)}))))})))))}Ui(e,t,n,i){return Mh(t)||i.isEqual(ou.min())?this.Wi(e,t):this.Ki.getDocuments(e,n).next((s=>{const r=this.Gi(t,s);return this.zi(t,r,n,i)?this.Wi(e,t):(Ml()<=M.DEBUG&&Fl("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Kh(t)),this.ji(e,r,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=ou.fromTimestamp(1e9===i?new ru(n+1,0):new ru(n,i));return new fu(s,hu.empty(),t)}(i,-1)))}))}Gi(e,t){let n=new Du(Gh(e));return t.forEach(((t,i)=>{Wh(e,i)&&(n=n.add(i))})),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Wi(e,t){return Ml()<=M.DEBUG&&Fl("QueryEngine","Using full collection scan to execute query:",Kh(t)),this.Ki.getDocumentsMatchingQuery(e,t,fu.min())}ji(e,t,n,i){return this.Ki.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class up{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new Cu(iu),this.Yi=new Jh((e=>Rh(e)),Oh),this.Zi=new Map,this.Xi=e.getRemoteDocumentCache(),this.kr=e.getTargetCache(),this.Qr=e.getBundleCache(),this.es(n)}es(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Jf(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}async function hp(e,t){const n=$l(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((s=>(i=s,n.es(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],r=[];let o=ad();for(const e of i){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ts:e,removedBatchIds:s,addedBatchIds:r})))}))}))}function dp(e){const t=$l(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.kr.getLastRemoteSnapshotVersion(e)))}function fp(e,t){const n=$l(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}async function pp(e,t,n){const i=$l(e),s=i.Ji.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(e=>i.persistence.referenceDelegate.removeTarget(e,s)))}catch(e){if(!wu(e))throw e;Fl("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.Ji=i.Ji.remove(t),i.Yi.delete(s.target)}function mp(e,t,n){const i=$l(e);let s=ou.min(),r=ad();return i.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const i=$l(e),s=i.Yi.get(n);return void 0!==s?vu.resolve(i.Ji.get(s)):i.kr.getTargetData(t,n)}(i,e,jh(t)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,i.kr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{r=e}))})).next((()=>i.Hi.getDocumentsMatchingQuery(e,t,n?s:ou.min(),n?r:ad()))).next((e=>(function(e,t,n){let i=e.Zi.get(t)||ou.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.Zi.set(t,i)}(i,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ss:r})))))}class gp{constructor(){this.activeTargetIds=cd}hs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ps(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ls(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yp{constructor(){this.Hs=new gp,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hs.hs(e),this.Js[e]||"not-current"}updateQueryState(e,t,n){this.Js[e]=t}removeLocalQueryTarget(e){this.Hs.Ps(e)}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){delete this.Js[e]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(e){return this.Hs.activeTargetIds.has(e)}start(){return this.Hs=new gp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class vp{Ys(e){}shutdown(){}}class wp{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(e){this.ro.push(e)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){Fl("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ro)e(0)}no(){Fl("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ro)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let bp=null;function Ip(){return null===bp?bp=268435456+Math.round(2147483648*Math.random()):bp++,"0x"+bp.toString(16)}const Ep={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Tp{constructor(e){this.so=e.so,this.oo=e.oo}_o(e){this.ao=e}uo(e){this.co=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.so(e)}ho(){this.ao()}Po(e){this.co(e)}Io(e){this.lo(e)}}const _p="WebChannelConnection";class Sp extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.To=t+"://"+e.host,this.Eo=`projects/${n}/databases/${i}`,this.Ao="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Ro(){return!1}Vo(e,t,n,i,s){const r=Ip(),o=this.mo(e,t);Fl("RestConnection",`Sending RPC '${e}' ${r}:`,o,n);const a={"google-cloud-resource-prefix":this.Eo,"x-goog-request-params":this.Ao};return this.fo(a,i,s),this.po(e,o,a,n).then((t=>(Fl("RestConnection",`Received RPC '${e}' ${r}: `,t),t)),(t=>{throw Vl("RestConnection",`RPC '${e}' ${r} failed with error: `,t,"url: ",o,"request:",n),t}))}yo(e,t,n,i,s,r){return this.Vo(e,t,n,i,s)}fo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+xl,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}mo(e,t){const n=Ep[e];return`${this.To}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}po(e,t,n,i){const s=Ip();return new Promise(((r,o)=>{const a=new Dl;a.setWithCredentials(!0),a.listenOnce(_l.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Tl.NO_ERROR:const t=a.getResponseJson();Fl(_p,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),r(t);break;case Tl.TIMEOUT:Fl(_p,`RPC '${e}' ${s} timed out`),o(new Hl(zl.DEADLINE_EXCEEDED,"Request time out"));break;case Tl.HTTP_ERROR:const n=a.getStatus();if(Fl(_p,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(zl).indexOf(t)>=0?t:zl.UNKNOWN}(t.status);o(new Hl(e,t.message))}else o(new Hl(zl.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Hl(zl.UNAVAILABLE,"Connection failed."));break;default:jl()}}finally{Fl(_p,`RPC '${e}' ${s} completed.`)}}));const c=JSON.stringify(i);Fl(_p,`RPC '${e}' ${s} sending request:`,i),a.send(t,"POST",c,n,15)}))}wo(e,t,n){const i=Ip(),s=[this.To,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=Il(),o=El(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.xmlHttpFactory=new kl({})),this.fo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const l=s.join("");Fl(_p,`Creating RPC '${e}' stream ${i}: ${l}`,a);const u=r.createWebChannel(l,a);let h=!1,d=!1;const f=new Tp({so:t=>{d?Fl(_p,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(Fl(_p,`Opening RPC '${e}' stream ${i} transport.`),u.open(),h=!0),Fl(_p,`RPC '${e}' stream ${i} sending:`,t),u.send(t))},oo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,Al.EventType.OPEN,(()=>{d||Fl(_p,`RPC '${e}' stream ${i} transport opened.`)})),p(u,Al.EventType.CLOSE,(()=>{d||(d=!0,Fl(_p,`RPC '${e}' stream ${i} transport closed`),f.Po())})),p(u,Al.EventType.ERROR,(t=>{d||(d=!0,Vl(_p,`RPC '${e}' stream ${i} transport errored:`,t),f.Po(new Hl(zl.UNAVAILABLE,"The operation could not be completed")))})),p(u,Al.EventType.MESSAGE,(t=>{var n;if(!d){const s=t.data[0];Bl(!!s);const r=s,o=r.error||(null===(n=r[0])||void 0===n?void 0:n.error);if(o){Fl(_p,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=Hd[e];if(void 0!==t)return Wd(t)}(t),s=o.message;void 0===n&&(n=zl.INTERNAL,s="Unknown error status: "+t+" with message "+o.message),d=!0,f.Po(new Hl(n,s)),u.close()}else Fl(_p,`RPC '${e}' stream ${i} received:`,s),f.Io(s)}})),p(o,Sl.STAT_EVENT,(t=>{t.stat===Cl.PROXY?Fl(_p,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===Cl.NOPROXY&&Fl(_p,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.ho()}),0),f}}function Cp(){return"undefined"!=typeof document?document:null}function kp(e){return new pf(e,!0)}class Ap{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.So=n,this.bo=i,this.Do=s,this.vo=0,this.Co=null,this.Fo=Date.now(),this.reset()}reset(){this.vo=0}Mo(){this.vo=this.Do}xo(e){this.cancel();const t=Math.floor(this.vo+this.Oo()),n=Math.max(0,Date.now()-this.Fo),i=Math.max(0,t-n);i>0&&Fl("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.vo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Co=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Fo=Date.now(),e()))),this.vo*=this.bo,this.vo<this.So&&(this.vo=this.So),this.vo>this.Do&&(this.vo=this.Do)}No(){null!==this.Co&&(this.Co.skipDelay(),this.Co=null)}cancel(){null!==this.Co&&(this.Co.cancel(),this.Co=null)}Oo(){return(Math.random()-.5)*this.vo}}class Dp{constructor(e,t,n,i,s,r,o,a){this.ii=e,this.Bo=n,this.Lo=i,this.connection=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.ko=0,this.qo=null,this.Qo=null,this.stream=null,this.Ko=new Ap(e,t)}$o(){return 1===this.state||5===this.state||this.Uo()}Uo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Wo()}async stop(){this.$o()&&await this.close(0)}Go(){this.state=0,this.Ko.reset()}zo(){this.Uo()&&null===this.qo&&(this.qo=this.ii.enqueueAfterDelay(this.Bo,6e4,(()=>this.jo())))}Ho(e){this.Jo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}Yo(){this.Qo&&(this.Qo.cancel(),this.Qo=null)}async close(e,t){this.Jo(),this.Yo(),this.Ko.cancel(),this.ko++,4!==e?this.Ko.reset():t&&t.code===zl.RESOURCE_EXHAUSTED?(Ul(t.toString()),Ul("Using maximum backoff delay to prevent overloading the backend."),this.Ko.Mo()):t&&t.code===zl.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Zo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.uo(t)}Zo(){}auth(){this.state=1;const e=this.Xo(this.ko),t=this.ko;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.ko===t&&this.e_(e,n)}),(t=>{e((()=>{const e=new Hl(zl.UNKNOWN,"Fetching auth token failed: "+t.message);return this.t_(e)}))}))}e_(e,t){const n=this.Xo(this.ko);this.stream=this.n_(e,t),this.stream._o((()=>{n((()=>(this.state=2,this.Qo=this.ii.enqueueAfterDelay(this.Lo,1e4,(()=>(this.Uo()&&(this.state=3),Promise.resolve()))),this.listener._o())))})),this.stream.uo((e=>{n((()=>this.t_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Wo(){this.state=5,this.Ko.xo((async()=>{this.state=0,this.start()}))}t_(e){return Fl("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.ko===e?t():(Fl("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Np extends Dp{constructor(e,t,n,i,s,r){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,r),this.serializer=s}n_(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.Ko.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:jl()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=function(e,t){return e.useProto3Json?(Bl(void 0===t||"string"==typeof t),Lu.fromBase64String(t||"")):(Bl(void 0===t||t instanceof Uint8Array),Lu.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?zl.UNKNOWN:Wd(e.code);return new Hl(t,e.message||"")}(o);n=new of(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=Tf(e,i.document.name),r=wf(i.document.updateTime),o=i.document.createTime?wf(i.document.createTime):ou.min(),a=new rh({mapValue:{fields:i.document.fields}}),c=ah.newFoundDocument(s,r,o,a),l=i.targetIds||[],u=i.removedTargetIds||[];n=new sf(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=Tf(e,i.document),r=i.readTime?wf(i.readTime):ou.min(),o=ah.newNoDocument(s,r),a=i.removedTargetIds||[];n=new sf([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=Tf(e,i.document),r=i.removedTargetIds||[];n=new sf([],r,s,null)}else{if(!("filter"in t))return jl();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:s}=e,r=new zd(i,s),o=e.targetId;n=new rf(o,r)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ou.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ou.min():t.readTime?wf(t.readTime):ou.min()}(e);return this.listener.r_(t,n)}i_(e){const t={};t.database=Sf(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Lh(i)?{documents:Af(e,i)}:{query:Df(e,i)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=yf(e,t.resumeToken);const i=mf(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(ou.min())>0){n.readTime=gf(e,t.snapshotVersion.toTimestamp());const i=mf(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return jl()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Ho(t)}s_(e){const t={};t.database=Sf(this.serializer),t.removeTarget=e,this.Ho(t)}}class Rp extends Dp{constructor(e,t,n,i,s,r){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,r),this.serializer=s,this.o_=!1}get __(){return this.o_}start(){this.o_=!1,this.lastStreamToken=void 0,super.start()}Zo(){this.o_&&this.a_([])}n_(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(Bl(!!e.streamToken),this.lastStreamToken=e.streamToken,this.o_){this.Ko.reset();const t=function(e,t){return e&&e.length>0?(Bl(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?wf(e.updateTime):wf(t);return n.isEqual(ou.min())&&(n=wf(t)),new Sd(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=wf(e.commitTime);return this.listener.u_(n,t)}return Bl(!e.writeResults||0===e.writeResults.length),this.o_=!0,this.listener.c_()}l_(){const e={};e.database=Sf(this.serializer),this.Ho(e)}a_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>function(e,t){let n;if(t instanceof xd)n={update:kf(e,t.key,t.value)};else if(t instanceof Vd)n={delete:Ef(e,t.key)};else if(t instanceof Pd)n={update:kf(e,t.key,t.data),updateMask:Uf(t.fieldMask)};else{if(!(t instanceof qd))return jl();n={verify:Ef(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof gd)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof yd)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wd)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Id)return{fieldPath:t.field.canonicalString(),increment:n.Te};throw jl()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:vf(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:jl()}(e,t.precondition)),n}(this.serializer,e)))};this.Ho(t)}}class Op extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.h_=!1}P_(){if(this.h_)throw new Hl(zl.FAILED_PRECONDITION,"The client has already been terminated.")}Vo(e,t,n){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Vo(e,t,n,i,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===zl.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Hl(zl.UNKNOWN,e.toString())}))}yo(e,t,n,i){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.connection.yo(e,t,n,s,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===zl.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Hl(zl.UNKNOWN,e.toString())}))}terminate(){this.h_=!0}}class Lp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.T_=0,this.E_=null,this.d_=!0}A_(){0===this.T_&&(this.R_("Unknown"),this.E_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.E_=null,this.V_("Backend didn't respond within 10 seconds."),this.R_("Offline"),Promise.resolve()))))}m_(e){"Online"===this.state?this.R_("Unknown"):(this.T_++,this.T_>=1&&(this.f_(),this.V_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.R_("Offline")))}set(e){this.f_(),this.T_=0,"Online"===e&&(this.d_=!1),this.R_(e)}R_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}V_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.d_?(Ul(t),this.d_=!1):Fl("OnlineStateTracker",t)}f_(){null!==this.E_&&(this.E_.cancel(),this.E_=null)}}class xp{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.g_=[],this.p_=new Map,this.y_=new Set,this.w_=[],this.S_=s,this.S_.Ys((e=>{n.enqueueAndForget((async()=>{$p(this)&&(Fl("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=$l(e);t.y_.add(4),await Mp(t),t.b_.set("Unknown"),t.y_.delete(4),await Pp(t)}(this))}))})),this.b_=new Lp(n,i)}}async function Pp(e){if($p(e))for(const t of e.w_)await t(!0)}async function Mp(e){for(const t of e.w_)await t(!1)}function Fp(e,t){const n=$l(e);n.p_.has(t.targetId)||(n.p_.set(t.targetId,t),Bp(n)?jp(n):om(n).Uo()&&Vp(n,t))}function Up(e,t){const n=$l(e),i=om(n);n.p_.delete(t),i.Uo()&&qp(n,t),0===n.p_.size&&(i.Uo()?i.zo():$p(n)&&n.b_.set("Unknown"))}function Vp(e,t){if(e.D_.Be(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ou.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}om(e).i_(t)}function qp(e,t){e.D_.Be(t),om(e).s_(t)}function jp(e){e.D_=new cf({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ut:t=>e.p_.get(t)||null,rt:()=>e.datastore.serializer.databaseId}),om(e).start(),e.b_.A_()}function Bp(e){return $p(e)&&!om(e).$o()&&e.p_.size>0}function $p(e){return 0===$l(e).y_.size}function zp(e){e.D_=void 0}async function Hp(e){e.p_.forEach(((t,n)=>{Vp(e,t)}))}async function Kp(e,t){zp(e),Bp(e)?(e.b_.m_(t),jp(e)):e.b_.set("Unknown")}async function Wp(e,t,n){if(e.b_.set("Online"),t instanceof of&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.p_.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.p_.delete(i),e.D_.removeTarget(i))}(e,t)}catch(n){Fl("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Gp(e,n)}else if(t instanceof sf?e.D_.We(t):t instanceof rf?e.D_.Ze(t):e.D_.je(t),!n.isEqual(ou.min()))try{const t=await dp(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.D_.st(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.p_.get(i);s&&e.p_.set(i,s.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const i=e.p_.get(t);if(!i)return;e.p_.set(t,i.withResumeToken(Lu.EMPTY_BYTE_STRING,i.snapshotVersion)),qp(e,t);const s=new qf(i.target,t,n,i.sequenceNumber);Vp(e,s)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Fl("RemoteStore","Failed to raise snapshot:",t),await Gp(e,t)}}async function Gp(e,t,n){if(!wu(t))throw t;e.y_.add(1),await Mp(e),e.b_.set("Offline"),n||(n=()=>dp(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Fl("RemoteStore","Retrying IndexedDB access"),await n(),e.y_.delete(1),await Pp(e)}))}function Qp(e,t){return t().catch((n=>Gp(e,n,t)))}async function Jp(e){const t=$l(e),n=am(t);let i=t.g_.length>0?t.g_[t.g_.length-1].batchId:-1;for(;Xp(t);)try{const e=await fp(t.localStore,i);if(null===e){0===t.g_.length&&n.zo();break}i=e.batchId,Yp(t,e)}catch(e){await Gp(t,e)}Zp(t)&&em(t)}function Xp(e){return $p(e)&&e.g_.length<10}function Yp(e,t){e.g_.push(t);const n=am(e);n.Uo()&&n.__&&n.a_(t.mutations)}function Zp(e){return $p(e)&&!am(e).$o()&&e.g_.length>0}function em(e){am(e).start()}async function tm(e){am(e).l_()}async function nm(e){const t=am(e);for(const n of e.g_)t.a_(n.mutations)}async function im(e,t,n){const i=e.g_.shift(),s=Bd.from(i,t,n);await Qp(e,(()=>e.remoteSyncer.applySuccessfulWrite(s))),await Jp(e)}async function sm(e,t){t&&am(e).__&&await async function(e,t){if(function(e){return function(e){switch(e){default:return jl();case zl.CANCELLED:case zl.UNKNOWN:case zl.DEADLINE_EXCEEDED:case zl.RESOURCE_EXHAUSTED:case zl.INTERNAL:case zl.UNAVAILABLE:case zl.UNAUTHENTICATED:return!1;case zl.INVALID_ARGUMENT:case zl.NOT_FOUND:case zl.ALREADY_EXISTS:case zl.PERMISSION_DENIED:case zl.FAILED_PRECONDITION:case zl.ABORTED:case zl.OUT_OF_RANGE:case zl.UNIMPLEMENTED:case zl.DATA_LOSS:return!0}}(e)&&e!==zl.ABORTED}(t.code)){const n=e.g_.shift();am(e).Go(),await Qp(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Jp(e)}}(e,t),Zp(e)&&em(e)}async function rm(e,t){const n=$l(e);n.asyncQueue.verifyOperationInProgress(),Fl("RemoteStore","RemoteStore received new credentials");const i=$p(n);n.y_.add(3),await Mp(n),i&&n.b_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.y_.delete(3),await Pp(n)}function om(e){return e.v_||(e.v_=function(e,t,n){const i=$l(e);return i.P_(),new Np(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{_o:Hp.bind(null,e),uo:Kp.bind(null,e),r_:Wp.bind(null,e)}),e.w_.push((async t=>{t?(e.v_.Go(),Bp(e)?jp(e):e.b_.set("Unknown")):(await e.v_.stop(),zp(e))}))),e.v_}function am(e){return e.C_||(e.C_=function(e,t,n){const i=$l(e);return i.P_(),new Rp(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{_o:tm.bind(null,e),uo:sm.bind(null,e),c_:nm.bind(null,e),u_:im.bind(null,e)}),e.w_.push((async t=>{t?(e.C_.Go(),await Jp(e)):(await e.C_.stop(),e.g_.length>0&&(Fl("RemoteStore",`Stopping write stream with ${e.g_.length} pending writes`),e.g_=[]))}))),e.C_}class cm{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Kl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,s){const r=Date.now()+n,o=new cm(e,t,r,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Hl(zl.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lm(e,t){if(Ul("AsyncQueue",`${t}: ${e}`),wu(e))return new Hl(zl.UNAVAILABLE,`${t}: ${e}`);throw e}class um{constructor(e){this.comparator=e?(t,n)=>e(t,n)||hu.comparator(t.key,n.key):(e,t)=>hu.comparator(e.key,t.key),this.keyedMap=ed(),this.sortedSet=new Cu(this.comparator)}static emptySet(e){return new um(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof um))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new um;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class hm{constructor(){this.F_=new Cu(hu.comparator)}track(e){const t=e.doc.key,n=this.F_.get(t);n?0!==e.type&&3===n.type?this.F_=this.F_.insert(t,e):3===e.type&&1!==n.type?this.F_=this.F_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.F_=this.F_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.F_=this.F_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.F_=this.F_.remove(t):1===e.type&&2===n.type?this.F_=this.F_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.F_=this.F_.insert(t,{type:2,doc:e.doc}):jl():this.F_=this.F_.insert(t,e)}M_(){const e=[];return this.F_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class dm{constructor(e,t,n,i,s,r,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,i,s){const r=[];return t.forEach((e=>{r.push({type:0,doc:e})})),new dm(e,t,um.emptySet(t),r,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class fm{constructor(){this.x_=void 0,this.listeners=[]}}class pm{constructor(){this.queries=new Jh((e=>Hh(e)),zh),this.onlineState="Unknown",this.O_=new Set}}async function mm(e,t){const n=$l(e),i=t.query;let s=!1,r=n.queries.get(i);if(r||(s=!0,r=new fm),s)try{r.x_=await n.onListen(i)}catch(e){const n=lm(e,`Initialization of query '${Kh(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,r),r.listeners.push(t),t.N_(n.onlineState),r.x_&&t.B_(r.x_)&&wm(n)}async function gm(e,t){const n=$l(e),i=t.query;let s=!1;const r=n.queries.get(i);if(r){const e=r.listeners.indexOf(t);e>=0&&(r.listeners.splice(e,1),s=0===r.listeners.length)}if(s)return n.queries.delete(i),n.onUnlisten(i)}function ym(e,t){const n=$l(e);let i=!1;for(const e of t){const t=e.query,s=n.queries.get(t);if(s){for(const t of s.listeners)t.B_(e)&&(i=!0);s.x_=e}}i&&wm(n)}function vm(e,t,n){const i=$l(e),s=i.queries.get(t);if(s)for(const e of s.listeners)e.onError(n);i.queries.delete(t)}function wm(e){e.O_.forEach((e=>{e.next()}))}class bm{constructor(e,t,n){this.query=e,this.L_=t,this.k_=!1,this.q_=null,this.onlineState="Unknown",this.options=n||{}}B_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new dm(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.k_?this.Q_(e)&&(this.L_.next(e),t=!0):this.K_(e,this.onlineState)&&(this.U_(e),t=!0),this.q_=e,t}onError(e){this.L_.error(e)}N_(e){this.onlineState=e;let t=!1;return this.q_&&!this.k_&&this.K_(this.q_,e)&&(this.U_(this.q_),t=!0),t}K_(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.W_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Q_(e){if(e.docChanges.length>0)return!0;const t=this.q_&&this.q_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}U_(e){e=dm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.k_=!0,this.L_.next(e)}}class Im{constructor(e){this.key=e}}class Em{constructor(e){this.key=e}}class Tm{constructor(e,t){this.query=e,this.X_=t,this.ea=null,this.hasCachedResults=!1,this.current=!1,this.ta=ad(),this.mutatedKeys=ad(),this.na=Gh(e),this.ra=new um(this.na)}get ia(){return this.X_}sa(e,t){const n=t?t.oa:new hm,i=t?t.ra:this.ra;let s=t?t.mutatedKeys:this.mutatedKeys,r=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const l=i.get(e),u=Wh(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this._a(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.na(u,a)>0||c&&this.na(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(u?(r=r.add(u),s=d?s.add(e):s.delete(e)):(r=r.delete(e),s=s.delete(e)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const e="F"===this.query.limitType?r.last():r.first();r=r.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{ra:r,oa:n,zi:o,mutatedKeys:s}}_a(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ra;this.ra=e.ra,this.mutatedKeys=e.mutatedKeys;const s=e.oa.M_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jl()}};return n(e)-n(t)}(e.type,t.type)||this.na(e.doc,t.doc))),this.aa(n);const r=t?this.ua():[],o=0===this.ta.size&&this.current?1:0,a=o!==this.ea;return this.ea=o,0!==s.length||a?{snapshot:new dm(this.query,e.ra,i,s,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),ca:r}:{ca:r}}N_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ra:this.ra,oa:new hm,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{ca:[]}}la(e){return!this.X_.has(e)&&!!this.ra.has(e)&&!this.ra.get(e).hasLocalMutations}aa(e){e&&(e.addedDocuments.forEach((e=>this.X_=this.X_.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.X_=this.X_.delete(e))),this.current=e.current)}ua(){if(!this.current)return[];const e=this.ta;this.ta=ad(),this.ra.forEach((e=>{this.la(e.key)&&(this.ta=this.ta.add(e.key))}));const t=[];return e.forEach((e=>{this.ta.has(e)||t.push(new Em(e))})),this.ta.forEach((n=>{e.has(n)||t.push(new Im(n))})),t}ha(e){this.X_=e.ss,this.ta=ad();const t=this.sa(e.documents);return this.applyChanges(t,!0)}Pa(){return dm.fromInitialDocuments(this.query,this.ra,this.mutatedKeys,0===this.ea,this.hasCachedResults)}}class _m{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Sm{constructor(e){this.key=e,this.Ia=!1}}class Cm{constructor(e,t,n,i,s,r){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.Ta={},this.Ea=new Jh((e=>Hh(e)),zh),this.da=new Map,this.Aa=new Set,this.Ra=new Cu(hu.comparator),this.Va=new Map,this.ma=new Zf,this.fa={},this.ga=new Map,this.pa=Wf.On(),this.onlineState="Unknown",this.ya=void 0}get isPrimaryClient(){return!0===this.ya}}async function km(e,t){const n=function(e){const t=$l(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Dm.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=$m.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Rm.bind(null,t),t.Ta.r_=ym.bind(null,t.eventManager),t.Ta.Sa=vm.bind(null,t.eventManager),t}(e);let i,s;const r=n.Ea.get(t);if(r)i=r.targetId,n.sharedClientState.addLocalQueryTarget(i),s=r.view.Pa();else{const e=await function(e,t){const n=$l(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.kr.getTargetData(e,t).next((s=>s?(i=s,vu.resolve(i)):n.kr.allocateTargetId(e).next((s=>(i=new qf(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.kr.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.Ji.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}(n.localStore,jh(t)),r=n.sharedClientState.addLocalQueryTarget(e.targetId);i=e.targetId,s=await async function(e,t,n,i,s){e.wa=(t,n,i)=>async function(e,t,n,i){let s=t.view.sa(n);s.zi&&(s=await mp(e.localStore,t.query,!1).then((({documents:e})=>t.view.sa(e,s))));const r=i&&i.targetChanges.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,r);return Um(e,t.targetId,o.ca),o.snapshot}(e,t,n,i);const r=await mp(e.localStore,t,!0),o=new Tm(t,r.ss),a=o.sa(r.documents),c=nf.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,s),l=o.applyChanges(a,e.isPrimaryClient,c);Um(e,n,l.ca);const u=new _m(t,n,o);return e.Ea.set(t,u),e.da.has(n)?e.da.get(n).push(t):e.da.set(n,[t]),l.snapshot}(n,t,i,"current"===r,e.resumeToken),n.isPrimaryClient&&Fp(n.remoteStore,e)}return s}async function Am(e,t){const n=$l(e),i=n.Ea.get(t),s=n.da.get(i.targetId);if(s.length>1)return n.da.set(i.targetId,s.filter((e=>!zh(e,t)))),void n.Ea.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await pp(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),Up(n.remoteStore,i.targetId),Mm(n,i.targetId)})).catch(yu)):(Mm(n,i.targetId),await pp(n.localStore,i.targetId,!0))}async function Dm(e,t){const n=$l(e);try{const e=await function(e,t){const n=$l(e),i=t.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const r=n.Xi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const o=[];t.targetChanges.forEach(((r,a)=>{const c=s.get(a);if(!c)return;o.push(n.kr.removeMatchingKeys(e,r.removedDocuments,a).next((()=>n.kr.addMatchingKeys(e,r.addedDocuments,a))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?l=l.withResumeToken(Lu.EMPTY_BYTE_STRING,ou.min()).withLastLimboFreeSnapshotVersion(ou.min()):r.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(r.resumeToken,i)),s=s.insert(a,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,r)&&o.push(n.kr.updateTargetData(e,l))}));let a=Yh(),c=ad();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),o.push(function(e,t,n){let i=ad(),s=ad();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=Yh();return n.forEach(((n,r)=>{const o=e.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),r.isNoDocument()&&r.version.isEqual(ou.min())?(t.removeEntry(n,r.readTime),i=i.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(r),i=i.insert(n,r)):Fl("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{ns:i,rs:s}}))}(e,r,t.documentUpdates).next((e=>{a=e.ns,c=e.rs}))),!i.isEqual(ou.min())){const t=n.kr.getLastRemoteSnapshotVersion(e).next((t=>n.kr.setTargetsMetadata(e,e.currentSequenceNumber,i)));o.push(t)}return vu.waitFor(o).next((()=>r.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.Ji=s,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.Va.get(t);i&&(Bl(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.Ia=!0:e.modifiedDocuments.size>0?Bl(i.Ia):e.removedDocuments.size>0&&(Bl(i.Ia),i.Ia=!1))})),await jm(n,e,t)}catch(e){await yu(e)}}function Nm(e,t,n){const i=$l(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Ea.forEach(((n,i)=>{const s=i.view.N_(t);s.snapshot&&e.push(s.snapshot)})),function(e,t){const n=$l(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.N_(t)&&(i=!0)})),i&&wm(n)}(i.eventManager,t),e.length&&i.Ta.r_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Rm(e,t,n){const i=$l(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.Va.get(t),r=s&&s.key;if(r){let e=new Cu(hu.comparator);e=e.insert(r,ah.newNoDocument(r,ou.min()));const n=ad().add(r),s=new tf(ou.min(),new Map,new Cu(iu),e,n);await Dm(i,s),i.Ra=i.Ra.remove(r),i.Va.delete(t),qm(i)}else await pp(i.localStore,t,!1).then((()=>Mm(i,t,n))).catch(yu)}async function Om(e,t){const n=$l(e),i=t.batch.batchId;try{const e=await function(e,t){const n=$l(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),s=n.Xi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const s=n.batch,r=s.keys();let o=vu.resolve();return r.forEach((e=>{o=o.next((()=>i.getEntry(t,e))).next((t=>{const r=n.docVersions.get(e);Bl(null!==r),t.version.compareTo(r)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,s)))}(n,e,t,s).next((()=>s.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ad();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);Pm(n,i,null),xm(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await jm(n,e)}catch(e){await yu(e)}}async function Lm(e,t,n){const i=$l(e);try{const e=await function(e,t){const n=$l(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Bl(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);Pm(i,t,n),xm(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await jm(i,e)}catch(n){await yu(n)}}function xm(e,t){(e.ga.get(t)||[]).forEach((e=>{e.resolve()})),e.ga.delete(t)}function Pm(e,t,n){const i=$l(e);let s=i.fa[i.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),i.fa[i.currentUser.toKey()]=s}}function Mm(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.da.get(t))e.Ea.delete(i),n&&e.Ta.Sa(i,n);e.da.delete(t),e.isPrimaryClient&&e.ma.Ar(t).forEach((t=>{e.ma.containsKey(t)||Fm(e,t)}))}function Fm(e,t){e.Aa.delete(t.path.canonicalString());const n=e.Ra.get(t);null!==n&&(Up(e.remoteStore,n),e.Ra=e.Ra.remove(t),e.Va.delete(n),qm(e))}function Um(e,t,n){for(const i of n)i instanceof Im?(e.ma.addReference(i.key,t),Vm(e,i)):i instanceof Em?(Fl("SyncEngine","Document no longer in limbo: "+i.key),e.ma.removeReference(i.key,t),e.ma.containsKey(i.key)||Fm(e,i.key)):jl()}function Vm(e,t){const n=t.key,i=n.path.canonicalString();e.Ra.get(n)||e.Aa.has(i)||(Fl("SyncEngine","New document in limbo: "+n),e.Aa.add(i),qm(e))}function qm(e){for(;e.Aa.size>0&&e.Ra.size<e.maxConcurrentLimboResolutions;){const t=e.Aa.values().next().value;e.Aa.delete(t);const n=new hu(cu.fromString(t)),i=e.pa.next();e.Va.set(i,new Sm(n)),e.Ra=e.Ra.insert(n,i),Fp(e.remoteStore,new qf(jh(Ph(n.path)),i,"TargetPurposeLimboResolution",bu.ae))}}async function jm(e,t,n){const i=$l(e),s=[],r=[],o=[];i.Ea.isEmpty()||(i.Ea.forEach(((e,a)=>{o.push(i.wa(a,t,n).then((e=>{if((e||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){s.push(e);const t=cp.qi(a.targetId,e);r.push(t)}})))})),await Promise.all(o),i.Ta.r_(s),await async function(e,t){const n=$l(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>vu.forEach(t,(t=>vu.forEach(t.Li,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>vu.forEach(t.ki,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!wu(e))throw e;Fl("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ji.get(t),i=e.snapshotVersion,s=e.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(t,s)}}}(i.localStore,r))}async function Bm(e,t){const n=$l(e);if(!n.currentUser.isEqual(t)){Fl("SyncEngine","User change. New user:",t.toKey());const e=await hp(n.localStore,t);n.currentUser=t,function(e,t){e.ga.forEach((e=>{e.forEach((e=>{e.reject(new Hl(zl.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.ga.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await jm(n,e.ts)}}function $m(e,t){const n=$l(e),i=n.Va.get(t);if(i&&i.Ia)return ad().add(i.key);{let e=ad();const i=n.da.get(t);if(!i)return e;for(const t of i){const i=n.Ea.get(t);e=e.unionWith(i.view.ia)}return e}}function zm(e){const t=$l(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Om.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Lm.bind(null,t),t}class Hm{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=kp(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,i){return new up(e,t,n,i)}(this.persistence,new lp,e.initialUser,this.serializer)}createPersistence(e){return new rp(ap.zr,this.serializer)}createSharedClientState(e){return new yp}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Km{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Nm(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Bm.bind(null,this.syncEngine),await async function(e,t){const n=$l(e);t?(n.y_.delete(2),await Pp(n)):t||(n.y_.add(2),await Mp(n),n.b_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new pm}createDatastore(e){const t=kp(e.databaseInfo.databaseId),n=function(e){return new Sp(e)}(e.databaseInfo);return function(e,t,n,i){return new Op(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,i,s){return new xp(e,t,n,i,s)}(this.localStore,this.datastore,e.asyncQueue,(e=>Nm(this.syncEngine,e,0)),wp.v()?new wp:new vp)}createSyncEngine(e,t){return function(e,t,n,i,s,r,o){const a=new Cm(e,t,n,i,s,r);return o&&(a.ya=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=$l(e);Fl("RemoteStore","RemoteStore shutting down."),t.y_.add(5),await Mp(t),t.S_.shutdown(),t.b_.set("Unknown")}(this.remoteStore)}}class Wm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.va(this.observer.next,e)}error(e){this.observer.error?this.va(this.observer.error,e):Ul("Uncaught Error in snapshot listener:",e.toString())}Ca(){this.muted=!0}va(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Gm{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Ll.UNAUTHENTICATED,this.clientId=nu.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Fl("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Fl("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Hl(zl.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Kl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=lm(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Qm(e,t){e.asyncQueue.verifyOperationInProgress(),Fl("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await hp(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Jm(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Fl("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qm(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===zl.FAILED_PRECONDITION||e.code===zl.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Vl("Error using user provided cache. Falling back to memory cache: "+n),await Qm(e,new Hm)}}else Fl("FirestoreClient","Using default OfflineComponentProvider"),await Qm(e,new Hm);return e._offlineComponents}(e);Fl("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener((e=>rm(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>rm(t.remoteStore,n))),e._onlineComponents=t}async function Xm(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Fl("FirestoreClient","Using user provided OnlineComponentProvider"),await Jm(e,e._uninitializedComponentsProvider._online)):(Fl("FirestoreClient","Using default OnlineComponentProvider"),await Jm(e,new Km))),e._onlineComponents}async function Ym(e){const t=await Xm(e),n=t.eventManager;return n.onListen=km.bind(null,t.syncEngine),n.onUnlisten=Am.bind(null,t.syncEngine),n}function Zm(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const eg=new Map;function tg(e,t,n){if(!n)throw new Hl(zl.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ng(e){if(!hu.isDocumentKey(e))throw new Hl(zl.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ig(e){if(hu.isDocumentKey(e))throw new Hl(zl.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function sg(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":jl()}function rg(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Hl(zl.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=sg(e);throw new Hl(zl.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class og{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Hl(zl.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Hl(zl.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Hl(zl.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Zm(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Hl(zl.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Hl(zl.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Hl(zl.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ag{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new og({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Hl(zl.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Hl(zl.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new og(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Gl;switch(e.type){case"firstParty":return new Yl(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Hl(zl.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=eg.get(e);t&&(Fl("ComponentProvider","Removing Datastore"),eg.delete(e),t.terminate())}(this),Promise.resolve()}}class cg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new cg(this.firestore,e,this._query)}}class lg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ug(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new lg(this.firestore,e,this._key)}}class ug extends cg{constructor(e,t,n){super(e,t,Ph(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new lg(this.firestore,null,new hu(e))}withConverter(e){return new ug(this.firestore,e,this._path)}}function hg(e,t,...n){if(e=N(e),tg("collection","path",t),e instanceof ag){const i=cu.fromString(t,...n);return ig(i),new ug(e,null,i)}{if(!(e instanceof lg||e instanceof ug))throw new Hl(zl.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(cu.fromString(t,...n));return ig(i),new ug(e.firestore,null,i)}}function dg(e,t,...n){if(e=N(e),1===arguments.length&&(t=nu.V()),tg("doc","path",t),e instanceof ag){const i=cu.fromString(t,...n);return ng(i),new lg(e,null,new hu(i))}{if(!(e instanceof lg||e instanceof ug))throw new Hl(zl.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(cu.fromString(t,...n));return ng(i),new lg(e.firestore,e instanceof ug?e.converter:null,new hu(i))}}class fg{constructor(){this.Wa=Promise.resolve(),this.Ga=[],this.za=!1,this.ja=[],this.Ha=null,this.Ja=!1,this.Ya=!1,this.Za=[],this.Ko=new Ap(this,"async_queue_retry"),this.Xa=()=>{const e=Cp();e&&Fl("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Ko.No()};const e=Cp();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xa)}get isShuttingDown(){return this.za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.eu(),this.tu(e)}enterRestrictedMode(e){if(!this.za){this.za=!0,this.Ya=e||!1;const t=Cp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xa)}}enqueue(e){if(this.eu(),this.za)return new Promise((()=>{}));const t=new Kl;return this.tu((()=>this.za&&this.Ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Ga.push(e),this.nu())))}async nu(){if(0!==this.Ga.length){try{await this.Ga[0](),this.Ga.shift(),this.Ko.reset()}catch(e){if(!wu(e))throw e;Fl("AsyncQueue","Operation failed with retryable error: "+e)}this.Ga.length>0&&this.Ko.xo((()=>this.nu()))}}tu(e){const t=this.Wa.then((()=>(this.Ja=!0,e().catch((e=>{this.Ha=e,this.Ja=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ul("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Ja=!1,e))))));return this.Wa=t,t}enqueueAfterDelay(e,t,n){this.eu(),this.Za.indexOf(e)>-1&&(t=0);const i=cm.createAndSchedule(this,e,t,n,(e=>this.ru(e)));return this.ja.push(i),i}eu(){this.Ha&&jl()}verifyOperationInProgress(){}async iu(){let e;do{e=this.Wa,await e}while(e!==this.Wa)}su(e){for(const t of this.ja)if(t.timerId===e)return!0;return!1}ou(e){return this.iu().then((()=>{this.ja.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.ja)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.iu()}))}_u(e){this.Za.push(e)}ru(e){const t=this.ja.indexOf(e);this.ja.splice(t,1)}}function pg(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class mg extends ag{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new fg,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||vg(this),this._firestoreClient.terminate()}}function gg(e,t){const n="string"==typeof e?e:t||"(default)",i=ge("object"==typeof e?e:Ie(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=(e=>{const t=a("firestore");if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})();e&&function(e,t,n,i={}){var r;const o=(e=rg(e,ag))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&Vl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=Ll.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new Hl(zl.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ll(o)}e._authCredentials=new Ql(new Wl(t,n))}}(i,...e)}return i}function yg(e){return e._firestoreClient||vg(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function vg(e){var t,n,i;const s=e._freezeSettings(),r=function(e,t,n,i){return new ju(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Zm(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new Gm(e._authCredentials,e._appCheckCredentials,e._queue,r),(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=s.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}class wg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wg(Lu.fromBase64String(e))}catch(e){throw new Hl(zl.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new wg(Lu.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class bg{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Hl(zl.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new uu(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ig{constructor(e){this._methodName=e}}class Eg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Hl(zl.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Hl(zl.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return iu(this._lat,e._lat)||iu(this._long,e._long)}}const Tg=/^__.*__$/;class _g{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Pd(e,this.data,this.fieldMask,t,this.fieldTransforms):new xd(e,this.data,t,this.fieldTransforms)}}class Sg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Pd(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Cg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jl()}}class kg{constructor(e,t,n,i,s,r){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.au(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get uu(){return this.settings.uu}cu(e){return new kg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}lu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.cu({path:n,hu:!1});return i.Pu(e),i}Iu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.cu({path:n,hu:!1});return i.au(),i}Tu(e){return this.cu({path:void 0,hu:!0})}Eu(e){return qg(e,this.settings.methodName,this.settings.du||!1,this.path,this.settings.Au)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}au(){if(this.path)for(let e=0;e<this.path.length;e++)this.Pu(this.path.get(e))}Pu(e){if(0===e.length)throw this.Eu("Document fields must not be empty");if(Cg(this.uu)&&Tg.test(e))throw this.Eu('Document fields cannot begin and end with "__"')}}class Ag{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||kp(e)}Ru(e,t,n,i=!1){return new kg({uu:e,methodName:t,Au:n,path:uu.emptyPath(),hu:!1,du:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dg(e){const t=e._freezeSettings(),n=kp(e._databaseId);return new Ag(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ng(e,t,n,i,s,r={}){const o=e.Ru(r.merge||r.mergeFields?2:0,t,n,s);Mg("Data must be an object, but it was:",o,i);const a=xg(i,o);let c,l;if(r.merge)c=new Ru(o.fieldMask),l=o.fieldTransforms;else if(r.mergeFields){const e=[];for(const i of r.mergeFields){const s=Fg(t,i,n);if(!o.contains(s))throw new Hl(zl.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);jg(e,s)||e.push(s)}c=new Ru(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new _g(new rh(a),c,l)}class Rg extends Ig{_toFieldTransform(e){if(2!==e.uu)throw 1===e.uu?e.Eu(`${this._methodName}() can only appear at the top level of your update data`):e.Eu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rg}}class Og extends Ig{_toFieldTransform(e){return new _d(e.path,new gd)}isEqual(e){return e instanceof Og}}function Lg(e,t){if(Pg(e=N(e)))return Mg("Unsupported field value:",t,e),xg(e,t);if(e instanceof Ig)return function(e,t){if(!Cg(t.uu))throw t.Eu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Eu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.hu&&4!==t.uu)throw t.Eu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const s of e){let e=Lg(s,t.Tu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=N(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return hd(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ru.fromDate(e);return{timestampValue:gf(t.serializer,n)}}if(e instanceof ru){const n=new ru(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:gf(t.serializer,n)}}if(e instanceof Eg)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof wg)return{bytesValue:yf(t.serializer,e._byteString)};if(e instanceof lg){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.Eu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:bf(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Eu(`Unsupported field value: ${sg(e)}`)}(e,t)}function xg(e,t){const n={};return Su(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):_u(e,((e,i)=>{const s=Lg(i,t.lu(e));null!=s&&(n[e]=s)})),{mapValue:{fields:n}}}function Pg(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ru||e instanceof Eg||e instanceof wg||e instanceof lg||e instanceof Ig)}function Mg(e,t,n){if(!Pg(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=sg(n);throw"an object"===i?t.Eu(e+" a custom object"):t.Eu(e+" "+i)}}function Fg(e,t,n){if((t=N(t))instanceof bg)return t._internalPath;if("string"==typeof t)return Vg(e,t);throw qg("Field path arguments must be of type string or ",e,!1,void 0,n)}const Ug=new RegExp("[~\\*/\\[\\]]");function Vg(e,t,n){if(t.search(Ug)>=0)throw qg(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new bg(...t.split("."))._internalPath}catch(i){throw qg(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function qg(e,t,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new Hl(zl.INVALID_ARGUMENT,a+e+c)}function jg(e,t){return e.some((e=>e.isEqual(t)))}class Bg{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new lg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new $g(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(zg("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class $g extends Bg{data(){return super.data()}}function zg(e,t){return"string"==typeof t?Vg(e,t):t instanceof bg?t._internalPath:t._delegate._internalPath}function Hg(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Hl(zl.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kg{}class Wg extends Kg{}function Gg(e,t,...n){let i=[];t instanceof Kg&&i.push(t),i=i.concat(n),function(e){const t=e.filter((e=>e instanceof Xg)).length,n=e.filter((e=>e instanceof Qg)).length;if(t>1||t>0&&n>0)throw new Hl(zl.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const t of i)e=t._apply(e);return e}class Qg extends Wg{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Qg(e,t,n)}_apply(e){const t=this._parse(e);return ey(e._query,t),new cg(e.firestore,e.converter,Bh(e._query,t))}_parse(e){const t=Dg(e.firestore),n=function(e,t,n,i,s,r,o){let a;if(s.isKeyField()){if("array-contains"===r||"array-contains-any"===r)throw new Hl(zl.INVALID_ARGUMENT,`Invalid Query. You can't perform '${r}' queries on documentId().`);if("in"===r||"not-in"===r){Zg(o,r);const t=[];for(const n of o)t.push(Yg(i,e,n));a={arrayValue:{values:t}}}else a=Yg(i,e,o)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||Zg(o,r),a=function(e,t,n,i=!1){return Lg(n,e.Ru(i?4:3,t))}(n,"where",o,"in"===r||"not-in"===r);return ph.create(s,r,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Jg(e,t,n){const i=t,s=zg("where",e);return Qg._create(s,i,n)}class Xg extends Kg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Xg(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:mh.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const e of i)ey(n,e),n=Bh(n,e)}(e._query,t),new cg(e.firestore,e.converter,Bh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function Yg(e,t,n){if("string"==typeof(n=N(n))){if(""===n)throw new Hl(zl.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vh(t)&&-1!==n.indexOf("/"))throw new Hl(zl.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(cu.fromString(n));if(!hu.isDocumentKey(i))throw new Hl(zl.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Xu(e,new hu(i))}if(n instanceof lg)return Xu(e,n._key);throw new Hl(zl.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sg(n)}.`)}function Zg(e,t){if(!Array.isArray(e)||0===e.length)throw new Hl(zl.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function ey(e,t){if(t.isInequality()){const n=Uh(e),i=t.field;if(null!==n&&!n.isEqual(i))throw new Hl(zl.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const s=Fh(e);null!==s&&function(e,t,n){if(!n.isEqual(t))throw new Hl(zl.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}(0,i,s)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Hl(zl.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Hl(zl.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class ty{convertValue(e,t="none"){switch(zu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mu(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw jl()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return _u(e,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertGeoPoint(e){return new Eg(Mu(e.latitude),Mu(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Vu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(qu(e));default:return null}}convertTimestamp(e){const t=Pu(e);return new ru(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=cu.fromString(e);Bl(Vf(n));const i=new Bu(n.get(1),n.get(3)),s=new hu(n.popFirst(5));return i.isEqual(t)||Ul(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}class ny{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class iy extends Bg{constructor(e,t,n,i,s,r){super(e,t,n,i,r),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(zg("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class sy extends iy{data(e={}){return super.data(e)}}class ry{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ny(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new sy(this._firestore,this._userDataWriter,n.key,n,new ny(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Hl(zl.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const i=new sy(e._firestore,e._userDataWriter,n.doc.key,n.doc,new ny(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new sy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new ny(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,r=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),r=n.indexOf(t.doc.key)),{type:oy(t.type),doc:i,oldIndex:s,newIndex:r}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function oy(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jl()}}function ay(e){e=rg(e,lg);const t=rg(e.firestore,mg);return function(e,t,n={}){const i=new Kl;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,s){const r=new Wm({next:r=>{t.enqueueAndForget((()=>gm(e,o)));const a=r.docs.has(n);!a&&r.fromCache?s.reject(new Hl(zl.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&r.fromCache&&i&&"server"===i.source?s.reject(new Hl(zl.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(r)},error:e=>s.reject(e)}),o=new bm(Ph(n.path),r,{includeMetadataChanges:!0,W_:!0});return mm(e,o)}(await Ym(e),e.asyncQueue,t,n,i))),i.promise}(yg(t),e._key).then((n=>dy(t,e,n)))}class cy extends ty{constructor(e){super(),this.firestore=e}convertBytes(e){return new wg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new lg(this.firestore,null,t)}}function ly(e,t,n){e=rg(e,lg);const i=rg(e.firestore,mg),s=function(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}(e.converter,t,n);return hy(i,[Ng(Dg(i),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,Cd.none())])}function uy(e,t,n,...i){e=rg(e,lg);const s=rg(e.firestore,mg),r=Dg(s);let o;return o="string"==typeof(t=N(t))||t instanceof bg?function(e,t,n,i,s,r){const o=e.Ru(1,t,n),a=[Fg(t,i,n)],c=[s];if(r.length%2!=0)throw new Hl(zl.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<r.length;e+=2)a.push(Fg(t,r[e])),c.push(r[e+1]);const l=[],u=rh.empty();for(let e=a.length-1;e>=0;--e)if(!jg(l,a[e])){const t=a[e];let n=c[e];n=N(n);const i=o.Iu(t);if(n instanceof Rg)l.push(t);else{const e=Lg(n,i);null!=e&&(l.push(t),u.set(t,e))}}const h=new Ru(l);return new Sg(u,h,o.fieldTransforms)}(r,"updateDoc",e._key,t,n,i):function(e,t,n,i){const s=e.Ru(1,t,n);Mg("Data must be an object, but it was:",s,i);const r=[],o=rh.empty();_u(i,((e,i)=>{const a=Vg(t,e,n);i=N(i);const c=s.Iu(a);if(i instanceof Rg)r.push(a);else{const e=Lg(i,c);null!=e&&(r.push(a),o.set(a,e))}}));const a=new Ru(r);return new Sg(o,a,s.fieldTransforms)}(r,"updateDoc",e._key,t),hy(s,[o.toMutation(e._key,Cd.exists(!0))])}function hy(e,t){return function(e,t){const n=new Kl;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=zm(e);try{const e=await function(e,t){const n=$l(e),i=ru.now(),s=t.reduce(((e,t)=>e.add(t.key)),ad());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Yh(),c=ad();return n.Xi.getEntries(e,s).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((s=>{r=s;const o=[];for(const e of t){const t=Od(e,r.get(e.key).overlayedDocument);null!=t&&o.push(new Pd(e.key,t,oh(t.value.mapValue),Cd.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)})).next((t=>{o=t;const i=t.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:td(r)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.fa[e.currentUser.toKey()];i||(i=new Cu(iu)),i=i.insert(t,n),e.fa[e.currentUser.toKey()]=i}(i,e.batchId,n),await jm(i,e.changes),await Jp(i.remoteStore)}catch(e){const t=lm(e,"Failed to persist write");n.reject(t)}}(await function(e){return Xm(e).then((e=>e.syncEngine))}(e),t,n))),n.promise}(yg(e),t)}function dy(e,t,n){const i=n.docs.get(t._key),s=new cy(e);return new iy(e,s,t._key,i,new ny(n.hasPendingWrites,n.fromCache),t.converter)}function fy(){return new Og("serverTimestamp")}!function(e,t=!0){!function(e){xl=e}(we),me(new R("firestore",((e,{instanceIdentifier:n,options:i})=>{const s=e.getProvider("app").getImmediate(),r=new mg(new Jl(e.getProvider("auth-internal")),new eu(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Hl(zl.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bu(e.options.projectId,t)}(s,n),s);return i=Object.assign({useFetchStreams:t},i),r._setSettings(i),r}),"PUBLIC").setMultipleInstances(!0)),Ee(Ol,"4.1.0",e),Ee(Ol,"4.1.0","esm2017")}();const py=gg(mn);class my{constructor(e){this.id=e,this.isLoaded=!1,this.timeline=[]}async load(){const e=await ay(dg(py,"ACT-Assignment-Timelines",this.id));e.exists()?this.timeline=e.data().timeline:await ly(dg(py,"ACT-Assignment-Timelines",this.id),{timeline:[]}),this.isLoaded=!0}async update(){await uy(dg(py,"ACT-Assignment-Timelines",this.id),{timeline:this.timeline})}add(e,t,n){this.timeline.push({question:e,type:t,data:n,time:new Date})}getAnswer(e){for(let t=this.timeline.length-1;t>-1;t--)if(this.timeline[t].question===e&&"answer"===this.timeline[t].type)return this.timeline[t].data;return null}getFlag(e){for(let t=this.timeline.length-1;t>-1;t--)if(this.timeline[t].question===e&&"flag"===this.timeline[t].type)return this.timeline[t].data;return!1}getTotalTime(e){let t=0,n=null;for(let i=0;i<this.timeline.length;i++)this.timeline[i].question===e&&null===n&&(n=this.timeline[i].time.toDate().getTime()),this.timeline[i].question!==e&&null!==n&&(t+=this.timeline[i].time.toDate().getTime()-n,n=null);return t}getAnswerList(e){return this.timeline.filter((t=>t.question===e&&"answer"===t.type)).map((e=>e.data))}getWasFlagged(e){return this.timeline.some((t=>t.question===e&&"flag"===t.type))}}const gy=gg(mn);class yy{constructor(e){this.id=e,this.isLoaded=!1,this.content=null,this.code=null,this.section=null,this.test=null}async load(){const e=await ay(dg(gy,"ACT-Passage-Data",this.id));for(const t in e.data())this[t]=e.data()[t];this.isLoaded=!0}unload(){this.content=null,this.code=null,this.section=null,this.test=null,this.isLoaded=!1}show(e=null){const t=document.getElementById("passageContent");vy(t),t.innerHTML=this.content,t.querySelectorAll("span[data-question]").forEach((e=>{e.classList.remove("highlighted")})),e&&t.querySelectorAll(`span[data-question="${e}"]`).forEach((e=>{e.classList.add("highlighted")})),document.querySelector(".main .panels .passage").classList.remove("hide")}hide(){vy(document.getElementById("passageContent")),document.querySelector(".main .panels .passage").classList.add("hide")}}function vy(e){for(;e.firstChild;)e.removeChild(e.firstChild)}const wy=er(mn),by=gg(mn);class Iy{constructor(e,t,n,i){this.id=e,this.pos=t,this.student=n,this.assignmentTimeline=i,this.isLoaded=!1,this.answer=null,this.choices=null,this.content=null,this.explanation=null,this.isGroupedByPassage=null,this.isQuestionBank=null,this.passage=null,this.section=null,this.test=null,this.topic=null,this.selectorInput=document.createElement("input"),this.selectorLabel=document.createElement("label")}async load(){const e=await ay(dg(by,"ACT-Question-Data",this.id));for(const t in e.data())this[t]=e.data()[t];this.topic||(this.topic=-1),this.passage&&(this.passage=new yy(this.passage),await this.passage.load()),this.isLoaded=!0}unload(){this.answer=null,this.choices=null,this.content=null,this.explanation=null,this.isGroupedByPassage=null,this.isQuestionBank=null,this.passage=null,this.section=null,this.test=null,this.topic=null,this.isLoaded=!1}show(){const e=this.assignmentTimeline.getAnswer(this.id),t=this.assignmentTimeline.getFlag(this.id);document.getElementById("questionNumber").textContent=(this.pos+1).toString(),document.getElementById("questionContent").innerHTML=this.content,document.getElementById("questionFlag").checked=t,document.getElementById("questionFlag").disabled=!1;const n=document.getElementById("questionChoices");Ey(n);const i=["A","B","C","D","E"],s=["F","G","H","J","K"];this.choices.forEach(((t,r)=>{const o=document.createElement("div");o.classList.add("choice");const a=document.createElement("input");a.setAttribute("type","radio"),a.setAttribute("name","choice"),a.id=`choice_${r}`,a.checked=e===r,a.addEventListener("change",(()=>{this.answerSelected(r)}));const c=document.createElement("label");c.setAttribute("for",`choice_${r}`),c.classList.add("flex-row");const l=((this.pos+1)%2==0?s[r]:i[r])??"X";c.innerHTML=`<p class="choice-letter"><b>${l}.</b></p>${t}`,o.appendChild(a),o.appendChild(c),n.appendChild(o)})),this.selectorInput.checked=!0,document.querySelector(".main .panels .question").classList.remove("hide")}hide(){document.getElementById("questionNumber").textContent="",Ey(document.getElementById("questionContent")),document.getElementById("questionFlag").checked=!1,document.getElementById("questionFlag").disabled=!0,Ey(document.getElementById("questionChoices")),Ey(document.getElementById("answerToggle")),document.getElementById("answerToggleInput").checked=!1,Ey(document.getElementById("questionExplanation")),document.querySelector(".main .panels .question").classList.add("hide")}review(e=!1,t=!1){const n=["A","B","C","D","E"],i=["F","G","H","J","K"],s=this.assignmentTimeline.getAnswer(this.id),r=this.assignmentTimeline.getFlag(this.id);document.getElementById("questionNumber").textContent=(this.pos+1).toString(),document.getElementById("questionContent").innerHTML=this.content??"";const o=`\n    <input type="checkbox" id="questionExplanationInput">\n    <label for="questionExplanationInput" class="color-accent">Explanation</label>\n    <div id="explanationWrapper">\n      <div>\n        ${this.explanation}\n        <a href="/pricing?program=one-on-one" target="_blank">Need more help?</a>\n      </div>\n    </div>\n    `;document.getElementById("questionExplanation").innerHTML=this.explanation?o:"";const a=this.assignmentTimeline.getTotalTime(this.id),c=Math.floor(a/6e4%60),l=Math.floor(a/1e3%60),u=this.assignmentTimeline.getAnswerList(this.id).map((e=>(this.pos+1)%2==0?i[e]:n[e])).join(", "),h=this.assignmentTimeline.getWasFlagged(this.id)?"Yes":"No",d=`\n    <p>Total time: ${c}:${l.toString().padStart(2,"0")}</p>\n    <p>Answer history: ${u}</p>\n    <p>Was Flagged: ${h}</p>\n    `;document.getElementById("questionDetails").innerHTML=t?d:"",document.getElementById("questionFlag").checked=r,document.getElementById("questionFlag").disabled=!0,document.getElementById("answerToggle").innerHTML='\n    <label for="answerToggleInput" class="show-answer">Show answer</label>\n    <label for="answerToggleInput" class="hide-answer">Hide answer</label>\n    ';const f=document.getElementById("questionChoices");Ey(f),this.choices.forEach(((t,r)=>{const o=document.createElement("div");o.classList.add("choice"),e&&r===this.answer&&o.classList.add("correct");const a=document.createElement("input");a.setAttribute("type","radio"),a.setAttribute("name","choice"),a.id=`choice_${r}`,a.checked=s===r,a.disabled=!0;const c=document.createElement("label");c.setAttribute("for",`choice_${r}`),c.classList.add("flex-row");const l=((this.pos+1)%2==0?i[r]:n[r])??"X";c.innerHTML=`<p class="choice-letter"><b>${l}.</b></p>${t}`,o.appendChild(a),o.appendChild(c),f.appendChild(o)})),this.selectorInput.checked=!0,document.querySelector(".main .panels .question").classList.remove("hide")}renderSelector(e=!1){Ey(this.selectorLabel);const t=this.assignmentTimeline.getAnswer(this.id),n=null!=t,i=this.assignmentTimeline.getFlag(this.id);this.selectorLabel.innerHTML=`\n      <span class="${n?"answered":""} ${i?"flagged":""}"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\nviewBox="0 0 512 512" xml:space="preserve">\n<g id="XMLID_1_">\n<path id="XMLID_4_" class="flag" d="M378.3,35.7c0,0-84.9,40.9-170.6,11C114.9,14.5,73.2,27,33.1,75.8c-7.1-3.9-15.7-3.9-22.8,0\n C0.1,82.1-3.1,96.2,3.2,106.5l225.7,366.4c3.9,7.1,11.8,10.2,18.9,10.2c3.9,0,7.9-0.8,11.8-3.1c10.2-6.3,13.4-20.4,7.1-30.7\n l-99.1-162c39.3-48,81.8-61.3,173.8-29.1c84.9,29.9,170.6-11,170.6-11L378.3,35.7z"/>\n</g>\n</svg></span>\n      Question ${this.pos+1}\n      <span>${e&&t!=this.answer?'<svg viewBox="0 0 12 12" width="10px" height="10px" xmlns="http://www.w3.org/2000/svg">\n<g transform="matrix(0.005703, 0, 0, 0.005876, -0.000137, 9.355989)" style="">\n  <polygon points="2104.135 -1434.151 1941.478 -1592.342 1052.117 -729.182 162.83 -1592.342 0.024 -1434.223 889.311 -571.172 0.024 291.879 162.83 449.998 1052.117 -413.239 1941.478 449.998 2104.135 291.807 1214.96 -571.172"/>\n</g>\n</svg>':""}</span>\n    `}setupSelector(e,...t){this.selectorInput.setAttribute("id","selectorRadio-"+this.id),this.selectorInput.setAttribute("type","radio"),this.selectorInput.setAttribute("name","questionSelector"),this.selectorLabel.setAttribute("for","selectorRadio-"+this.id),this.selectorLabel.classList.add("selector-wrapper"),this.selectorLabel.addEventListener("click",(()=>e(...t))),document.getElementById("selectorContainer").appendChild(this.selectorInput),document.getElementById("selectorContainer").appendChild(this.selectorLabel)}async answerSelected(e){this.student==wy.currentUser.uid&&(this.assignmentTimeline.add(this.id,"answer",e),this.renderSelector(),await this.assignmentTimeline.update())}async flagToggled(e){this.student==wy.currentUser.uid&&(this.assignmentTimeline.add(this.id,"flag",e),this.renderSelector(),await this.assignmentTimeline.update())}}function Ey(e){for(;e.firstChild;)e.removeChild(e.firstChild)}class Ty extends Date{constructor(...e){super(...e)}toFormat(e){const t={S:this.getMilliseconds().toString(),SSS:this.getMilliseconds().toString().padStart(3,"0"),s:this.getSeconds().toString(),ss:this.getSeconds().toString().padStart(2,"0"),m:this.getMinutes().toString(),mm:this.getMinutes().toString().padStart(2,"0"),h:(this.getHours()%12||12).toString(),hh:(this.getHours()%12||12).toString().padStart(2,"0"),H:this.getHours().toString(),HH:this.getHours().toString().padStart(2,"0"),a:this.getHours()<12?"am":"pm",A:this.getHours()<12?"AM":"PM",d:this.getDate().toString(),dd:this.getDate().toString().padStart(2,"0"),ddd:1===this.getDate()?this.getDate().toString()+"st":2===this.getDate()?this.getDate().toString()+"nd":3===this.getDate()?this.getDate().toString()+"rd":21===this.getDate()?this.getDate().toString()+"st":22===this.getDate()?this.getDate().toString()+"nd":23===this.getDate()?this.getDate().toString()+"rd":31===this.getDate()?this.getDate().toString()+"st":this.getDate().toString()+"th",o:this.getDayOfYear().toString(),ooo:this.getDayOfYear().toString().padStart(3,"0"),E:(this.getDay()%7||7).toString(),EEE:this.toLocaleString("default",{weekday:"short"}),EEEE:this.toLocaleString("default",{weekday:"long"}),EEEEE:this.toLocaleString("default",{weekday:"narrow"}),W:this.getWeek().toString(),WW:this.getWeek().toString().padStart(2,"0"),M:(this.getMonth()+1).toString(),MM:(this.getMonth()+1).toString().padStart(2,"0"),MMM:this.toLocaleString("default",{month:"short"}),MMMM:this.toLocaleString("default",{month:"long"}),MMMMM:this.toLocaleString("default",{month:"narrow"}),y:this.getFullYear().toString(),yy:this.getFullYear().toString().slice(-2),yyyy:this.getFullYear().toString().padStart(4,"0")},n=e.split("{").flatMap((e=>e.split("}")));for(let e=1;e<n.length;e+=2)n[e]=t[n[e]];return n.join("")}getWeek(){var e=new Date(this.valueOf()),t=(this.getDay()+6)%7;e.setDate(e.getDate()-t+3);var n=e.valueOf();return e.setMonth(0,1),4!=e.getDay()&&e.setMonth(0,1+(4-e.getDay()+7)%7),1+Math.ceil((n-e)/6048e5)}getDayOfYear(){var e=new Date(this.getFullYear(),0,1);return Math.ceil((this-e)/864e5)}}const _y=er(mn),Sy=gg(mn);class Cy{constructor(e,t){const n=e.data();this.isStaff=t,this.id=e.id,this.ref=e.ref,this.data=n,this.open=n.open,this.close=n.close,this.status=n.status,this.student=n.student,this.questions=n.questions??[],this.time=n.time,this.sectionCode=n.sectionCode,this.type=n.type,this.topicProportions=n.topicProportions,this.startedAt=n.startedAt,this.submittedAt=n.submittedAt,this.score=n.score,this.scaledScore=n.scaledScore,this.scaledScoreSection=n.scaledScoreSection,this.questionObjects=null,this.sortedQuestionsByTopic=null,this.timeline=null,this.wrapper=document.createElement("div"),this.statusIndicator=document.createElement("p"),this.wrapper.addEventListener("click",(()=>{this.assignmentClicked()})),this.openTimeout=null,this.closeTimeout=null,this.submitTimeout=null,this.resetTimers(),this.isStarted=!1,this.isInReview=!1,this.currentQuestion=null}update(e){for(let t in e)this[t]=e[t];this.resetTimers()}resetTimers(){this.openTimeout&&(this.openTimeout.cleanUp(),this.openTimeout=null),this.closeTimeout&&(this.closeTimeout.cleanUp(),this.closeTimeout=null),this.submitTimeout&&(this.submitTimeout.cleanUp(),this.submitTimeout=null),"new"===this.status&&(this.openTimeout=this.open?new ir(this.open.toDate(),(()=>{this.openTimeout.cleanUp(),this.openTimeout=null,Xy()})):null,this.closeTimeout=this.close?new ir(this.close.toDate(),(async()=>{this.closeTimeout.cleanUp(),this.closeTimeout=null,await this.omit()})):null),"started"===this.status&&this.startedAt&&this.time&&(this.submitTimeout=new ir(new Date(this.startedAt.toDate().getTime()+this.time),(async()=>{this.submitTimeout.cleanUp(),this.submitTimeout=null,await this.submit()})),this.submitTimeout.attach(this.statusIndicator),this.isStarted&&(document.getElementById("assignmentTime").classList.remove("hide"),this.submitTimeout.attach(document.getElementById("assignmentTime")),document.getElementById("assignmentSubmit").classList.add("hide")))}show(e){switch(Ry(this.wrapper),this.wrapper.classList.add("assignment","box",`${this.sectionCode}-background`),this.isStaff?this.open&&this.open.toDate().getTime()>(new Date).getTime()?this.wrapper.classList.add("not-open"):this.wrapper.classList.remove("not-open"):this.open&&this.open.toDate().getTime()>(new Date).getTime()?this.wrapper.classList.add("hide"):this.wrapper.classList.remove("hide"),this.status){case"new":this.statusIndicator.classList.remove("spinner"),this.isStaff?this.statusIndicator.textContent=(this.open?new Ty(this.open.toDate().getTime()).toFormat("{EEE} {M}/{d}/{yy}, {hh}:{mm} {a}"):"")+" — "+(this.close?new Ty(this.close.toDate().getTime()).toFormat("{EEE} {M}/{d}/{yy}, {hh}:{mm} {a}"):""):this.statusIndicator.textContent=this.close?new Ty(this.close.toDate().getTime()).toFormat("{EEE} {M}/{d}/{yy}, {hh}:{mm} {a}"):"",e.appendChild(this.wrapper);break;case"started":this.statusIndicator.classList.remove("spinner"),this.time&&this.submitTimeout?this.submitTimeout.show():this.statusIndicator.textContent="--:--",e.appendChild(this.wrapper);break;case"submitted":this.statusIndicator.textContent="",this.statusIndicator.classList.add("spinner"),e.appendChild(this.wrapper);break;case"graded":this.statusIndicator.classList.remove("spinner"),this.statusIndicator.textContent=`${this.scaledScore??""} (${this.score} out of ${this.questions.length})`,e.appendChild(this.wrapper);break;case"omitted":this.statusIndicator.classList.remove("spinner"),this.statusIndicator.textContent="omitted",e.appendChild(this.wrapper);break;default:throw"invalid status"}!function(e,t,n,i,s=null,r=null){const o=document.createElement("div"),a=document.createElement("div");o.innerHTML=`\n  ${r?`<p>${r}</p>`:""}\n  <div class="flex-row align-center">\n    ${s?`<p style="margin-right: 0.5em;">\n        ${s.charAt(0).toUpperCase()}\n      </p>`:""}\n\n    \n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">\n\t<g>\n\t\t<g>\n\t\t\t<path d="M392.09,122.767l15.446-24.272c6.858-10.778,3.681-25.076-7.097-31.935c-10.777-6.86-25.076-3.681-31.935,7.099\n\t\t\t\tl-15.409,24.215c-22.708-11.316-47.642-18.798-73.962-21.58V46.265h1.448c12.775,0,23.133-10.357,23.133-23.133\n\t\t\t\tS293.356,0,280.581,0h-49.163c-12.775,0-23.133,10.357-23.133,23.133s10.357,23.133,23.133,23.133h1.45v30.029\n\t\t\t\tC123.239,87.885,37.535,180.886,37.535,293.535C37.535,413.997,135.538,512,256,512s218.465-98.003,218.465-218.465\n\t\t\t\tC474.465,224.487,442.259,162.83,392.09,122.767z M256,465.735c-94.951,0-172.2-77.249-172.2-172.2s77.249-172.2,172.2-172.2\n\t\t\t\ts172.2,77.249,172.2,172.2S350.951,465.735,256,465.735z"/>\n\t\t</g>\n\t</g>\n\t<g>\n\t\t<g>\n\t\t\t<path d="M333.172,205.084c-9.623-8.397-24.238-7.407-32.638,2.222l-61.964,71.02c-8.399,9.626-7.404,24.24,2.222,32.638\n\t\t\t\tc9.626,8.399,24.24,7.404,32.638-2.222l61.964-71.02C343.794,228.096,342.798,213.484,333.172,205.084z"/>\n\t\t</g>\n\t</g>\n</svg>\n\n    <p>${t||"--:--"}</p>\n\n    \n<svg viewBox="4 4 16 16" xmlns="http://www.w3.org/2000/svg" xml:space="preserve">\n  <path d="M9 11h6v2H9z"/>\n  <path d="M17 5H7c-1.103 0-2 .897-2 2v10c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2zM7 17V7h10l.002 10H7z"/>\n</svg>\n\n    <p>${n||"auto"}</p>\n  </div>\n  `,a.classList.add("flex-row","align-center"),a.appendChild(i),e.appendChild(o),e.appendChild(a)}(this.wrapper,this.time?Math.ceil(this.time/6e4):null,this.topicProportions?null:this.questions.length,this.statusIndicator,this.isStaff&&this.type,this.sectionCode)}omit(){return uy(this.ref,{status:"omitted"})}submit(){return this.isStarted&&this.end(),uy(this.ref,{status:"submitted",submittedAt:fy()})}async assignmentClicked(){switch(this.status){case"new":this.student!=_y.currentUser.uid?nr.alert("You may not start this assignment as a tutor."):await nr.confirm(`Are you sure you are ready to start this ${this.sectionCode} assignment?`)&&this.start();break;case"started":this.start();break;case"submitted":nr.alert("This assignment is still being graded. Try again later.");break;case"graded":this.review();break;case"omitted":console.log("implement omitted");break;default:throw"invalid status"}}async start(e=!1){document.querySelector(".landing .loading").classList.add("active"),this.isStarted=!0,this.timeline=new my(this.id),await this.timeline.load(),this.questionObjects=this.questions.map(((e,t)=>new Iy(e,t,this.student,this.timeline))),await Promise.all(this.questionObjects.map((async e=>{await e.load()}))),this.questionObjects.forEach((e=>{e.setupSelector((()=>this.startQuestion(e.pos))),e.renderSelector()})),this.submitTimeout?(document.getElementById("assignmentTime").classList.remove("hide"),this.submitTimeout.attach(document.getElementById("assignmentTime")),document.getElementById("assignmentSubmit").classList.add("hide")):(document.getElementById("assignmentTime").classList.add("hide"),document.getElementById("assignmentSubmit").classList.remove("hide")),document.querySelector(".main .panels .selector").classList.remove("open"),Ay("main"),Dy(this.sectionCode),Ny(this.sectionCode),document.getElementById("previousBtn").classList.add("hide"),await this.startQuestion(0),document.querySelector(".main .panels .selector-scroll").scrollTo(0,0),"new"!==this.status||e||await uy(this.ref,{status:"started",startedAt:fy()}),document.querySelector(".landing .loading").classList.remove("active")}end(){this.isStarted=!1,this.isInReview=!1,Ay("landing"),Dy("default"),Ny("default"),this.currentQuestion.hide(),this.currentQuestion.passage&&this.currentQuestion.passage.hide(),this.currentQuestion=null,this.questionObjects=null,this.sortedQuestionsByTopic=null,this.timeline=null,Ry(document.getElementById("selectorContainer")),this.submitTimeout&&this.submitTimeout.detach(document.getElementById("assignmentTime")),document.getElementById("assignmentSubmit").classList.add("hide"),document.getElementById("assignmentTime").classList.add("hide"),document.querySelector(".main .panels .selector .top-container").classList.remove("hide"),document.querySelector(".main .panels .selector").classList.remove("open")}async startQuestion(e,t=!1){e>this.questionObjects.length-1&&(e=this.questionObjects.length-1),e<0&&(e=0);const n=document.getElementById("nextBtn"),i=document.getElementById("previousBtn");if(e===this.questionObjects.length-1?n.classList.add("hide"):n.classList.remove("hide"),0===e?i.classList.add("hide"):i.classList.remove("hide"),this.currentQuestion?.id!==this.questionObjects[e].id){if(this.currentQuestion&&(this.currentQuestion.hide(),this.currentQuestion.passage&&this.currentQuestion.passage.hide()),this.currentQuestion=this.questionObjects[e],this.currentQuestion.show(),this.currentQuestion.passage&&this.currentQuestion.passage.show(this.currentQuestion.code),t){const e=document.getElementById("selectorScrollContainer"),t=e.clientHeight,n=this.currentQuestion.selectorLabel.offsetTop;e.scrollTop=n-t/4}if(ky(),this.student==_y.currentUser.uid&&(this.timeline.add(this.currentQuestion.id,"start",!0),await this.timeline.update()),e==this.questionObjects.length-1&&this.topicProportions&&this.student==_y.currentUser.uid){const t=await async function(e,t){let n=await async function(e){const t=await Promise.all(e.map((async e=>{const t=await function(e){e=rg(e,cg);const t=rg(e.firestore,mg),n=yg(t),i=new cy(t);return Hg(e._query),function(e,t,n={}){const i=new Kl;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,s){const r=new Wm({next:n=>{t.enqueueAndForget((()=>gm(e,o))),n.fromCache&&"server"===i.source?s.reject(new Hl(zl.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),o=new bm(n,r,{includeMetadataChanges:!0,W_:!0});return mm(e,o)}(await Ym(e),e.asyncQueue,t,n,i))),i.promise}(n,e._query).then((n=>new ry(t,i,e,n)))}(Gg(hg(Sy,"ACT-Question-Data"),Jg("topic","==",e),Jg("isQuestionBank","==",!0)));let n=t.docs,i=[];for(;n.length>0;){const e=n[0];let t;if(e.data().isGroupedByPassage){const i=e.data().passage,s=n.filter((e=>e.data().passage==i));t=s.map((e=>e.id))}else t=[e.id];i.push(t),t.forEach((e=>{n.splice(n.findIndex((t=>e==t.id)),1)}))}return i})));return e.reduce(((e,n,i)=>(e[n]=t[i],e)),{})}(Object.keys(e));for(let e in n)n[e]=n[e].map((e=>e.filter((e=>!assigned_questions.includes(e))))).filter((e=>e.length>0));if(Object.keys(n).reduce(((e,t)=>e+n[t].flat().length),0)>0){const i=function(e,t){let n={};for(const e of t)n[e]=0;let i=e.reduce(((e,t)=>(e[t.topic]++,e)),n);for(const t in i)i[t]=i[t]/e.length;return i}(t,Object.keys(e));let s=e,r=Object.values(e).reduce(((e,t)=>e+t));for(const e in s)s[e]=s[e]/r;let o=[];for(let e in i)o.push({topic:e,diff:i[e]-s[e]});o.sort(((e,t)=>e.diff-t.diff));let a=[];for(const{topic:e}of o)if(n[e].length>0){const t=Oy(0,n[e].length);a=n[e][t]??[];break}return a}}(this.topicProportions,this.questionObjects);t&&0!=t.length&&(await Promise.all(t.map((async(t,n)=>{const i=new Iy(t,e+n+1,this.student,this.timeline);i.setupSelector((()=>this.startQuestion(i.pos))),i.renderSelector(),this.questionObjects.push(i),await i.load()}))),this.startQuestion(e),uy(this.ref,{questions:this.questions.concat(t)}))}}}async review(){document.querySelector(".landing .loading").classList.add("active"),this.isInReview=!0,this.timeline=new my(this.id),await this.timeline.load(),this.questionObjects=this.questions.map(((e,t)=>new Iy(e,t,this.student,this.timeline))),await Promise.all(this.questionObjects.map((async e=>{await e.load()})));const e=this.questionObjects.reduce(((e,t)=>(e.includes(t.topic)||e.push(t.topic),e)),[]),t=await Promise.all(e.map((e=>-1!==e?ay(dg(Sy,"ACT-Curriculum-Data",e)):{id:-1,data:()=>({code:"No Topic",numQuestions:-1})})));t.sort(((e,t)=>t.data().numQuestions-e.data().numQuestions)),this.sortedQuestionsByTopic=t.map((e=>({topic:e.data().code,questions:this.questionObjects.filter((t=>t.topic===e.id))})));let n=0;this.sortedQuestionsByTopic.forEach((e=>{const t=document.createElement("p");t.classList.add("topic"),t.textContent=e.topic,document.getElementById("selectorContainer").appendChild(t),e.questions.forEach((e=>{e.setupSelector((e=>this.reviewQuestion(e)),n),e.renderSelector(!0),n++}))})),document.getElementById("assignmentSubmit").classList.add("hide"),document.getElementById("assignmentTime").classList.add("hide"),document.querySelector(".main .panels .selector .top-container").classList.add("hide"),document.querySelector(".main .panels .selector").classList.remove("open"),Ay("main"),Dy(this.sectionCode),Ny(this.sectionCode),document.getElementById("previousBtn").classList.add("hide"),await this.reviewQuestion(0),document.querySelector(".landing .loading").classList.remove("active")}async reviewQuestion(e,t=!1){const n=this.sortedQuestionsByTopic.reduce(((e,t)=>e.concat(t.questions)),[]);e>n.length-1&&(e=n.length-1),e<0&&(e=0);const i=document.getElementById("nextBtn"),s=document.getElementById("previousBtn");if(e===n.length-1?i.classList.add("hide"):i.classList.remove("hide"),0===e?s.classList.add("hide"):s.classList.remove("hide"),this.currentQuestion&&(this.currentQuestion.hide(),this.currentQuestion.passage&&this.currentQuestion.passage.hide()),this.currentQuestion=n[e],this.currentQuestion.review(!0,this.isStaff),this.currentQuestion.passage&&this.currentQuestion.passage.show(this.currentQuestion.code),t){const e=document.getElementById("selectorScrollContainer"),t=e.clientHeight,n=this.currentQuestion.selectorLabel.offsetTop;e.scrollTop=n-t/4}ky()}}async function ky(){try{await MathJax.typesetPromise(),document.querySelectorAll(".MathJax").forEach((e=>{if(e.removeAttribute("tabindex"),e.parentElement&&0===e.parentElement.textNodes().length){const t=document.createTextNode(" ");e.parentElement.appendChild(t)}}))}catch(e){console.log(e)}}function Ay(e){document.querySelectorAll("section").forEach((e=>e.classList.add("hide"))),document.getElementById(e).classList.remove("hide")}function Dy(e){document.querySelector(":root").style.setProperty("--accent-color",`var(--${e}-color)`),document.querySelector(":root").style.setProperty("--accent-color-light",`var(--${e}-color-light)`)}function Ny(e){document.querySelector(":root").style.setProperty("--passage-columns",`var(--${e}-passage-columns)`)}function Ry(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Oy(e,t){if("number"!=typeof e||"number"!=typeof t)throw"min and max must be numbers";if(e>t)throw"min must be less than the max";return Math.floor(Math.random()*(t-e)+e)}const Ly=[{id:"tutorial_english",data:()=>({scaledScoreSection:"akwyZ0u2XHo88dxBxD6G",questions:["UrAURKjzBRTEDMHCZunX","Ar4bI2nE6bYQQaf2YgxE","XoU8u5SVw0kQ8C83kKfv","C3u9bGMepLtZwTZn3KrN","sRz4RkScSobZg1pPBLA6","X1FwdP0b6lW8CF9N2MeL","2MWnFr2vts4BPeKikxSD","JdimmyjLsrQzATIzy6n3","wM7sscTqbI1Kvk8BdaXT","4Zrj5ytXU6Hn7L0sXQWl","hPxFF8sDOtcu5Mbdjres","GslQJ46OMxrPjtUIAIfj","u7rsvR5AUuIhJQ2PcicW","nHPBzifNezipPqJDGL3d","LjTCfXpKcng1bG7RHi7r","idtwAmrfWA51Lfhe1KNb","zNFqEYWdLA9dTtIXs9sS","FV5rAEKWQZ75owqvL0It","hnKYvfU3Be9uNJfUc58R","aTuU6VmsFnfy9Pm3lAAr","Rvvm08dlXiNfs5utSD8M","XFtJsixumZqZnpHIVulE","m8LtLJCYlDXiMa8uCUXL","oVmPaD5smBL0UlJcHENK","8MSJB21ZFaFCHwTFGbJ1","ypSpMocOmuTT3KdlDtS3","dcJPatLbpn66bygJK2qW","2pEPPVX6FlFrQ1DDpD2u","lx1miPUWedV9hURGCyOG","gEISnqQmp0TF755B7VUc","41O0MhRsC3RDen3OxIN1","dkXGeGKJAIuQy8ZLvJgt","CFfEXLR5do2AArlTWjG9","SIYIdyA897WhakNgvSqk","5cAw2agO7fLetVQFCZdE","GWPrNKYU7W6wzZjABvty","HrvK8e9hWn7Qm2Fooqe9","ztsfeOvaVzLsfqnyPBT0","CKVjuqneTGf1j9d50gT3","rHdOahueGxdXMPGDeL4S","ZbXGvbuTB8e4V3a2p4M1","lPSBVGNKfBQT2KPlf2dR","OaZOl3CDXaOfwCpss7nK","7reeKl7kUbjRh6Voggx1","T6r21DwWMPN9IlGLNnhQ","hTZ6mccMWGeJEl2u3NvV","19N4YYXCn9yRUrCnEjaO","sBoLqFF9TkOtJa9xi88d","3YqsiIdySEd09lzV32m5","ylvKGKGCg7czbnag165l","fw00EyV8iQZjXFdSgtG2","PuRhJsXHmkiF1gTUwRjY","WHJ0Q7yD8iDzNkiSf20E","rZFUYXDbQ1CGO1uFVET5","eltHxl9jvaaIARW4UxJm","f3OanUhl4LjfF4Ht1Q5W","xNvWIwPn6EkevvgyO8tZ","5A6hj96K6OUHKq7BFtoG","hhWZgp8rejFBot1le0cv","xsFaRUuLgJeIayJx3ORg","xhxjeVEkzGj6ol2phDHQ","7xw5wxyEpq90vstnHxLq","SUOO0VHiyjzNEd5jilOx","3s11pIu2tGvd4DWSfrWR","OSVJR3IvvkTycvCneyWy","lTMoZWmzqd0uCOYEFACT","IEjka8cUobXhYUGWnA1m","bCwZZGfOuuDahlaYeL6l","30i1Ptul6LJOxauz2l2G","EXcP12fYWNS89ovr7XCS","yZuNqo0EjGkRFoJ2O5f6","xzEWNyEvLsQzR9ZgTyEL","BfyPx4hp0fnOwlBI7x4Q","chiMtfvoGpYplgmIFJwq","ojRmTMDKjEKWSsbZLkPv"],sectionCode:"english",time:27e5,close:null,open:null,status:"new",type:"tutorial"})},{id:"tutorial_math",data:()=>({scaledScoreSection:"pMvfD893wPzWzpbJWLrU",questions:["P2ncugER7tywiIbBPKhj","jMAjJRIK9zqFFn1625dj","NfCj0MsqvjTcKX6O8mZd","Z3nePiGaumpzDcxZ9PFj","SlAtI3mwWDtPe7dXP1IH","dF2Usnwr643dW8bt1NJW","Lxf3nhHlTjn7vKWelZxJ","4uWOzx2rx9tzu2gDKvI5","GKZvSbUaP1w9o4tniAJy","mNhAdN0uyT1W6KMAw8D8","7d89eStRPKu1Y2n0NdNL","rlsOMFoDmm3spZbZWpGJ","1S8j0tqJWYhyWDgvO1WK","bJylm0hXok9HgmnQG0a2","imeyuP2axiThQqOThvje","6iGHWG7F5EJxutY2HJN5","AF2GnEeyuzkBbjyidPdH","ZZNmQCMhiMqPzd3GtwQF","1n2jl4JJk5xTbO65vrkw","OBvtVB8D0MIflUgOKolw","NIWBjcC5qIN6KwBhgFBY","5Pcbs6x77i7ryJxcsCYQ","ZuqJzRTVRmbpaSVOkQqH","x4kmTukJfc2er82VxQ0D","z46tjHtp2BJ3zi7SH3OP","AgSVp7iX9LiiR6HS4VK8","MEV6TNxmSanMXEQIc3Y9","sR51OGUtEpBbb2k0dEIO","BOL2hzJ4RaSeya2NaWhB","Ur6fhTPBXqNxD0A0zAQF","pVAvnXq7VayrSsPNFUNv","1nRwF659tYj6bfOIMwhD","yVd2wxWROrz9GVfF3m1N","Wu6zRAch1IgrVo8lK8v7","kJodG1ceKCNKV9m4Dhvr","QcLML5oy6tUNhoxAeVo6","uwz7Ede3KzRezqpfxgPj","njcKo3S8JXWkQ3E27k9s","BRcZrJeofS83b9tXOLHj","QIGGhk3j1Hj9NtchfdpZ","HV6YIR05TqxwD3oradT4","zBtgtirIxNeyHuGThFAi","QQKAaSzEr4Aoc0536YUW","Xifxlxd7Kd8fehgx4WPY","8SDrnE0d5jmUZd2HvsF2","S5h1zzoziSEzJXt1GXe0","1Y37pPnYI4fcqR7SAcPU","TRRfSflgSCTsnUmJ5Mdi","XBP35S7U0j9IWrF22hPC","Stghc9eyhn3IGnas8a60","quW0c6Hf3S2peWg37aSX","p7GMvzAxIsH7qvGP95wG","cCi6dll5LHXClvUbwpHu","aJeyytv38TsPkTxjN08y","SQ1sRL8FtwgwGWPqMQz8","8hxDhSxEbQx3Hi0Ykex5","TGmFw4ohhPPwZ6lgH7pZ","ywz7RjGD3FQXgoIgG3Sp","xV41HdtLyVujOhNRvzlR","YSD3m9lv5IG9yHkh4Jvi"],sectionCode:"math",open:null,status:"new",type:"tutorial",time:null,close:{toDate:()=>new Date("2050-12-25T09:00:00")}})},{id:"tutorial_reading",data:()=>({scaledScoreSection:"GDkJBiJ8KCwer0Pim6Pm",questions:["s4QJSie8pVCpSH4zyWTH","p8BKL50iuHZXW24mk2gl","ikSvGydUvuFFkjVXocXp","tR8H0dilIonQfaeKjqhQ","qe7qpuEPeMoChAk2VwM7","lEcyAyy0UYzz1WkK6WHO","itCbPboE0w7yJ4hqbLVE","ZBttPTZ6C6sbEjNuFURT","swfXlzD43bbaZAxfsVBb","Qad9ZLgLQMbvEzbx8RAT","ezL5PRSiPzJPVjt3AJv0","9JikqXICMzJfBnk0bnLH","CSgGUPDwChUTRm5RCY2F","9bSCKTy2w0eSdJoGIQOK","GX1yBHjGNmFEkurXBwsu","blL2JyF2DuJZ9rA3C2Wz","ZtBHywAZjW24WQchNuYb","pMsiJxkTMAyjE8FBm6q2","6U8oS7LCaC8C4dbTHzjL","jOOfWnMN4OlFZGdQK0l2","LO5ojmx9YV09s4UzrDQ9","DkNqrnYvyE6YmSEhFy3j","yyPbLDZfRDHnoVHiYfQB","jU8NrxW1IAMxqLt345yy","DYwHcC9eUlMj3Ifamyv7","I17ld1B45b2UwvIQsSiO","SDg97ua40LmfCwWkWw4y","Tv7BrSvtIgflsDBrVjOW","CepqTZQI7zVXQeVo2pag","5oAwGHx8NjLSsbmA5z40","nRXuOlljv377cWaCQXC9","BfMcyFhhvn55810BX3P6","A7pe3Ypl6KWZTbIz79ic","9nVOXdcNfVuNUeKDbMnp","J92AD3ES7A43Koy03nuV","Y66fNJGBC7pV2sv423CL","JVGnkeRLvCHEPI13LHGS","r1iuttvFf4YWSCKhKG62","VhKLbctl85IzHWvW6qrs","EuplRcgwOiCEiEzibiCx"],sectionCode:"reading",time:21e5,close:null,open:null,status:"graded",type:"tutorial",score:33,scaledScore:28})},{id:"tutorial_science",data:()=>({scaledScoreSection:"Ovk7OvWNDinZfp9oRrvj",questions:["KsFGLxTshfkgh5UYcSGW","bCGoLtA6C5NiHJweHlNQ","2ayTF6eYfzuakdPJTAHG","5XCDWYo6g8Z7yXbBDb6e","F3FcVfID9pbDajjjqBoJ","JBHAIWBFjDIRarhr59cj","r6DPOaX0Ezd42Z06o1Kn","n0PGxjXxFuhsvC60BTuy","m42LzVf28tpbqgvsgcNe","Hrt2WP6eOkRGjlrCEOlv","777mCbulCKptHHOtC83D","vb80oiVbZuntgBQ6EfJH","eFlxfqgZYoV6CqlQHXMf","VF8XbnUpnn1cMOoBnDlF","jtN6q6TJHfqK0yfUp7oc","hXDO7uSGTsmyV8WgXgxg","ItGMkJZIG4BZnI566CUl","znMcUr6DyAkGcGS5O8eC","dlFVHGN6Zp7KoE6DRYUY","vhgqU1XB24gQZTuBKFyA","GUsYhuUhOq2zZ6Mra3dH","KcX0tXc3nP8qU0Vro8Wh","5erNHpHsM39MWCIcrkM6","6BYACWh9lmo5QnoCWa4X","6wH6OhoAnWBxksy1S6fA","j9WTaWPZ3qfReTq4bmj1","OcljYJ3n3WyKeh8oRlFB","fWjgaooJ96YT7GS3XBVC","2fN1Fm7Qo46uzmCjAvNp","AovbAS4pFebaoWBn7bVn","sBZekRBHz7O7HCNk96gg","6Ljj0eaPc07yzukODiEJ","O6o6yeMgYiTzvU0fVvpn","mIiFUABpRmNAnmF3qxLZ","80Dtov8YSTHYyuIl15cl","zkVgSAT8p67fl61pYgx9","JG0RMgYk6FwW81iVR34A","906902v4unvgsNe1w2UX","kOea8vvt6OX2s3KPIVYS","Ut10TsfIyCJhfkvLc3hh"],sectionCode:"science",time:21e5,close:null,open:null,status:"graded",type:"tutorial",score:34,scaledScore:30})}],xy=[{message:'\n        <h3 style="text-align:center;">Welcome to the Lyrn Test Taker!</h3>\n        <p style="text-align:center;">Let\'s take a look at how to use it before jumping in.</p>\n      ',tooltip:{element:"#tutorial",location:"center"},assignment:null},{message:'\n        <p>This is an assignment.</p>\n        <ul>\n          <li>english is the section.</li>\n          <li>\n            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve" style="height:1em;position:relative;top:2px;display:inline;">\n            <g>\n              <g>\n                <path d="M392.09,122.767l15.446-24.272c6.858-10.778,3.681-25.076-7.097-31.935c-10.777-6.86-25.076-3.681-31.935,7.099l-15.409,24.215c-22.708-11.316-47.642-18.798-73.962-21.58V46.265h1.448c12.775,0,23.133-10.357,23.133-23.133S293.356,0,280.581,0h-49.163c-12.775,0-23.133,10.357-23.133,23.133s10.357,23.133,23.133,23.133h1.45v30.029C123.239,87.885,37.535,180.886,37.535,293.535C37.535,413.997,135.538,512,256,512s218.465-98.003,218.465-218.465C474.465,224.487,442.259,162.83,392.09,122.767zM256,465.735c-94.951,0-172.2-77.249-172.2-172.2s77.249-172.2,172.2-172.2s172.2,77.249,172.2,172.2S350.951,465.735,256,465.735z"></path>\n              </g>\n            </g>\n            <g>\n              <g>\n                <path d="M333.172,205.084c-9.623-8.397-24.238-7.407-32.638,2.222l-61.964,71.02c-8.399,9.626-7.404,24.24,2.222,32.638c9.626,8.399,24.24,7.404,32.638-2.222l61.964-71.02C343.794,228.096,342.798,213.484,333.172,205.084z"></path>\n              </g>\n            </g>\n            </svg>\n            <p style="margin:0;display:inline;">45 minutes to complete the test.</p>\n          </li>\n          <li>\n            <svg viewBox="4 4 16 16" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="height:1em;position:relative;top:3px;display:inline;">\n              <path d="M9 11h6v2H9z"></path>\n              <path d="M17 5H7c-1.103 0-2 .897-2 2v10c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2zM7 17V7h10l.002 10H7z"></path>\n            </svg>\n            <p style="margin:0;display:inline;">75 questions on the test.</p>\n          </li>\n        </ul>\n      ',tooltip:{element:"#fullAssignments .assignment.english-background",location:"bottom"},assignment:null},{message:'\n        <p>Another assignment.</p>\n        <ul>\n          <li>math is the section.</li>\n          <li>\n            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve" style="height:1em;position:relative;top:2px;display:inline;">\n            <g>\n              <g>\n                <path d="M392.09,122.767l15.446-24.272c6.858-10.778,3.681-25.076-7.097-31.935c-10.777-6.86-25.076-3.681-31.935,7.099l-15.409,24.215c-22.708-11.316-47.642-18.798-73.962-21.58V46.265h1.448c12.775,0,23.133-10.357,23.133-23.133S293.356,0,280.581,0h-49.163c-12.775,0-23.133,10.357-23.133,23.133s10.357,23.133,23.133,23.133h1.45v30.029C123.239,87.885,37.535,180.886,37.535,293.535C37.535,413.997,135.538,512,256,512s218.465-98.003,218.465-218.465C474.465,224.487,442.259,162.83,392.09,122.767zM256,465.735c-94.951,0-172.2-77.249-172.2-172.2s77.249-172.2,172.2-172.2s172.2,77.249,172.2,172.2S350.951,465.735,256,465.735z"></path>\n              </g>\n            </g>\n            <g>\n              <g>\n                <path d="M333.172,205.084c-9.623-8.397-24.238-7.407-32.638,2.222l-61.964,71.02c-8.399,9.626-7.404,24.24,2.222,32.638c9.626,8.399,24.24,7.404,32.638-2.222l61.964-71.02C343.794,228.096,342.798,213.484,333.172,205.084z"></path>\n              </g>\n            </g>\n            </svg>\n            <p style="margin:0;display:inline;">--:-- unlimited time to complete.</p>\n          </li>\n          <li>\n            <p style="margin:0;display:inline;">On Sun 12/25/2050 at 09:00 pm this test will auto submit.</p>\n          </li>\n        </ul>\n      ',tooltip:{element:"#fullAssignments .assignment.math-background",location:"bottom"},assignment:null},{message:"\n        <p>Select the best answer choice for each question.</p>\n      ",tooltip:{element:"#questionChoices",location:"left"},assignment:{section:"reading",start:7,selector:!1,choice:1,flag:!1}},{message:"\n        <p>To flag a question, click the circle.</p>\n      ",tooltip:{element:"label[for='questionFlag']",location:"bottom-left"},assignment:{section:"reading",start:7,selector:!1,choice:1,flag:!0}},{message:"\n        <p>To open the question selector, click the tab.</p>\n      ",tooltip:{element:".pull-tab",location:"right"},assignment:{section:"reading",start:7,selector:!0,choice:1,flag:!0}},{message:"\n        <p>Here you will find an overview of your test</p>\n        <ul>\n          <li>Current question is highlighted.</li>\n          <li>If answered, the circle will be filled in.</li>\n          <li>If flagged, the circle will have a flag.</li>\n        </ul>\n      ",tooltip:{element:".main .panels .selector input[type=radio]:checked + .selector-wrapper",location:"right"},assignment:{section:"reading",start:7,selector:!0,choice:1,flag:!0}},{message:"\n        <p>You can submit your test if it is not timed. Otherwise, you will see how much time you have remaining and must wait for it to submit itself.</p>\n      ",tooltip:{element:"#assignmentSubmit",location:"bottom-right"},assignment:{section:"reading",start:7,selector:!0,choice:1,flag:!0}},{message:"\n        <p>After submitting you will see your score.</p>\n        <ul>\n            <li>28 is your scaled score (actual ACT score)</li>\n            <li>33 is how many you got right out of 40</li>\n        </ul>\n      ",tooltip:{element:"#fullAssignments .assignment.reading-background",location:"bottom"}},{message:"\n          <p>Click on any graded assignment to review it.</p>\n        ",tooltip:{element:"#fullAssignments .assignment.science-background",location:"bottom"}},{message:"\n          <p>Here you can see what answer you selected.</p>\n        ",tooltip:{element:"#questionChoices",location:"left"},assignment:{section:"science",review:1,selector:!1,choice:3,flag:!1}},{message:"\n          <p>Show the correct answer.</p>\n        ",tooltip:{element:"#answerToggle",location:"left"},assignment:{section:"science",review:1,selector:!1,choice:3,flag:!1,correct:!0}},{message:"\n          <p>And see an in-depth explanation.</p>\n        ",tooltip:{element:"#questionExplanation",location:"left"},assignment:{section:"science",review:1,selector:!1,choice:3,flag:!1,correct:!0,explanation:!0}},{message:"\n          <p>The selector is now split up into topics.</p>\n        ",tooltip:{element:".pull-tab",location:"right"},assignment:{section:"science",review:1,selector:!0,choice:3,flag:!1,correct:!0,explanation:!0}},{message:"\n          <p>You can now see which questions are of the same topic and see how they relate.</p>\n        ",tooltip:{element:".main .panels .selector input[type=radio]:checked + .selector-wrapper",location:"right"},assignment:{section:"science",review:1,selector:!0,choice:3,flag:!1,correct:!0,explanation:!0}},{message:"\n            <p>Click on this question mark to start this tutorial again.</p>\n        ",tooltip:{element:".tutorial-bubble",location:"bottom-left"},assignment:null}],Py=[{message:'\n      <h3 style="text-align:center;">Welcome to the Lyrn Test Taker!</h3>\n      <p style="text-align:center;">For the best experience, open your test taker on a larger screen.</p>\n    ',tooltip:{element:"#tutorial",location:"center"},assignment:null}],My=er(mn),Fy=gg(mn),Uy=location.pathname.split("/")[2];let Vy=null,qy=null,jy=null;const By=["dev","admin","tutor"];let $y,zy=[],Hy=null;function Ky(e){for(;e.firstChild;)e.removeChild(e.firstChild)}async function Wy(){localStorage.setItem("TestTakerTutorial","started"),document.getElementById("tutorial").classList.add("open"),document.querySelector(".main .panels .selector").classList.add("no-transition"),document.querySelectorAll("section").forEach((e=>e.classList.add("hide"))),document.getElementById("landing").classList.remove("hide"),$y&&($y(),$y=null),zy=[],Yy(),zy=Ly.map((e=>new Cy(e,By.includes(jy)))),Xy(),Gy(0,window.innerWidth<=1e3)}async function Gy(e,t=!1){if(t?e>=Py.length:e>=xy.length)return void Qy();document.getElementById("tutorialBack").style.visibility=0==e?"hidden":"visible",(t?e==Py.length-1:e==xy.length-1)?document.getElementById("tutorialNext").textContent="Finish":document.getElementById("tutorialNext").textContent="Next";const n=t?Py[e]:xy[e],i=document.getElementById("tutorialTooltip"),s=document.getElementById("tooltipMessage");if(n.assignment&&n.assignment.start){const e=zy.find((e=>n.assignment.section===e.sectionCode));e.isStarted||(tv()&&tv().end(),await e.start(!0)),!e.currentQuestion.pos!=n.assignment.start-1&&await e.startQuestion(n.assignment.start-1)}else if(n.assignment&&n.assignment.review){const e=zy.find((e=>n.assignment.section===e.sectionCode));e.isInReview||(tv()&&tv().end(),await e.review()),!e.currentQuestion.pos!=n.assignment.review-1&&await e.reviewQuestion(n.assignment.review-1)}else ev();if(n.assignment){document.getElementById("questionFlag").checked=n.assignment.flag,n.assignment.choice?document.querySelector(`#choice_${n.assignment.choice}`).checked=!0:document.querySelector(`#choice_${n.assignment.choice}`).checked=!1;const e=document.querySelector(".main .panels .selector input[type=radio]:checked + .selector-wrapper > span");n.assignment.flag?e.classList.add("flagged"):e.classList.remove("flagged"),n.assignment.choice?e.classList.add("answered"):e.classList.remove("answered");const t=document.querySelector(".main .panels .selector");n.assignment.selector?t.classList.add("open"):t.classList.remove("open");const i=document.getElementById("answerToggleInput");i&&(n.assignment.correct?i.checked=!0:i.checked=!1);const s=document.getElementById("questionExplanationInput");s&&(n.assignment.explanation?s.checked=!0:s.checked=!1)}s.innerHTML=n.message,function(e,t){const n=document.querySelector(t.element).getBoundingClientRect(),i=e.getBoundingClientRect();switch(t.location){case"center":e.style.top=(n.top+n.height/2-i.height/2).toString()+"px",e.style.left=(n.left+n.width/2-i.width/2).toString()+"px";break;case"top-left":e.style.top=(n.top-i.height-10).toString()+"px",e.style.left=(n.left-i.width-10).toString()+"px";break;case"top":e.style.top=(n.top-i.height-10).toString()+"px",e.style.left=(n.left+n.width/2-i.width/2).toString()+"px";break;case"top-right":e.style.top=(n.top-i.height-10).toString()+"px",e.style.left=(n.right+10).toString()+"px";break;case"right":e.style.top=(n.top+n.height/2-i.height/2).toString()+"px",e.style.left=(n.right+10).toString()+"px";break;case"bottom-right":e.style.top=(n.bottom+10).toString()+"px",e.style.left=(n.right+10).toString()+"px";break;case"bottom":e.style.top=(n.bottom+10).toString()+"px",e.style.left=(n.left+n.width/2-i.width/2).toString()+"px";break;case"bottom-left":e.style.top=(n.bottom+10).toString()+"px",e.style.left=(n.left-i.width-10).toString()+"px";break;case"left":e.style.top=(n.top+n.height/2-i.height/2).toString()+"px",e.style.left=(n.left-i.width-10).toString()+"px";break;default:console.warn("tutorial not given location")}}(i,n.tooltip),i.setAttribute("data-step",e.toString())}function Qy(){ev(),Yy(),zy=[],Jy(Uy),document.getElementById("tutorial").classList.remove("open"),document.querySelector(".main .panels .selector").classList.remove("no-transition")}function Jy(e){const t=Gg(hg(Fy,"ACT-Assignments"),Jg("student","==",e));$y=function(e,...t){var n,i,s;e=N(e);let r={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||pg(t[o])||(r=t[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges};if(pg(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),t[o+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let c,l,u;if(e instanceof lg)l=rg(e.firestore,mg),u=Ph(e._key.path),c={next:n=>{t[o]&&t[o](dy(l,e,n))},error:t[o+1],complete:t[o+2]};else{const n=rg(e,cg);l=rg(n.firestore,mg),u=n._query;const i=new cy(l);c={next:e=>{t[o]&&t[o](new ry(l,i,n,e))},error:t[o+1],complete:t[o+2]},Hg(e._query)}return function(e,t,n,i){const s=new Wm(i),r=new bm(t,s,n);return e.asyncQueue.enqueueAndForget((async()=>mm(await Ym(e),r))),()=>{s.Ca(),e.asyncQueue.enqueueAndForget((async()=>gm(await Ym(e),r)))}}(yg(l),u,a,c)}(t,(e=>{e.docChanges().forEach((e=>{if("added"===e.type){const t=new Cy(e.doc,By.includes(jy));zy.push(t)}if("modified"===e.type&&zy.find((t=>t.id==e.doc.id)).update(e.doc.data()),"removed"===e.type){const t=zy.findIndex((t=>t.id===e.doc.id));zy[t].isStarted&&zy[t].end(),zy[t].resetTimers(),zy[t].wrapper.remove(),zy.splice(t,1)}})),Xy(),Hy=function(){let e=[];for(const t of zy)e=e.concat(t.questions);return e}()}))}function Xy(){let e=[],t=[],n=[],i=[];for(const s of zy)"marketing"!==s.type&&"tutorial"!==s.type?"started"!==s.status?"new"!==s.status?"submitted"!==s.status&&"graded"!==s.status&&"omitted"!==s.status||i.push(s):n.push(s):t.push(s):e.push(s);t.sort(((e,t)=>e.startedAt.toDate().getTime()+(e.time??1/0)-(t.startedAt.toDate().getTime()+(t.time??1/0)))),n.sort(((e,t)=>(e.close?.toDate().getTime()??0)-(t.close?.toDate().getTime()??0)||(e.open?.toDate().getTime()??0)-(t.open?.toDate().getTime()??0))),i.sort(((e,t)=>(t.submittedAt?.toDate().getTime()??t.close?.toDate().getTime()??0)-(e.submittedAt?.toDate().getTime()??e.close?.toDate().getTime()??0)));for(const e of t)e.show(document.querySelector(`#newAssignments .${e.sectionCode}-container`));for(const e of n)e.show(document.querySelector(`#newAssignments .${e.sectionCode}-container`));for(const e of i)e.show(document.querySelector(`#previousAssignments .${e.sectionCode}-container`));(async function(e){const t=await Promise.all(e.map((async e=>(await ay(dg(Fy,"ACT-Section-Data",e.scaledScoreSection))).data().test)));let n={};for(let i=0;i<e.length;i++)n[t[i]]||(n[t[i]]=[]),n[t[i]].push(e[i]);for(const e in n)n[e].sort(((e,t)=>nv(e.sectionCode,t.sectionCode)));return n})(e).then((e=>{Ky(document.getElementById("fullAssignments"));for(const t in e){const n=document.createElement("div");n.className="full-test-wrapper";const i=document.createElement("h3");n.appendChild(i);const s=document.createElement("div");s.className="full-test-content",n.appendChild(s);let r=[];for(const n of e[t])n.show(s),r.push(n.scaledScore??null);let o=Zy(r)??"N/A";i.textContent=`Composite Score: ${o}`,document.getElementById("fullAssignments").appendChild(n)}}))}function Yy(){Ky(document.getElementById("fullAssignments")),document.querySelectorAll("#newAssignments > div").forEach((e=>Ky(e))),document.querySelectorAll("#previousAssignments > div").forEach((e=>Ky(e)))}function Zy(e){if(e.some((e=>null===e)))return null;const t=e.reduce(((e,t)=>e+t)),n=e.length;return Math.round(t/n)}function ev(){const e=tv();e&&e.end()}function tv(){return zy.find((e=>e.isStarted||e.isInReview))}function nv(e,t){return(e=e.toString())<(t=t.toString())?-1:e==t?0:e>t?1:void 0}document.addEventListener("DOMContentLoaded",(async function(){Wi(My,(async e=>{if(e){qy=e;const t=await e.getIdTokenResult();if(jy=t.claims.role,document.getElementById("welcomeMessage").querySelector("span").textContent=e.displayName.split(" ")[0],async function(e){Vy=await ay(dg(Fy,"Users",e)),By.includes(jy)?e!=qy.uid?document.getElementById("tutorStudentMessage").textContent=`You are viewing ${Vy.data().firstName} ${Vy.data().lastName}'s test taker.`:document.getElementById("tutorStudentMessage").textContent="You are viewing your own test taker.":document.getElementById("tutorStudentMessage").textContent="Welcome to your personal test taker."}(Uy),!By.includes(jy)&&qy.uid!=Uy)return void window.location.replace(`${location.origin}/test-taker/${qy.uid}`)}else qy=null,jy=null;"started"!==localStorage.getItem("TestTakerTutorial")?Wy():Jy(Uy)})),function(e){const t=document.querySelector(".next-lesson-wrapper"),n=document.getElementById("nextLessonDetails");e?n.innerHTML=e:t.style.display="none"}('Need help on some of these tests? Check out our <a href="/pricing?program=one-on-one" target="_blank">ACT Programs.</a>')})),window.endTutorial=Qy,window.tutorialBack=function(){const e=document.getElementById("tutorialTooltip");Gy(parseInt(e.dataset.step)-1,window.innerWidth<=1e3)},window.tutorialNext=function(){const e=document.getElementById("tutorialTooltip");Gy(parseInt(e.dataset.step)+1,window.innerWidth<=1e3)},window.signOut=dr,window.openFeedback=async function(){const e=await nr.prompt("How can we improve?");e&&(await ly(dg(hg(Fy,"Feedback")),{message:e,type:"Test Taker",time:new Date,user:qy.uid}),nr.toastMessage("Thank you for your feedback!"))},window.startTutorial=Wy,window.goToLanding=ev,window.submitCurrentAssignment=async function(){const e=tv();e&&await nr.confirm("Are you sure you are ready to submit this assignment?")&&e.submit()},window.toggleSelectorCallback=function(){document.querySelector(".main .panels .selector").classList.toggle("open")},window.showQuestionMobile=function(){document.querySelector(".main .panels .passage").classList.add("mobile-hide"),document.querySelector(".main .panels .question").classList.remove("mobile-hide")},window.showPassageMobile=function(){document.querySelector(".main .panels .question").classList.add("mobile-hide"),document.querySelector(".main .panels .passage").classList.remove("mobile-hide")},window.questionFlagChangeCallback=function(e){const t=tv();t&&t.currentQuestion.flagToggled(e.target.checked)},window.previousQuestionCallback=function(){const e=tv();if(!e)return;const t=e.currentQuestion;if(e.isStarted){const n=t.pos-1;e.startQuestion(n,!0)}else if(e.isInReview){const n=e.sortedQuestionsByTopic.reduce(((e,t)=>e.concat(t.questions)),[]).findIndex((e=>e.id===t.id))-1;e.reviewQuestion(n,!0)}},window.nextQuestionCallback=function(){const e=tv();if(!e)return;const t=e.currentQuestion;if(e.isStarted){const n=t.pos+1;e.startQuestion(n,!0)}else if(e.isInReview){const n=e.sortedQuestionsByTopic.reduce(((e,t)=>e.concat(t.questions)),[]).findIndex((e=>e.id===t.id))+1;e.reviewQuestion(n,!0)}},HTMLElement.prototype.textNodes=function(){return[...this.childNodes].filter((e=>e.nodeType===Node.TEXT_NODE&&""!==e.nodeValue.trim()))}})();