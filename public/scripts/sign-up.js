/*! For license information please see sign-up.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=r>>2,u=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[l],n[u],n[h],n[d])}return i.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==a||null==c)throw new i;const l=s<<2|o>>4;if(r.push(l),64!==a){const t=o<<4&240|a>>2;if(r.push(t),64!==c){const t=a<<6&192|c;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r=function(t){return function(t){const i=e(t);return n.encodeByteArray(i,!0)}(t).replace(/\./g,"")},s=function(t){try{return n.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&s(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},a=t=>{var e,n;return null===(n=null===(e=o())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},c=t=>{const e=a(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},l=()=>{var t;return null===(t=o())||void 0===t?void 0:t.config},u=t=>{var e;return null===(e=o())||void 0===e?void 0:e[`_${t}`]};class h{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function p(){try{return"object"==typeof indexedDB}catch(t){return!1}}function g(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class m extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(v,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new m(i,o,n)}}const v=/\{\$([^}]+)}/g;function w(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(I(n)&&I(s)){if(!w(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function I(t){return null!==t&&"object"==typeof t}function b(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function E(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function T(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class _{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=S),void 0===i.error&&(i.error=S),void 0===i.complete&&(i.complete=S);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function S(){}const C=1e3,k=2,A=144e5,D=.5;function N(t,e=C,n=k){const i=e*Math.pow(n,t),r=Math.round(D*i*(Math.random()-.5)*2);return Math.min(A,i+r)}function O(t){return t&&t._delegate?t._delegate:t}class R{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const P="[DEFAULT]";class L{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new h;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:P})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=P){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=P){return this.instances.has(t)}getOptions(t=P){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===P?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=P){return this.component?this.component.multipleInstances?t:P:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class M{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new L(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const x=[];var F,U;(U=F||(F={}))[U.DEBUG=0]="DEBUG",U[U.VERBOSE=1]="VERBOSE",U[U.INFO=2]="INFO",U[U.WARN=3]="WARN",U[U.ERROR=4]="ERROR",U[U.SILENT=5]="SILENT";const V={debug:F.DEBUG,verbose:F.VERBOSE,info:F.INFO,warn:F.WARN,error:F.ERROR,silent:F.SILENT},j=F.INFO,$={[F.DEBUG]:"log",[F.VERBOSE]:"log",[F.INFO]:"info",[F.WARN]:"warn",[F.ERROR]:"error"},B=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=$[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class z{constructor(t){this.name=t,this._logLevel=j,this._logHandler=B,this._userLogHandler=null,x.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in F))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?V[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,F.DEBUG,...t),this._logHandler(this,F.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,F.VERBOSE,...t),this._logHandler(this,F.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,F.INFO,...t),this._logHandler(this,F.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,F.WARN,...t),this._logHandler(this,F.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,F.ERROR,...t),this._logHandler(this,F.ERROR,...t)}}const H=(t,e)=>e.some((e=>t instanceof e));let q,K;const G=new WeakMap,W=new WeakMap,X=new WeakMap,Q=new WeakMap,J=new WeakMap;let Y={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return W.get(t);if("objectStoreNames"===e)return t.objectStoreNames||X.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Z(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(K||(K=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(et(this),t),tt(G.get(this))}:function(...t){return tt(e.apply(et(this),t))}:function(t,...n){const i=e.call(et(this),t,...n);return X.set(i,t.sort?t.sort():[t]),tt(i)}:(t instanceof IDBTransaction&&function(t){if(W.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));W.set(t,e)}(t),H(t,q||(q=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Y):t);var e}function tt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(tt(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&G.set(e,t)})).catch((()=>{})),J.set(e,t),e}(t);if(Q.has(t))return Q.get(t);const e=Z(t);return e!==t&&(Q.set(t,e),J.set(e,t)),e}const et=t=>J.get(t),nt=["get","getKey","getAll","getAllKeys","count"],it=["put","add","delete","clear"],rt=new Map;function st(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(rt.get(e))return rt.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=it.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!nt.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return rt.set(e,s),s}var ot;ot=Y,Y={...ot,get:(t,e,n)=>st(t,e)||ot.get(t,e,n),has:(t,e)=>!!st(t,e)||ot.has(t,e)};class at{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const ct="@firebase/app",lt="0.9.15",ut=new z("@firebase/app"),ht="[DEFAULT]",dt={[ct]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ft=new Map,pt=new Map;function gt(t,e){try{t.container.addComponent(e)}catch(n){ut.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function mt(t){const e=t.name;if(pt.has(e))return ut.debug(`There were multiple attempts to register component ${e}.`),!1;pt.set(e,t);for(const e of ft.values())gt(e,t);return!0}function yt(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const vt=new y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class wt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new R("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw vt.create("app-deleted",{appName:this._name})}}const It="10.1.0";function bt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:ht,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw vt.create("bad-app-name",{appName:String(r)});if(n||(n=l()),!n)throw vt.create("no-options");const s=ft.get(r);if(s){if(w(n,s.options)&&w(i,s.config))return s;throw vt.create("duplicate-app",{appName:r})}const o=new M(r);for(const t of pt.values())o.addComponent(t);const a=new wt(n,i,o);return ft.set(r,a),a}function Et(t=ht){const e=ft.get(t);if(!e&&t===ht&&l())return bt();if(!e)throw vt.create("no-app",{appName:t});return e}function Tt(t,e,n){var i;let r=null!==(i=dt[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void ut.warn(t.join(" "))}mt(new R(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const _t="firebase-heartbeat-database",St=1,Ct="firebase-heartbeat-store";let kt=null;function At(){return kt||(kt=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=tt(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(tt(o.result),t.oldVersion,t.newVersion,tt(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(_t,St,{upgrade:(t,e)=>{0===e&&t.createObjectStore(Ct)}}).catch((t=>{throw vt.create("idb-open",{originalErrorMessage:t.message})}))),kt}async function Dt(t,e){try{const n=(await At()).transaction(Ct,"readwrite"),i=n.objectStore(Ct);await i.put(e,Nt(t)),await n.done}catch(t){if(t instanceof m)ut.warn(t.message);else{const e=vt.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});ut.warn(e.message)}}}function Nt(t){return`${t.name}!${t.options.appId}`}class Ot{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Pt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Rt();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Rt(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),Lt(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Lt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=r(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Rt(){return(new Date).toISOString().substring(0,10)}class Pt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!p()&&g().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await At();return await e.transaction(Ct).objectStore(Ct).get(Nt(t))}catch(t){if(t instanceof m)ut.warn(t.message);else{const e=vt.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});ut.warn(e.message)}}}(this.app);return t||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Dt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Dt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Lt(t){return r(JSON.stringify({version:2,heartbeats:t})).length}mt(new R("platform-logger",(t=>new at(t)),"PRIVATE")),mt(new R("heartbeat",(t=>new Ot(t)),"PRIVATE")),Tt(ct,lt,""),Tt(ct,lt,"esm2017"),Tt("fire-js",""),Tt("firebase","10.1.0","app");const Mt=(t,e)=>e.some((e=>t instanceof e));let xt,Ft;const Ut=new WeakMap,Vt=new WeakMap,jt=new WeakMap,$t=new WeakMap,Bt=new WeakMap;let zt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return Vt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||jt.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return qt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Ht(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ft||(Ft=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Kt(this),t),qt(Ut.get(this))}:function(...t){return qt(e.apply(Kt(this),t))}:function(t,...n){const i=e.call(Kt(this),t,...n);return jt.set(i,t.sort?t.sort():[t]),qt(i)}:(t instanceof IDBTransaction&&function(t){if(Vt.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));Vt.set(t,e)}(t),Mt(t,xt||(xt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,zt):t);var e}function qt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(qt(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&Ut.set(e,t)})).catch((()=>{})),Bt.set(e,t),e}(t);if($t.has(t))return $t.get(t);const e=Ht(t);return e!==t&&($t.set(t,e),Bt.set(e,t)),e}const Kt=t=>Bt.get(t),Gt=["get","getKey","getAll","getAllKeys","count"],Wt=["put","add","delete","clear"],Xt=new Map;function Qt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Xt.get(e))return Xt.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=Wt.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Gt.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return Xt.set(e,s),s}zt=(t=>({...t,get:(e,n,i)=>Qt(e,n)||t.get(e,n,i),has:(e,n)=>!!Qt(e,n)||t.has(e,n)}))(zt);const Jt="@firebase/installations",Yt="0.6.4",Zt=1e4,te=`w:${Yt}`,ee="FIS_v2",ne="https://firebaseinstallations.googleapis.com/v1",ie=36e5,re=new y("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function se(t){return t instanceof m&&t.code.includes("request-failed")}function oe({projectId:t}){return`${ne}/projects/${t}/installations`}function ae(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function ce(t,e){const n=(await e.json()).error;return re.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function le({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function ue(t){const e=await t();return e.status>=500&&e.status<600?t():e}function he(t){return new Promise((e=>{setTimeout(e,t)}))}const de=/^[cdef][\w-]{21}$/,fe="";function pe(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return de.test(e)?e:fe}catch(t){return fe}}function ge(t){return`${t.appName}!${t.appId}`}const me=new Map;function ye(t,e){const n=ge(t);ve(n,e),function(t,e){const n=(!we&&"BroadcastChannel"in self&&(we=new BroadcastChannel("[Firebase] FID Change"),we.onmessage=t=>{ve(t.data.key,t.data.fid)}),we);n&&n.postMessage({key:t,fid:e}),0===me.size&&we&&(we.close(),we=null)}(n,e)}function ve(t,e){const n=me.get(t);if(n)for(const t of n)t(e)}let we=null;const Ie="firebase-installations-database",be=1,Ee="firebase-installations-store";let Te=null;function _e(){return Te||(Te=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=qt(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(qt(o.result),t.oldVersion,t.newVersion,qt(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}(Ie,be,{upgrade:(t,e)=>{0===e&&t.createObjectStore(Ee)}})),Te}async function Se(t,e){const n=ge(t),i=(await _e()).transaction(Ee,"readwrite"),r=i.objectStore(Ee),s=await r.get(n);return await r.put(e,n),await i.done,s&&s.fid===e.fid||ye(t,e.fid),e}async function Ce(t){const e=ge(t),n=(await _e()).transaction(Ee,"readwrite");await n.objectStore(Ee).delete(e),await n.done}async function ke(t,e){const n=ge(t),i=(await _e()).transaction(Ee,"readwrite"),r=i.objectStore(Ee),s=await r.get(n),o=e(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||ye(t,o.fid),o}async function Ae(t){let e;const n=await ke(t.appConfig,(n=>{const i=function(t){return Oe(t||{fid:pe(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(re.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=oe(t),r=le(t),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={fid:n,authVersion:ee,appId:t.appId,sdkVersion:te},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await ue((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:ae(t.authToken)}}throw await ce("Create Installation",c)}(t,e);return Se(t.appConfig,n)}catch(n){throw se(n)&&409===n.customData.serverCode?await Ce(t.appConfig):await Se(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:De(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry}));return n.fid===fe?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function De(t){let e=await Ne(t.appConfig);for(;1===e.registrationStatus;)await he(100),e=await Ne(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Ae(t);return n||e}return e}function Ne(t){return ke(t,(t=>{if(!t)throw re.create("installation-not-found");return Oe(t)}))}function Oe(t){return 1===(e=t).registrationStatus&&e.registrationTime+Zt<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function Re({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${oe(t)}/${e}/authTokens:generate`}(t,n),r=function(t,{refreshToken:e}){const n=le(t);return n.append("Authorization",function(t){return`${ee} ${t}`}(e)),n}(t,n),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={installation:{sdkVersion:te,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await ue((()=>fetch(i,a)));if(c.ok)return ae(await c.json());throw await ce("Generate Auth Token",c)}async function Pe(t,e=!1){let n;const i=await ke(t.appConfig,(i=>{if(!Me(i))throw re.create("not-registered");const r=i.authToken;if(!e&&(2===(s=r).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+ie}(s)))return i;var s;if(1===r.requestStatus)return n=async function(t,e){let n=await Le(t.appConfig);for(;1===n.authToken.requestStatus;)await he(100),n=await Le(t.appConfig);const i=n.authToken;return 0===i.requestStatus?Pe(t,e):i}(t,e),i;{if(!navigator.onLine)throw re.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await Re(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await Se(t.appConfig,i),n}catch(n){if(!se(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Se(t.appConfig,n)}else await Ce(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function Le(t){return ke(t,(t=>{if(!Me(t))throw re.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+Zt<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function Me(t){return void 0!==t&&2===t.registrationStatus}function xe(t){return re.create("missing-app-config-values",{valueName:t})}const Fe="installations";mt(new R(Fe,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw xe("App Configuration");if(!t.name)throw xe("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw xe(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:yt(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),mt(new R("installations-internal",(t=>{const e=yt(t.getProvider("app").getImmediate(),Fe).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await Ae(e);return i?i.catch(console.error):Pe(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await Ae(t);e&&await e}(n),(await Pe(n,e)).token}(e,t)}}),"PRIVATE")),Tt(Jt,Yt),Tt(Jt,Yt,"esm2017");const Ue="analytics",Ve="firebase_id",je="origin",$e=6e4,Be="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ze="https://www.googletagmanager.com/gtag/js",He=new z("@firebase/analytics"),qe=new y("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Ke(t){if(!t.startsWith(ze)){const e=qe.create("invalid-gtag-resource",{gtagURL:t});return He.warn(e.message),""}return t}function Ge(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const We=30,Xe=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Qe(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Je(t,e=Xe,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw qe.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw qe.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Ze;return setTimeout((async()=>{a.abort()}),void 0!==n?n:$e),Ye({appId:i,apiKey:r,measurementId:s},o,a,e)}async function Ye(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=Xe){var s;const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise(((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((()=>{clearTimeout(s),i(qe.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(a)return He.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:Qe(i)},s=Be.replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw qe.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(o),e}catch(e){const c=e;if(!function(t){if(!(t instanceof m&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(r.deleteThrottleMetadata(o),a)return He.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw e}const l=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?N(n,r.intervalMillis,We):N(n,r.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return r.setThrottleMetadata(o,u),He.debug(`Calling attemptFetch again in ${l} millis`),Ye(t,u,i,r)}}class Ze{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let tn,en;async function nn(t,e,n,i,r,s,o){var a;const c=Je(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&He.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>He.error(t))),e.push(c);const l=async function(){if(!p())return He.warn(qe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await g()}catch(t){return He.warn(qe.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[u,h]=await Promise.all([c,l]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ze)&&n.src.includes(t))return n;return null})(s)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:Ke}),i=document.createElement("script"),r=`${ze}?l=${t}&id=${e}`;i.src=n?null==n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,u.measurementId),en&&(r("consent","default",en),en=void 0),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[je]="firebase",d.update=!0,null!=h&&(d[Ve]=h),r("config",u.measurementId,d),tn&&(r("set",tn),tn=void 0),u.measurementId}class rn{constructor(t){this.app=t}_delete(){return delete sn[this.app.options.appId],Promise.resolve()}}let sn={},on=[];const an={};let cn,ln,un="dataLayer",hn=!1;function dn(t,e,n){!function(){const t=[];if(f()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=qe.create("invalid-analytics-context",{errorInfo:e});He.warn(n.message)}}();const i=t.options.appId;if(!i)throw qe.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw qe.create("no-api-key");He.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=sn[i])throw qe.create("already-exists",{id:i});if(!hn){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(un);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let s=function(...t){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(t,e,n,i){return async function(r,...s){try{if("event"===r){const[i,r]=s;await async function(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=await Ge(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(t){He.error(t)}}(t,e,n,i,r)}else if("config"===r){const[r,o]=s;await async function(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const t=(await Ge(n)).find((t=>t.measurementId===r));t&&await e[t.appId]}}catch(t){He.error(t)}t("config",r,s)}(t,e,n,i,r,o)}else if("consent"===r){const[e]=s;t("consent","update",e)}else if("get"===r){const[e,n,i]=s;t("get",e,n,i)}else if("set"===r){const[e]=s;t("set",e)}else t(r,...s)}catch(t){He.error(t)}}}(s,t,e,n),{gtagCore:s,wrappedGtag:window[r]}}(sn,on,an,un,"gtag");ln=t,cn=e,hn=!0}return sn[i]=nn(t,on,an,e,cn,un,n),new rn(t)}const fn="@firebase/analytics",pn="0.10.0";mt(new R(Ue,((t,{options:e})=>dn(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),mt(new R("analytics-internal",(function(t){try{const e=t.getProvider(Ue).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=O(t),async function(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(ln,sn[t.app.options.appId],e,n,i).catch((t=>He.error(t)))}(e,t,n,i)}}catch(t){throw qe.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Tt(fn,pn),Tt(fn,pn,"esm2017");const gn=bt({apiKey:"AIzaSyD8GSMZzjbubQ7AGcQKIV-enpDYpz_07mo",authDomain:"lyrn-web-app.firebaseapp.com",projectId:"lyrn-web-app",storageBucket:"lyrn-web-app.appspot.com",messagingSenderId:"80732012862",appId:"1:80732012862:web:22ffb978c80a1d2a0f2c6f",measurementId:"G-F2QZT3W2CX"});!function(t=Et()){const e=yt(t=O(t),Ue);e.isInitialized()?e.getImmediate():function(t,e={}){const n=yt(t,Ue);if(n.isInitialized()){const t=n.getImmediate();if(w(e,n.getOptions()))return t;throw qe.create("already-initialized")}n.initialize({options:e})}(t)}(gn),"localhost"===location.hostname||location.hostname;const mn=gn;function yn(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const vn=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},wn=new y("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),In=new z("@firebase/auth");function bn(t,...e){In.logLevel<=F.ERROR&&In.error(`Auth (${It}): ${t}`,...e)}function En(t,...e){throw _n(t,...e)}function Tn(t,...e){return _n(t,...e)}function _n(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return wn.create(t,...e)}function Sn(t,e,...n){if(!t)throw _n(e,...n)}function Cn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bn(e),new Error(e)}function kn(t,e){t||Cn(e)}function An(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Dn(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class Nn{constructor(t,e){this.shortDelay=t,this.longDelay=e,kn(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Dn()||"https:"===Dn()||f()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function On(t,e){kn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Rn{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Pn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ln=new Nn(3e4,6e4);function Mn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function xn(t,e,n,i,r={}){return Fn(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=b(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Rn.fetch()(Vn(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Fn(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Pn),e);try{const e=new jn(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw $n(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw $n(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw $n(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw $n(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},vn()),{[e]:n});return new y("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);En(t,a)}}catch(e){if(e instanceof m)throw e;En(t,"network-request-failed",{message:String(e)})}}async function Un(t,e,n,i,r={}){const s=await xn(t,e,n,i,r);return"mfaPendingCredential"in s&&En(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Vn(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?On(t.config,r):`${t.config.apiScheme}://${r}`}class jn{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Tn(this.auth,"network-request-failed"))),Ln.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function $n(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Tn(t,e,i);return r.customData._tokenResponse=n,r}function Bn(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}async function zn(t,e=!1){const n=O(t),i=await n.getIdToken(e),r=qn(i);Sn(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Bn(Hn(r.auth_time)),issuedAtTime:Bn(Hn(r.iat)),expirationTime:Bn(Hn(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}function Hn(t){return 1e3*Number(t)}function qn(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return bn("JWT malformed, contained fewer than 3 sections"),null;try{const t=s(n);return t?JSON.parse(t):(bn("Failed to decode base64 JWT payload"),null)}catch(t){return bn("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function Kn(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof m&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Gn{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class Wn{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bn(this.lastLoginAt),this.creationTime=Bn(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Xn(t){var e;const n=t.auth,i=await t.getIdToken(),r=await Kn(t,async function(t,e){return xn(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Sn(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=yn(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,l=o,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const u=t.isAnonymous,h=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Wn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class Qn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Sn(t.idToken,"internal-error"),Sn(void 0!==t.idToken,"internal-error"),Sn(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=qn(t);return Sn(e,"internal-error"),Sn(void 0!==e.exp,"internal-error"),Sn(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Sn(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await Fn(t,{},(async()=>{const n=b({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=Vn(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Rn.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new Qn;return n&&(Sn("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(Sn("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(Sn("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Qn,this.toJSON())}_performRefresh(){return Cn("not implemented")}}function Jn(t,e){Sn("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Yn{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=yn(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Gn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Wn(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await Kn(this,this.stsTokenManager.getToken(this.auth,t));return Sn(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return zn(this,t)}reload(){return async function(t){const e=O(t);await Xn(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Sn(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Yn(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Sn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Xn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Kn(this,async function(t,e){return xn(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,l;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:b,stsTokenManager:E}=e;Sn(v&&E,t,"internal-error");const T=Qn.fromJSON(this.name,E);Sn("string"==typeof v,t,"internal-error"),Jn(u,t.name),Jn(h,t.name),Sn("boolean"==typeof w,t,"internal-error"),Sn("boolean"==typeof I,t,"internal-error"),Jn(d,t.name),Jn(f,t.name),Jn(p,t.name),Jn(g,t.name),Jn(m,t.name),Jn(y,t.name);const _=new Yn({uid:v,auth:t,email:h,emailVerified:w,displayName:u,isAnonymous:I,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(_.providerData=b.map((t=>Object.assign({},t)))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(t,e,n=!1){const i=new Qn;i.updateFromServerResponse(e);const r=new Yn({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await Xn(r),r}}const Zn=new Map;function ti(t){kn(t instanceof Function,"Expected a class definition");let e=Zn.get(t);return e?(kn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Zn.set(t,e),e)}class ei{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}ei.type="NONE";const ni=ei;function ii(t,e,n){return`firebase:${t}:${e}:${n}`}class ri{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=ii(this.userKey,i.apiKey,r),this.fullPersistenceKey=ii("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Yn._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new ri(ti(ni),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||ti(ni);const s=ii(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=Yn._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new ri(r,t,n)):new ri(r,t,n)}}function si(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(li(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(oi(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hi(e))return"Blackberry";if(di(e))return"Webos";if(ai(e))return"Safari";if((e.includes("chrome/")||ci(e))&&!e.includes("edge/"))return"Chrome";if(ui(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function oi(t=d()){return/firefox\//i.test(t)}function ai(t=d()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ci(t=d()){return/crios\//i.test(t)}function li(t=d()){return/iemobile/i.test(t)}function ui(t=d()){return/android/i.test(t)}function hi(t=d()){return/blackberry/i.test(t)}function di(t=d()){return/webos/i.test(t)}function fi(t=d()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function pi(t=d()){return fi(t)||ui(t)||di(t)||hi(t)||/windows phone/i.test(t)||li(t)}function gi(t,e=[]){let n;switch(t){case"Browser":n=si(d());break;case"Worker":n=`${si(d())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${It}/${i}`}async function mi(t,e){return xn(t,"GET","/v2/recaptchaConfig",Mn(t,e))}function yi(t){return void 0!==t&&void 0!==t.enterprise}class vi{constructor(t){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.emailPasswordEnabled=t.recaptchaEnforcementState.some((t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState))}}function wi(t){return new Promise(((e,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Tn("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}))}function Ii(t){return`__${t}${Math.floor(1e6*Math.random())}`}class bi{constructor(t){this.type="recaptcha-enterprise",this.auth=Si(t)}async verify(t="verify",e=!1){function n(e,n,i){const r=window.grecaptcha;yi(r)?r.enterprise.ready((()=>{r.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{mi(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new vi(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((r=>{if(!e&&yi(window.grecaptcha))n(r,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));wi("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function Ei(t,e,n,i=!1){const r=new bi(t);let s;try{s=await r.verify(n)}catch(t){s=await r.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class Ti{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class _i{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ci(this),this.idTokenSubscription=new Ci(this),this.beforeStateQueue=new Ti(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ti(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ri.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Sn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Xn(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?O(t):null;return e&&Sn(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Sn(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(ti(t))}))}async initializeRecaptchaConfig(){const t=await mi(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),e=new vi(t);null==this.tenantId?this._agentRecaptchaConfig=e:this._tenantRecaptchaConfigs[this.tenantId]=e,e.emailPasswordEnabled&&new bi(this).verify()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new y("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ti(t)||this._popupRedirectResolver;Sn(e,this,"argument-error"),this.redirectPersistenceManager=await ri.create(this,[ti(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Sn(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Sn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=gi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){In.logLevel<=F.WARN&&In.warn(`Auth (${It}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Si(t){return O(t)}class Ci{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new _(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Sn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function ki(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ai(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Di{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Cn("not implemented")}_getIdTokenResponse(t){return Cn("not implemented")}_linkToIdToken(t,e){return Cn("not implemented")}_getReauthenticationResolver(t){return Cn("not implemented")}}async function Ni(t,e){return Un(t,"POST","/v1/accounts:signInWithPassword",Mn(t,e))}class Oi extends Di{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Oi(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Oi(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){var e;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(e=t._getRecaptchaConfig())||void 0===e?void 0:e.emailPasswordEnabled){const e=await Ei(t,n,"signInWithPassword");return Ni(t,e)}return Ni(t,n).catch((async e=>{if("auth/missing-recaptcha-token"===e.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const e=await Ei(t,n,"signInWithPassword");return Ni(t,e)}return Promise.reject(e)}));case"emailLink":return async function(t,e){return Un(t,"POST","/v1/accounts:signInWithEmailLink",Mn(t,e))}(t,{email:this._email,oobCode:this._password});default:En(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return xn(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return Un(t,"POST","/v1/accounts:signInWithEmailLink",Mn(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:En(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Ri(t,e){return Un(t,"POST","/v1/accounts:signInWithIdp",Mn(t,e))}class Pi extends Di{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Pi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):En("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=yn(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Pi(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return Ri(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Ri(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Ri(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=b(e)}return t}}const Li={USER_NOT_FOUND:"user-not-found"};class Mi extends Di{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Mi({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Mi({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Un(t,"POST","/v1/accounts:signInWithPhoneNumber",Mn(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Un(t,"POST","/v1/accounts:signInWithPhoneNumber",Mn(t,e));if(n.temporaryProof)throw $n(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Un(t,"POST","/v1/accounts:signInWithPhoneNumber",Mn(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Li)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new Mi({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class xi{constructor(t){var e,n,i,r,s,o;const a=E(T(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Sn(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=E(T(t)).link,n=e?E(T(e)).deep_link_id:null,i=E(T(t)).deep_link_id;return(i?E(T(i)).link:null)||i||n||e||t}(t);try{return new xi(e)}catch(t){return null}}}class Fi{constructor(){this.providerId=Fi.PROVIDER_ID}static credential(t,e){return Oi._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=xi.parseLink(e);return Sn(n,"argument-error"),Oi._fromEmailAndCode(t,n.code,n.tenantId)}}Fi.PROVIDER_ID="password",Fi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Fi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ui{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Vi extends Ui{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class ji extends Vi{constructor(){super("facebook.com")}static credential(t){return Pi._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ji.credentialFromTaggedObject(t)}static credentialFromError(t){return ji.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ji.credential(t.oauthAccessToken)}catch(t){return null}}}ji.FACEBOOK_SIGN_IN_METHOD="facebook.com",ji.PROVIDER_ID="facebook.com";class $i extends Vi{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Pi._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return $i.credentialFromTaggedObject(t)}static credentialFromError(t){return $i.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return $i.credential(e,n)}catch(t){return null}}}$i.GOOGLE_SIGN_IN_METHOD="google.com",$i.PROVIDER_ID="google.com";class Bi extends Vi{constructor(){super("github.com")}static credential(t){return Pi._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Bi.credentialFromTaggedObject(t)}static credentialFromError(t){return Bi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Bi.credential(t.oauthAccessToken)}catch(t){return null}}}Bi.GITHUB_SIGN_IN_METHOD="github.com",Bi.PROVIDER_ID="github.com";class zi extends Vi{constructor(){super("twitter.com")}static credential(t,e){return Pi._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return zi.credentialFromTaggedObject(t)}static credentialFromError(t){return zi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return zi.credential(e,n)}catch(t){return null}}}async function Hi(t,e){return Un(t,"POST","/v1/accounts:signUp",Mn(t,e))}zi.TWITTER_SIGN_IN_METHOD="twitter.com",zi.PROVIDER_ID="twitter.com";class qi{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await Yn._fromIdTokenResponse(t,n,i),s=Ki(n);return new qi({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=Ki(n);return new qi({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function Ki(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Gi extends m{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Gi.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Gi(t,e,n,i)}}function Wi(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Gi._fromErrorAndOperation(t,n,e,i);throw n}))}function Xi(t){return O(t).signOut()}new WeakMap;const Qi="__sak";class Ji{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Qi,"1"),this.storage.removeItem(Qi),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Yi extends Ji{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=d();return ai(t)||fi(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=pi(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=d();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Yi.type="LOCAL";const Zi=Yi;class tr extends Ji{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}tr.type="SESSION";const er=tr;class nr{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new nr(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ir(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}nr.receivers=[];class rr{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=ir("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function sr(){return window}function or(){return void 0!==sr().WorkerGlobalScope&&"function"==typeof sr().importScripts}const ar="firebaseLocalStorageDb",cr="firebaseLocalStorage",lr="fbase_key";class ur{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function hr(t,e){return t.transaction([cr],e?"readwrite":"readonly").objectStore(cr)}function dr(){const t=indexedDB.open(ar,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(cr,{keyPath:lr})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(cr)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(ar);return new ur(t).toPromise()}(),e(await dr()))}))}))}async function fr(t,e,n){const i=hr(t,!0).put({[lr]:e,value:n});return new ur(i).toPromise()}function pr(t,e){const n=hr(t,!0).delete(e);return new ur(n).toPromise()}class gr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await dr()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return or()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nr._getInstance(or()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new rr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await dr();return await fr(t,Qi,"1"),await pr(t,Qi),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>fr(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=hr(t,!1).get(e),i=await new ur(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>pr(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=hr(t,!1).getAll();return new ur(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}gr.type="LOCAL";const mr=gr;Ii("rcb"),new Nn(3e4,6e4);class yr{constructor(t){this.providerId=yr.PROVIDER_ID,this.auth=Si(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(Sn("string"==typeof r,t,"argument-error"),Sn("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){Sn("enroll"===e.type,t,"internal-error");const n=await function(t,e){return xn(t,"POST","/v2/accounts/mfaEnrollment:start",Mn(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Sn("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Sn(n,t,"missing-multi-factor-info");const o=await function(t,e){return xn(t,"POST","/v2/accounts/mfaSignIn:start",Mn(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return xn(t,"POST","/v1/accounts:sendVerificationCode",Mn(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,O(e))}static credential(t,e){return Mi._fromVerification(t,e)}static credentialFromResult(t){const e=t;return yr.credentialFromTaggedObject(e)}static credentialFromError(t){return yr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Mi._fromTokenResponse(e,n):null}}yr.PROVIDER_ID="phone",yr.PHONE_SIGN_IN_METHOD="phone";class vr extends Di{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ri(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Ri(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Ri(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function wr(t){return async function(t,e,n=!1){const i="signIn",r=await Wi(t,i,e),s=await qi._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new vr(t),t.bypassAuthState)}function Ir(t){const{auth:e,user:n}=t;return Sn(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await Kn(t,Wi(i,r,e,t),n);Sn(s.idToken,i,"internal-error");const o=qn(s.idToken);Sn(o,i,"internal-error");const{sub:a}=o;return Sn(t.uid===a,i,"user-mismatch"),qi._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&En(i,"user-mismatch"),t}}(n,new vr(t),t.bypassAuthState)}async function br(t){const{auth:e,user:n}=t;return Sn(n,e,"internal-error"),async function(t,e,n=!1){const i=await Kn(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return qi._forOperation(t,"link",i)}(n,new vr(t),t.bypassAuthState)}class Er{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return wr;case"linkViaPopup":case"linkViaRedirect":return br;case"reauthViaPopup":case"reauthViaRedirect":return Ir;default:En(this.auth,"internal-error")}}resolve(t){kn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){kn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Tr=new Nn(2e3,1e4);class _r extends Er{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,_r.currentPopupAction&&_r.currentPopupAction.cancel(),_r.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Sn(t,this.auth,"internal-error"),t}async onExecution(){kn(1===this.filter.length,"Popup operations only handle one event");const t=ir();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Tn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Tn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Tn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Tr.get())};t()}}_r.currentPopupAction=null;const Sr="pendingRedirect",Cr=new Map;class kr extends Er{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Cr.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return ii(Sr,t.config.apiKey,t.name)}(e),i=function(t){return ti(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Cr.set(this.auth._key(),t)}return this.bypassAuthState||Cr.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ar(t,e){Cr.set(t._key(),e)}async function Dr(t,e,n=!1){const i=Si(t),r=function(t,e){return e?ti(e):(Sn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new kr(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Nr{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rr(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Rr(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Tn(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Or(t))}saveEventToCache(t){this.cachedEventUids.add(Or(t)),this.lastProcessedEventTime=Date.now()}}function Or(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Rr({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Pr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Lr=/^https?/;function Mr(t){const e=An(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Lr.test(n))return!1;if(Pr.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const xr=new Nn(3e4,6e4);function Fr(){const t=sr().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let Ur=null;function Vr(t){return Ur=Ur||function(t){return new Promise(((e,n)=>{var i,r,s;function o(){Fr(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fr(),n(Tn(t,"network-request-failed"))},timeout:xr.get()})}if(null===(r=null===(i=sr().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=sr().gapi)||void 0===s?void 0:s.load)){const e=Ii("iframefcb");return sr()[e]=()=>{gapi.load?o():n(Tn(t,"network-request-failed"))},wi(`https://apis.google.com/js/api.js?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw Ur=null,t}))}(t),Ur}const jr=new Nn(5e3,15e3),$r={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Br=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zr(t){const e=t.config;Sn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?On(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:It},r=Br.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${b(i).slice(1)}`}const Hr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class qr{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const Kr=encodeURIComponent("fac");async function Gr(t,e,n,i,r,s){Sn(t.config.authDomain,t,"auth-domain-config-required"),Sn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:It,eventId:r};if(e instanceof Ui){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof Vi){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const c=await t._getAppCheckToken(),l=c?`#${Kr}=${encodeURIComponent(c)}`:"";return`${function({config:t}){return t.emulator?On(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${b(a).slice(1)}${l}`}const Wr="webStorageSupport",Xr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=er,this._completeRedirectFn=Dr,this._overrideRedirectResult=Ar}async _openPopup(t,e,n,i){var r;return kn(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Hr),{width:i.toString(),height:r.toString(),top:s,left:o}),l=d().toLowerCase();n&&(a=ci(l)?"_blank":n),oi(l)&&(e=e||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=d()){var e;return fi(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new qr(null);const h=window.open(e||"",a,u);Sn(h,t,"popup-blocked");try{h.focus()}catch(t){}return new qr(h)}(t,await Gr(t,e,n,An(),i),ir())}async _openRedirect(t,e,n,i){return await this._originValidation(t),r=await Gr(t,e,n,An(),i),sr().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(kn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await Vr(t),n=sr().gapi;return Sn(n,t,"internal-error"),e.open({where:document.body,url:zr(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$r,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Tn(t,"network-request-failed"),s=sr().setTimeout((()=>{i(r)}),jr.get());function o(){sr().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new Nr(t);return e.register("authEvent",(e=>(Sn(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Wr,{type:Wr},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Wr];void 0!==r&&e(!!r),En(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return xn(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Mr(t))return}catch(t){}En(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return pi()||ai()||fi()}};var Qr="@firebase/auth",Jr="1.1.0";class Yr{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Sn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Zr=u("authIdTokenMaxAge")||300;let ts=null;function es(t=Et()){const e=yt(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=yt(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(w(n.getOptions(),null!=e?e:{}))return t;En(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Xr,persistence:[mr,Zi,er]}),i=u("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Zr)return;const i=null==e?void 0:e.token;ts!==i&&(ts=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){O(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){O(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=a("auth");return s&&function(t,e,n){const i=Si(t);Sn(i._canInitEmulator,i,"emulator-config-failed"),Sn(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=ki(e),{host:o,port:a}=function(t){const e=ki(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:Ai(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Ai(e)}}}(e),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}var ns;ns="Browser",mt(new R("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Sn(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:ns,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gi(ns)},c=new _i(n,i,r,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(ti);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),mt(new R("auth-internal",(t=>(t=>new Yr(t))(Si(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Tt(Qr,Jr,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(ns)),Tt(Qr,Jr,"esm2017");class is{constructor(t){this.message=t.message??document.createElement("div"),this.choices=t.choices??[],this.values=t.values??[],this.slideInDir=t.slideInDir??null,this.slideInDist=t.slideInDist??100,this.slideInDuration=t.slideInDuration??500,this.slideInTiming=t.slideInTiming??"ease",this.slideOutDir=t.slideOutDir??null,this.slideOutDist=t.slideOutDist??100,this.slideOutDuration=t.slideOutDuration??500,this.slideOutTiming=t.slideOutTiming??"ease",this.fadeIn=t.fadeIn??null,this.fadeInDuration=t.fadeInDuration??500,this.fadeInTiming=t.fadeInTiming??"ease",this.fadeOut=t.fadeOut??null,this.fadeOutDuration=t.fadeOutDuration??500,this.fadeOutTiming=t.fadeOutTiming??"ease",this.container=document.createElement("div"),this.blocking=t.blocking??!0,this.windowBackgroundColor=t.windowBackgroundColor??(this.blocking?"rgb(0, 0, 0, 0.5)":"transparent"),this.windowPadding=t.windowPadding??"2em",this.hideOnWindow=t.hideOnWindow??this.blocking,this.wrapper=document.createElement("div"),this.width=t.width??"auto",this.justify=t.justify??"center",this.align=t.align??"center",this.backgroundColor=t.backgroundColor??"#FFFFFF",this.messageColor=t.messageColor??"#5B5B5B",this.messageFontSize=t.messageFontSize??"inherit",this.messageFontWeight=t.messageFontWeight??"inherit",this.choiceColor=t.choiceColor??"#057AFB",this.choiceFontSize=t.choiceFontSize??"inherit",this.choiceFontWeight=t.choiceFontWeight??"inherit",this.borderRadius=t.borderRadius??"0.5em",this.shadow=t.shadow??"0 0 10px 1px rgba(0, 0, 0, 0.3)",this.padding=t.padding??"1em 2em",this.choicesBorderTop=t.choicesBorderTop??"1px solid #D5D5D5",this.justifyChoices=t.justifyChoices??"end",this.hideOnDialog=t.hideOnDialog??!this.blocking,this.timeout=t.timeout??null}show(){return new Promise(((t,e)=>{for(;this.wrapper.firstChild;)this.wrapper.removeChild(this.wrapper.firstChild);if(this.container.style.boxSizing="border-box",this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.justifyContent=this.justify,this.container.style.alignItems=this.align,this.container.style.position="fixed",this.container.style.top=0,this.container.style.left=0,this.container.style.zIndex=9999,this.container.style.width="100vw",this.container.style.height="100vh",this.container.style.padding=this.windowPadding,this.container.style.backgroundColor=this.windowBackgroundColor,this.blocking?this.container.style.pointerEvents="auto":this.container.style.pointerEvents="none",this.hideOnWindow&&this.container.addEventListener("click",(e=>{e.target===e.currentTarget&&(t(null),this.hide())})),this.wrapper.style.width=this.width,this.wrapper.style.backgroundColor=this.backgroundColor,this.wrapper.style.color=this.messageColor,this.wrapper.style.borderRadius=this.borderRadius,this.wrapper.style.boxShadow=this.shadow,this.wrapper.style.pointerEvents="auto",this.slideInDir)switch(this.slideInDir){case"down":this.wrapper.style.transform=`translateY(-${this.slideInDist}px)`;break;case"right":this.wrapper.style.transform=`translateX(-${this.slideInDist}px)`;break;case"up":this.wrapper.style.transform=`translateY(${this.slideInDist}px)`;break;case"left":this.wrapper.style.transform=`translateX(${this.slideInDist}px)`;break;default:this.wrapper.style.transform="transform(0px)"}this.fadeIn&&(this.wrapper.style.opacity=0),this.hideOnDialog&&this.wrapper.addEventListener("click",(()=>{t(null),this.hide()})),this.container.appendChild(this.wrapper);const n=document.createElement("div");if(n.style.padding=this.padding,"string"==typeof this.message?(n.textContent=this.message,n.style.fontSize=this.messageFontSize,n.style.fontWeight=this.messageFontWeight):n.appendChild(this.message),this.wrapper.appendChild(n),this.choices.length>0){const e=document.createElement("div");e.style.padding=this.padding,e.style.borderTop=this.choicesBorderTop,e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent=this.justifyChoices,this.choices.forEach(((n,i)=>{let r;"string"==typeof n?(r=document.createElement("p"),r.style.margin="0",r.textContent=n,r.style.fontSize=this.choiceFontSize,r.style.fontWeight=this.choiceFontWeight):r=n,"end"===this.justifyChoices&&(r.style.paddingLeft="1em"),"start"===this.justifyChoices&&(r.style.paddingRight="1em"),r.style.cursor="pointer",r.style.color=this.choiceColor,r.addEventListener("click",(()=>{t(this.values[i]),this.hide()})),e.appendChild(r)})),this.wrapper.appendChild(e)}document.body.appendChild(this.container);let i=null;this.slideInDir&&(i=`transform ${this.slideInDuration}ms ${this.slideInTiming}`,requestAnimationFrame((()=>{this.wrapper.style.transform="translate(0px)"}))),this.fadeIn&&(i?i+=`, opacity ${this.fadeInDuration}ms ${this.fadeInTiming}`:i=`, opacity ${this.fadeInDuration}ms ${this.fadeInTiming}`,requestAnimationFrame((()=>{this.wrapper.style.opacity=1}))),i&&(this.wrapper.style.transition=i),this.timeout&&setTimeout((()=>{t(null),this.hide()}),this.timeout)}))}hide(){let t=null;this.slideOutDir&&(t=`transform ${this.slideOutDuration}ms ${this.slideOutTiming}`,requestAnimationFrame((()=>{switch(this.slideOutDir){case"up":this.wrapper.style.transform=`translateY(-${this.slideOutDist}px)`;break;case"right":this.wrapper.style.transform=`translateX(${this.slideOutDist}px)`;break;case"down":this.wrapper.style.transform=`translateY(${this.slideOutDist}px)`;break;case"left":this.wrapper.style.transform=`translateX(-${this.slideOutDist}px)`;break;default:this.wrapper.style.transform="transform(0px)"}}))),this.fadeOut&&(t?t+=`, opacity ${this.fadeOutDuration}ms ${this.fadeOutTiming}`:t=`, opacity ${this.fadeOutDuration}ms ${this.fadeOutTiming}`,requestAnimationFrame((()=>{this.wrapper.style.opacity=0}))),t&&(this.wrapper.style.transition=t),this.slideOutDir||this.fadeOut?setTimeout((()=>{this.container.remove()}),Math.max(this.slideOutDir?this.slideOutDuration:0,this.fadeOut?this.fadeOutDuration:0)):this.container.remove()}static alert(t,e={}){return new is({message:t,choices:["Close"],values:[null],width:"auto",...e}).show()}static confirm(t,e={}){return new is({message:t,choices:["Cancel","OK"],values:[!1,!0],width:"400px",...e}).show()}static prompt(t,e={}){const n=document.createElement("div"),i=document.createElement("textarea");i.style.display="block",i.style.width="400px",i.style.marginTop="1em",i.style.fontSize="16px",n.append(t,i);const r=new is({message:n,choices:["Cancel","OK"],values:[null,()=>i.value],width:"auto",...e}),s=new Promise(((t,e)=>{i.addEventListener("keyup",(e=>{"Enter"==e.key&&(e.ctrlKey||e.metaKey)&&(t(i.value),r.hide())}))})),o=r.show().then((t=>t&&t()));return Promise.race([s,o])}static toastMessage(t,e={}){return new is({message:t,backgroundColor:"#61A1EA",messageColor:"#FFFFFF",messageFontSize:"14px",messageFontWeight:700,blocking:!1,justify:"end",align:"start",shadow:"0 0 10px 1px rgba(0, 0, 0, 0.2)",slideInDir:"down",slideInDist:150,slideOutDir:"right",slideOutDist:300,timeout:5e3,...e}).show()}static toastError(t,e={}){return new is({message:t,backgroundColor:"#E36868",messageColor:"#FFFFFF",messageFontSize:"14px",messageFontWeight:700,blocking:!1,justify:"end",align:"start",shadow:"0 0 10px 1px rgba(0, 0, 0, 0.2)",slideInDir:"down",slideInDist:150,slideOutDir:"right",slideOutDist:300,timeout:5e3,...e}).show()}}class rs{constructor(t,e=(()=>{}),...n){this.date=t,this.callback=()=>e(...n),this.time=this.date.getTime()-(new Date).getTime(),this.elements=[],this.interval=setInterval((()=>{this.update()}),500)}update(){this.time=this.date.getTime()-(new Date).getTime(),this.time<=0?this.finish():this.show()}show(){const t=this.time,e=Math.floor(t/864e5),n=t%864e5,i=Math.floor(n/36e5),r=t%36e5,s=Math.floor(r/6e4),o=t%6e4,a=Math.floor(o/1e3);for(const t of this.elements)t.textContent=e?`${e}:${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:i?`${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}attach(t){this.elements.push(t),this.show()}detach(t){const e=this.elements.indexOf(t);-1!==e&&(this.elements[e].textContent="",this.elements.splice(e,1),this.show())}cleanUp(){clearInterval(this.interval);for(let t=this.elements.length-1;t>=0;t--)this.detach(this.elements[t])}finish(){this.callback(),clearInterval(this.interval),this.time=0,this.show()}}const ss=es(mn),os=432e6;let as,cs,ls;window.addEventListener("storage",(t=>{"authExpiration"===t.key&&hs()})),window.addEventListener("DOMContentLoaded",(function(){!function(){if(ds("public",location.pathname))return;const t=document.createElement("div");t.id="siteWideLoadingScreen";const e=document.createElement("style");e.innerHTML="\n    #siteWideLoadingScreen {\n        top: 0;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        height: 100vh;\n        width: 100vw;\n        position: absolute;\n        background-color: white;\n        z-index: 9999;\n        display: flex;\n    }\n      \n    body.authorized > #siteWideLoadingScreen {\n        display: none;\n    }\n      \n    #siteWideLoadingScreen:before {\n        content: '';\n        display: block;\n        border: 20px solid white;\n        border-top: 20px solid #110D65;\n        border-radius: 50%;\n        width: 100px;\n        height: 100px;\n        animation: spin 2s linear infinite;\n        left: 0;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        margin: auto;\n        position: absolute;\n    }\n      \n    @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n    }\n    ",document.body.appendChild(e),document.body.appendChild(t),document.body.classList.remove("authorized")}();try{!function(t,e,n,i){O(t).onAuthStateChanged((async t=>{let e=location.pathname;if(t){if(!localStorage.getItem("authExpiration")||parseInt(localStorage.getItem("authExpiration"))<(new Date).getTime())return void fs(!0);const n=(await zn(t)).claims.role,i=new URLSearchParams(document.location.search).get("redirect");if(i)return void window.location.replace(location.origin+decodeURI(i));if(!ds(n,e))return void function(t,e){switch(t){case"public":default:window.location.replace(`${location.origin}/sign-in`);break;case"student":window.location.replace(`${location.origin}/test-taker/${e}`);break;case"parent":window.location.replace(`${location.origin}/Dashboard/Parent`);break;case"tutor":window.location.replace(`${location.origin}/Dashboard/Tutor`);break;case"admin":window.location.replace(`${location.origin}/Dashboard/Admin`);break;case"dev":window.location.replace(`${location.origin}/Dashboard/Dev`)}}(n,t.uid);localStorage.setItem("authExpiration",((new Date).getTime()+os).toString()),hs()}else if(!ds("public",e)){const t=encodeURI(e);return void window.location.replace(location.origin+"/sign-in?redirect="+t)}document.body.classList.add("authorized")}),void 0,void 0)}(ss)}catch(t){console.log(t),window.location.replace(location.origin+"/sign-in")}}));let us={all:["/","/free-test-taker","/pricing","/why","/careers","/sign-up"],public:["/sign-in"],student:["/Dashboard/Student","/test-taker/*"],parent:["/Dashboard/Parent","/test-taker/*"],tutor:["/Dashboard/Tutor","/new-assignment","/view-curriculum","/student-overview/*","/test-taker/*"],admin:["&student","&parent","&tutor","/Dashboard/Admin","/new-parent","/new-student","/new-tutor"],dev:["&student","&parent","&tutor","&admin","/Dashboard/Dev","/testEditor","/analytics"]};async function hs(){ls&&ls.hide(),as&&as.cleanUp(),cs&&cs.cleanUp();const t=localStorage.getItem("authExpiration")&&parseInt(localStorage.getItem("authExpiration"));as=new rs(new Date(t),(()=>{fs(!0)})),cs=new rs(new Date(t-3e5),(async()=>{const t=document.createElement("p");t.style.margin="0",t.textContent="Are you still there? You will be signed out in ";const e=document.createElement("span");as.attach(e),t.appendChild(e),ls=new is({message:t,choices:["YES","NO"],values:[!0,!1],timeout:as.time,slideInDir:"down",fadeIn:!0});const n=await ls.show();!0===n?(localStorage.setItem("authExpiration",((new Date).getTime()+os).toString()),hs()):!1===n&&(ls.hide(),localStorage.setItem("authExpiration",((new Date).getTime()+os).toString()),hs(),fs())}))}function ds(t,e){const n=[...us[t]??[],...us.all];for(const t of n){const n=t.split("/"),i=e.split("/");if(n.length>i.length)continue;let r=!0;for(let t=0;t<i.length;t++){if(t<n.length&&i[t]!==n[t]&&"*"!==n[t]&&"**"!==n[t]){r=!1;break}if(t>=n.length&&"**"!==n[n.length-1]){r=!1;break}}if(!0===r)return!0}return!1}async function fs(t=!1){if(t)await Xi(ss);else{const t=new is({message:"Are you sure you want to sign out?",choices:["YES","NO"],values:[!0,!1],slideInDir:"down",fadeIn:!0});await t.show()&&await Xi(ss)}}!function(){for(const t in us)us[t]=us[t].flatMap((t=>"&"===t.charAt(0)?us[t.slice(1)]:t))}();const ps="type.googleapis.com/google.protobuf.Int64Value",gs="type.googleapis.com/google.protobuf.UInt64Value";function ms(t,e){const n={};for(const i in t)t.hasOwnProperty(i)&&(n[i]=e(t[i]));return n}function ys(t){if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((t=>ys(t)));if("function"==typeof t||"object"==typeof t)return ms(t,(t=>ys(t)));throw new Error("Data cannot be encoded in JSON: "+t)}function vs(t){if(null==t)return t;if(t["@type"])switch(t["@type"]){case ps:case gs:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((t=>vs(t))):"function"==typeof t||"object"==typeof t?ms(t,(t=>vs(t))):t}const ws="functions",Is={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class bs extends m{constructor(t,e,n){super(`${ws}/${t}`,e||""),this.details=n}}class Es{constructor(t,e,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((t=>this.auth=t),(()=>{})),this.messaging||e.get().then((t=>this.messaging=t),(()=>{})),this.appCheck||n.get().then((t=>this.appCheck=t),(()=>{}))}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return null==t?void 0:t.accessToken}catch(t){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(t){return}}async getAppCheckToken(t){if(this.appCheck){const e=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(t){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(t)}}}const Ts="us-central1";class _s{constructor(t,e,n,i,r=Ts,s){this.app=t,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Es(e,n,i),this.cancelAllRequests=new Promise((t=>{this.deleteService=()=>Promise.resolve(t())}));try{const t=new URL(r);this.customDomain=t.origin,this.region=Ts}catch(t){this.customDomain=null,this.region=r}}_delete(){return this.deleteService()}_url(t){const e=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${e}/${this.region}/${t}`:null!==this.customDomain?`${this.customDomain}/${t}`:`https://${this.region}-${e}.cloudfunctions.net/${t}`}}function Ss(t,e,n){return i=>function(t,e,n,i){const r=t._url(e);return async function(t,e,n,i){const r={data:n=ys(n)},s={},o=await t.contextProvider.getContext(i.limitedUseAppCheckTokens);o.authToken&&(s.Authorization="Bearer "+o.authToken),o.messagingToken&&(s["Firebase-Instance-ID-Token"]=o.messagingToken),null!==o.appCheckToken&&(s["X-Firebase-AppCheck"]=o.appCheckToken);const a=function(t){let e=null;return{promise:new Promise(((n,i)=>{e=setTimeout((()=>{i(new bs("deadline-exceeded","deadline-exceeded"))}),t)})),cancel:()=>{e&&clearTimeout(e)}}}(i.timeout||7e4),c=await Promise.race([Cs(e,r,s,t.fetchImpl),a.promise,t.cancelAllRequests]);if(a.cancel(),!c)throw new bs("cancelled","Firebase Functions instance was deleted.");const l=function(t,e){let n,i=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),r=i;try{const t=e&&e.error;if(t){const e=t.status;if("string"==typeof e){if(!Is[e])return new bs("internal","internal");i=Is[e],r=e}const s=t.message;"string"==typeof s&&(r=s),n=t.details,void 0!==n&&(n=vs(n))}}catch(t){}return"ok"===i?null:new bs(i,r,n)}(c.status,c.json);if(l)throw l;if(!c.json)throw new bs("internal","Response is not valid JSON object.");let u=c.json.data;if(void 0===u&&(u=c.json.result),void 0===u)throw new bs("internal","Response is missing data field.");return{data:vs(u)}}(t,r,n,i)}(t,e,i,n||{})}async function Cs(t,e,n,i){let r;n["Content-Type"]="application/json";try{r=await i(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch(t){return{status:0,json:null}}let s=null;try{s=await r.json()}catch(t){}return{status:r.status,json:s}}const ks="@firebase/functions",As="0.10.0";var Ds;Ds=fetch.bind(self),mt(new R(ws,((t,{instanceIdentifier:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),r=t.getProvider("messaging-internal"),s=t.getProvider("app-check-internal");return new _s(n,i,r,s,e,Ds)}),"PUBLIC").setMultipleInstances(!0)),Tt(ks,As,void 0),Tt(ks,As,"esm2017");var Ns,Os="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Rs={},Ps=Ps||{},Ls=Os||self;function Ms(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function xs(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Fs="closure_uid_"+(1e9*Math.random()>>>0),Us=0;function Vs(t,e,n){return t.call.apply(t.bind,arguments)}function js(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function $s(t,e,n){return($s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Vs:js).apply(null,arguments)}function Bs(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function zs(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Hs(){this.s=this.s,this.o=this.o}Hs.prototype.s=!1,Hs.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Fs)&&t[Fs]||(t[Fs]=++Us))},Hs.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const qs=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Ks(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Gs(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Ms(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function Ws(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Ws.prototype.h=function(){this.defaultPrevented=!0};var Xs=function(){if(!Ls.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ls.addEventListener("test",(()=>{}),e),Ls.removeEventListener("test",(()=>{}),e)}catch(t){}return t}();function Qs(t){return/^[\s\xa0]*$/.test(t)}function Js(){var t=Ls.navigator;return t&&(t=t.userAgent)?t:""}function Ys(t){return-1!=Js().indexOf(t)}function Zs(t){return Zs[" "](t),t}Zs[" "]=function(){};var to,eo,no,io=Ys("Opera"),ro=Ys("Trident")||Ys("MSIE"),so=Ys("Edge"),oo=so||ro,ao=Ys("Gecko")&&!(-1!=Js().toLowerCase().indexOf("webkit")&&!Ys("Edge"))&&!(Ys("Trident")||Ys("MSIE"))&&!Ys("Edge"),co=-1!=Js().toLowerCase().indexOf("webkit")&&!Ys("Edge");function lo(){var t=Ls.document;return t?t.documentMode:void 0}t:{var uo="",ho=(eo=Js(),ao?/rv:([^\);]+)(\)|;)/.exec(eo):so?/Edge\/([\d\.]+)/.exec(eo):ro?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(eo):co?/WebKit\/(\S+)/.exec(eo):io?/(?:Version)[ \/]?(\S+)/.exec(eo):void 0);if(ho&&(uo=ho?ho[1]:""),ro){var fo=lo();if(null!=fo&&fo>parseFloat(uo)){to=String(fo);break t}}to=uo}Ls.document&&ro?no=lo()||parseInt(to,10)||void 0:no=void 0;var po=no;function go(t,e){if(Ws.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ao){t:{try{Zs(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:mo[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&go.$.h.call(this)}}zs(go,Ws);var mo={2:"touch",3:"pen",4:"mouse"};go.prototype.h=function(){go.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var yo="closure_listenable_"+(1e6*Math.random()|0),vo=0;function wo(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++vo,this.fa=this.ia=!1}function Io(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function bo(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function Eo(t){const e={};for(const n in t)e[n]=t[n];return e}const To="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _o(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<To.length;e++)n=To[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function So(t){this.src=t,this.g={},this.h=0}function Co(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=qs(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Io(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ko(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}So.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=ko(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new wo(e,this.src,s,!!i,r)).ia=n,t.push(e)),e};var Ao="closure_lm_"+(1e6*Math.random()|0),Do={};function No(t,e,n,i,r){if(i&&i.once)return Ro(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)No(t,e[s],n,i,r);return null}return n=Vo(n),t&&t[yo]?t.O(e,n,xs(i)?!!i.capture:!!i,r):Oo(t,e,n,!1,i,r)}function Oo(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=xs(r)?!!r.capture:!!r,a=Fo(t);if(a||(t[Ao]=a=new So(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=xo;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Xs||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Mo(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ro(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Ro(t,e[s],n,i,r);return null}return n=Vo(n),t&&t[yo]?t.P(e,n,xs(i)?!!i.capture:!!i,r):Oo(t,e,n,!0,i,r)}function Po(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Po(t,e[s],n,i,r);else i=xs(i)?!!i.capture:!!i,n=Vo(n),t&&t[yo]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=ko(s=t.g[e],n,i,r))&&(Io(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Fo(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ko(e,n,i,r)),(n=-1<t?e[t]:null)&&Lo(n))}function Lo(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[yo])Co(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Mo(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Fo(e))?(Co(n,t),0==n.h&&(n.src=null,e[Ao]=null)):Io(t)}}}function Mo(t){return t in Do?Do[t]:Do[t]="on"+t}function xo(t,e){if(t.fa)t=!0;else{e=new go(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Lo(t),t=n.call(i,e)}return t}function Fo(t){return(t=t[Ao])instanceof So?t:null}var Uo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vo(t){return"function"==typeof t?t:(t[Uo]||(t[Uo]=function(e){return t.handleEvent(e)}),t[Uo])}function jo(){Hs.call(this),this.i=new So(this),this.S=this,this.J=null}function $o(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new Ws(e,t);else if(e instanceof Ws)e.target=e.target||t;else{var r=e;_o(e=new Ws(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Bo(o,i,!0,e)&&r}if(r=Bo(o=e.g=t,i,!0,e)&&r,r=Bo(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Bo(o=e.g=n[s],i,!1,e)&&r}function Bo(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Co(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}zs(jo,Hs),jo.prototype[yo]=!0,jo.prototype.removeEventListener=function(t,e,n,i){Po(this,t,e,n,i)},jo.prototype.N=function(){if(jo.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Io(n[i]);delete e.g[t],e.h--}}this.J=null},jo.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},jo.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var zo=Ls.JSON.stringify;function Ho(){var t=Jo;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var qo=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Ko),(t=>t.reset()));class Ko{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Go(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Wo(t){Ls.setTimeout((()=>{throw t}),0)}let Xo,Qo=!1,Jo=new class{constructor(){this.h=this.g=null}add(t,e){const n=qo.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Yo=()=>{const t=Ls.Promise.resolve(void 0);Xo=()=>{t.then(Zo)}};var Zo=()=>{for(var t;t=Ho();){try{t.h.call(t.g)}catch(t){Wo(t)}var e=qo;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Qo=!1};function ta(t,e){jo.call(this),this.h=t||1,this.g=e||Ls,this.j=$s(this.qb,this),this.l=Date.now()}function ea(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function na(t,e,n){if("function"==typeof t)n&&(t=$s(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=$s(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ls.setTimeout(t,e||0)}function ia(t){t.g=na((()=>{t.g=null,t.i&&(t.i=!1,ia(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}zs(ta,jo),(Ns=ta.prototype).ga=!1,Ns.T=null,Ns.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),$o(this,"tick"),this.ga&&(ea(this),this.start()))}},Ns.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ns.N=function(){ta.$.N.call(this),ea(this),delete this.g};class ra extends Hs{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:ia(this)}N(){super.N(),this.g&&(Ls.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sa(t){Hs.call(this),this.h=t,this.g={}}zs(sa,Hs);var oa=[];function aa(t,e,n,i){Array.isArray(n)||(n&&(oa[0]=n.toString()),n=oa);for(var r=0;r<n.length;r++){var s=No(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function ca(t){bo(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Lo(t)}),t),t.g={}}function la(){this.g=!0}function ua(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return zo(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}sa.prototype.N=function(){sa.$.N.call(this),ca(this)},sa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},la.prototype.Ea=function(){this.g=!1},la.prototype.info=function(){};var ha={},da=null;function fa(){return da=da||new jo}function pa(t){Ws.call(this,ha.Ta,t)}function ga(t){const e=fa();$o(e,new pa(e))}function ma(t,e){Ws.call(this,ha.STAT_EVENT,t),this.stat=e}function ya(t){const e=fa();$o(e,new ma(e,t))}function va(t,e){Ws.call(this,ha.Ua,t),this.size=e}function wa(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ls.setTimeout((function(){t()}),e)}ha.Ta="serverreachability",zs(pa,Ws),ha.STAT_EVENT="statevent",zs(ma,Ws),ha.Ua="timingevent",zs(va,Ws);var Ia={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ba={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ea(){}function Ta(t){return t.h||(t.h=t.i())}function _a(){}Ea.prototype.h=null;var Sa,Ca={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ka(){Ws.call(this,"d")}function Aa(){Ws.call(this,"c")}function Da(){}function Na(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new sa(this),this.P=Ra,t=oo?125:void 0,this.V=new ta(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Oa}function Oa(){this.i=null,this.g="",this.h=!1}zs(ka,Ws),zs(Aa,Ws),zs(Da,Ea),Da.prototype.g=function(){return new XMLHttpRequest},Da.prototype.i=function(){return{}},Sa=new Da;var Ra=45e3,Pa={},La={};function Ma(t,e,n){t.L=1,t.v=tc(Xa(e)),t.s=n,t.S=!0,xa(t,null)}function xa(t,e){t.G=Date.now(),ja(t),t.A=Xa(t.v);var n=t.A,i=t.W;Array.isArray(i)||(i=[String(i)]),fc(n.i,"t",i),t.C=0,n=t.l.J,t.h=new Oa,t.g=dl(t.l,n?e:null,!t.s),0<t.O&&(t.M=new ra($s(t.Pa,t,t.g),t.O)),aa(t.U,t.g,"readystatechange",t.nb),e=t.I?Eo(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),ga(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.W,t.s)}function Fa(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.l.Ha}function Ua(t,e,n){let i,r=!0;for(;!t.J&&t.C<n.length;){if(i=Va(t,n),i==La){4==e&&(t.o=4,ya(14),r=!1),ua(t.j,t.m,null,"[Incomplete Response]");break}if(i==Pa){t.o=4,ya(15),ua(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}ua(t.j,t.m,i,null),qa(t,i)}Fa(t)&&i!=La&&i!=Pa&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ya(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),rl(e),e.M=!0,ya(11))):(ua(t.j,t.m,n,"[Invalid Chunked Response]"),Ha(t),za(t))}function Va(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?La:(n=Number(e.substring(n,i)),isNaN(n)?Pa:(i+=1)+n>e.length?La:(e=e.slice(i,i+n),t.C=i+n,e))}function ja(t){t.Y=Date.now()+t.P,$a(t,t.P)}function $a(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=wa($s(t.lb,t),e)}function Ba(t){t.B&&(Ls.clearTimeout(t.B),t.B=null)}function za(t){0==t.l.H||t.J||al(t.l,t)}function Ha(t){Ba(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,ea(t.V),ca(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function qa(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||wc(n.i,t)))if(!t.K&&wc(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;ol(n),Qc(n)}il(n),ya(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=wa($s(n.ib,n),6e3));if(1>=vc(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else ll(n,11)}else if((t.K||n.g==t)&&ol(n),!Qs(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=l[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Ic(s,s.h),s.h=null))}if(i.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,Za(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=hl(i,i.J?i.pa:null,i.Y),o.K){bc(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.B&&(Ba(a),ja(a)),i.g=o}else nl(i);0<n.j.length&&Yc(n)}else"stop"!=l[0]&&"close"!=l[0]||ll(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?ll(n,7):Xc(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}ga()}catch(t){}}function Ka(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ms(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Ms(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Ms(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(Ns=Na.prototype).setTimeout=function(t){this.P=t},Ns.nb=function(t){t=t.target;const e=this.M;e&&3==zc(t)?e.l():this.Pa(t)},Ns.Pa=function(t){try{if(t==this.g)t:{const u=zc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||oo||this.g&&(this.h.h||this.g.ja()||Hc(this.g)))){this.J||4!=u||7==e||ga(),Ba(this);var n=this.g.da();this.ca=n;e:if(Fa(this)){var i=Hc(this.g);t="";var r=i.length,s=4==zc(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ha(this),za(this);var o="";break e}this.h.i=new Ls.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Qs(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,ya(12),Ha(this),za(this);break t}ua(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qa(this,n)}this.S?(Ua(this,u,o),oo&&this.i&&3==u&&(aa(this.U,this.V,"tick",this.mb),this.V.start())):(ua(this.j,this.m,o,null),qa(this,o)),4==u&&Ha(this),this.i&&!this.J&&(4==u?al(this.l,this):(this.i=!1,ja(this)))}else(function(t){const e={};t=(t.g&&2<=zc(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(Qs(t[i]))continue;var n=Go(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ya(12)):(this.o=0,ya(13)),Ha(this),za(this)}}}catch(t){}},Ns.mb=function(){if(this.g){var t=zc(this.g),e=this.g.ja();this.C<e.length&&(Ba(this),Ua(this,t,e),this.i&&4!=t&&ja(this))}},Ns.cancel=function(){this.J=!0,Ha(this)},Ns.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.L&&(ga(),ya(17)),Ha(this),this.o=2,za(this)):$a(this,this.Y-t)};var Ga=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wa(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Wa){this.h=t.h,Qa(this,t.j),this.s=t.s,this.g=t.g,Ja(this,t.m),this.l=t.l;var e=t.i,n=new lc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Ya(this,n),this.o=t.o}else t&&(e=String(t).match(Ga))?(this.h=!1,Qa(this,e[1]||"",!0),this.s=ec(e[2]||""),this.g=ec(e[3]||"",!0),Ja(this,e[4]),this.l=ec(e[5]||"",!0),Ya(this,e[6]||"",!0),this.o=ec(e[7]||"")):(this.h=!1,this.i=new lc(null,this.h))}function Xa(t){return new Wa(t)}function Qa(t,e,n){t.j=n?ec(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ja(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ya(t,e,n){e instanceof lc?(t.i=e,function(t,e){e&&!t.j&&(uc(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(hc(this,e),fc(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=nc(e,ac)),t.i=new lc(e,t.h))}function Za(t,e,n){t.i.set(e,n)}function tc(t){return Za(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ec(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nc(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ic),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ic(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Wa.prototype.toString=function(){var t=[],e=this.j;e&&t.push(nc(e,rc,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(nc(e,rc,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(nc(n,"/"==n.charAt(0)?oc:sc,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",nc(n,cc)),t.join("")};var rc=/[#\/\?@]/g,sc=/[#\?:]/g,oc=/[#\?]/g,ac=/[#\?@]/g,cc=/#/g;function lc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function uc(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function hc(t,e){uc(t),e=pc(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function dc(t,e){return uc(t),e=pc(t,e),t.g.has(e)}function fc(t,e,n){hc(t,e),0<n.length&&(t.i=null,t.g.set(pc(t,e),Ks(n)),t.h+=n.length)}function pc(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function gc(t){this.l=t||mc,t=Ls.PerformanceNavigationTiming?0<(t=Ls.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ls.g&&Ls.g.Ka&&Ls.g.Ka()&&Ls.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Ns=lc.prototype).add=function(t,e){uc(this),this.i=null,t=pc(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ns.forEach=function(t,e){uc(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},Ns.ta=function(){uc(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},Ns.Z=function(t){uc(this);let e=[];if("string"==typeof t)dc(this,t)&&(e=e.concat(this.g.get(pc(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Ns.set=function(t,e){return uc(this),this.i=null,dc(this,t=pc(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ns.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Ns.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var mc=10;function yc(t){return!!t.h||!!t.g&&t.g.size>=t.j}function vc(t){return t.h?1:t.g?t.g.size:0}function wc(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ic(t,e){t.g?t.g.add(e):t.h=e}function bc(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ec(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Ks(t.i)}gc.prototype.cancel=function(){if(this.i=Ec(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Tc=class{stringify(t){return Ls.JSON.stringify(t,void 0)}parse(t){return Ls.JSON.parse(t,void 0)}};function _c(){this.g=new Tc}function Sc(t,e,n){const i=n||"";try{Ka(t,(function(t,n){let r=t;xs(t)&&(r=zo(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Cc(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function kc(t){this.l=t.fc||null,this.j=t.ob||!1}function Ac(t,e){jo.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Dc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zs(kc,Ea),kc.prototype.g=function(){return new Ac(this.l,this.j)},kc.prototype.i=function(t){return function(){return t}}({}),zs(Ac,jo);var Dc=0;function Nc(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Oc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Rc(t)}function Rc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ns=Ac.prototype).open=function(t,e){if(this.readyState!=Dc)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Rc(this)},Ns.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ls).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Ns.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Oc(this)),this.readyState=Dc},Ns.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Rc(this)),this.g&&(this.readyState=3,Rc(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Ls.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Nc(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Ns.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Oc(this):Rc(this),3==this.readyState&&Nc(this)}},Ns.Za=function(t){this.g&&(this.response=this.responseText=t,Oc(this))},Ns.Ya=function(t){this.g&&(this.response=t,Oc(this))},Ns.ka=function(){this.g&&Oc(this)},Ns.setRequestHeader=function(t,e){this.v.append(t,e)},Ns.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ns.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ac.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Pc=Ls.JSON.parse;function Lc(t){jo.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Mc,this.L=this.M=!1}zs(Lc,jo);var Mc="",xc=/^https?$/i,Fc=["POST","PUT"];function Uc(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Vc(t),$c(t)}function Vc(t){t.F||(t.F=!0,$o(t,"complete"),$o(t,"error"))}function jc(t){if(t.h&&void 0!==Ps&&(!t.C[1]||4!=zc(t)||2!=t.da()))if(t.v&&4==zc(t))na(t.La,0,t);else if($o(t,"readystatechange"),4==zc(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var r=String(t.I).match(Ga)[1]||null;!r&&Ls.self&&Ls.self.location&&(r=Ls.self.location.protocol.slice(0,-1)),i=!xc.test(r?r.toLowerCase():"")}n=i}if(n)$o(t,"complete"),$o(t,"success");else{t.m=6;try{var s=2<zc(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Vc(t)}}finally{$c(t)}}}function $c(t,e){if(t.g){Bc(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||$o(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Bc(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ls.clearTimeout(t.A),t.A=null)}function zc(t){return t.g?t.g.readyState:0}function Hc(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Mc:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qc(t){let e="";return bo(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Kc(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=qc(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Za(t,e,n))}function Gc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wc(t){this.Ga=0,this.j=[],this.l=new la,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Gc("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Gc("baseRetryDelayMs",5e3,t),this.hb=Gc("retryDelaySeedMs",1e4,t),this.eb=Gc("forwardChannelMaxRetries",2,t),this.xa=Gc("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new gc(t&&t.concurrentRequestLimit),this.Ja=new _c,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Xc(t){if(Jc(t),3==t.H){var e=t.W++,n=Xa(t.I);if(Za(n,"SID",t.K),Za(n,"RID",e),Za(n,"TYPE","terminate"),tl(t,n),(e=new Na(t,t.l,e)).L=2,e.v=tc(Xa(n)),n=!1,Ls.navigator&&Ls.navigator.sendBeacon)try{n=Ls.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&Ls.Image&&((new Image).src=e.v,n=!0),n||(e.g=dl(e.l,null),e.g.ha(e.v)),e.G=Date.now(),ja(e)}ul(t)}function Qc(t){t.g&&(rl(t),t.g.cancel(),t.g=null)}function Jc(t){Qc(t),t.u&&(Ls.clearTimeout(t.u),t.u=null),ol(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ls.clearTimeout(t.m),t.m=null)}function Yc(t){if(!yc(t.i)&&!t.m){t.m=!0;var e=t.Na;Xo||Yo(),Qo||(Xo(),Qo=!0),Jo.add(e,t),t.C=0}}function Zc(t,e){var n;n=e?e.m:t.W++;const i=Xa(t.I);Za(i,"SID",t.K),Za(i,"RID",n),Za(i,"AID",t.V),tl(t,i),t.o&&t.s&&Kc(i,t.o,t.s),n=new Na(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=el(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Ic(t.i,n),Ma(n,i,e)}function tl(t,e){t.na&&bo(t.na,(function(t,n){Za(e,n,t)})),t.h&&Ka({},(function(t,n){Za(e,n,t)}))}function el(t,e,n){n=Math.min(t.j.length,n);var i=t.h?$s(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{Sc(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function nl(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Xo||Yo(),Qo||(Xo(),Qo=!0),Jo.add(e,t),t.A=0}}function il(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=wa($s(t.Ma,t),cl(t,t.A)),t.A++,0))}function rl(t){null!=t.B&&(Ls.clearTimeout(t.B),t.B=null)}function sl(t){t.g=new Na(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Xa(t.wa);Za(e,"RID","rpc"),Za(e,"SID",t.K),Za(e,"AID",t.V),Za(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Za(e,"TO",t.qa),Za(e,"TYPE","xmlhttp"),tl(t,e),t.o&&t.s&&Kc(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=tc(Xa(e)),n.s=null,n.S=!0,xa(n,t)}function ol(t){null!=t.v&&(Ls.clearTimeout(t.v),t.v=null)}function al(t,e){var n=null;if(t.g==e){ol(t),rl(t),t.g=null;var i=2}else{if(!wc(t.i,e))return;n=e.F,bc(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.G;var r=t.C;$o(i=fa(),new va(i,n)),Yc(t)}else nl(t);else if(3==(r=e.o)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(vc(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=wa($s(t.Na,t,e),cl(t,t.C)),t.C++,0)))}(t,e)||2==i&&il(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ll(t,5);break;case 4:ll(t,10);break;case 3:ll(t,6);break;default:ll(t,2)}}function cl(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ll(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=$s(t.pb,t);n||(n=new Wa("//www.google.com/images/cleardot.gif"),Ls.location&&"http"==Ls.location.protocol||Qa(n,"https"),tc(n)),function(t,e){const n=new la;if(Ls.Image){const i=new Image;i.onload=Bs(Cc,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Bs(Cc,n,i,"TestLoadImage: error",!1,e),i.onabort=Bs(Cc,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Bs(Cc,n,i,"TestLoadImage: timeout",!1,e),Ls.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else ya(2);t.H=0,t.h&&t.h.za(e),ul(t),Jc(t)}function ul(t){if(t.H=0,t.ma=[],t.h){const e=Ec(t.i);0==e.length&&0==t.j.length||(Gs(t.ma,e),Gs(t.ma,t.j),t.i.i.length=0,Ks(t.j),t.j.length=0),t.h.ya()}}function hl(t,e,n){var i=n instanceof Wa?Xa(n):new Wa(n);if(""!=i.g)e&&(i.g=e+"."+i.g),Ja(i,i.m);else{var r=Ls.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Wa(null);i&&Qa(s,i),e&&(s.g=e),r&&Ja(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&Za(i,n,e),Za(i,"VER",t.ra),tl(t,i),i}function dl(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ha&&!t.va?new Lc(new kc({ob:!0})):new Lc(t.va)).Oa(t.J),e}function fl(){}function pl(){if(ro&&!(10<=Number(po)))throw Error("Environmental error: no available transport.")}function gl(t,e){jo.call(this),this.g=new Wc(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Qs(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Qs(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new vl(this)}function ml(t){ka.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function yl(){Aa.call(this),this.status=1}function vl(t){this.g=t}function wl(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Il(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function bl(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}(Ns=Lc.prototype).Oa=function(t){this.M=t},Ns.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Sa.g(),this.C=this.u?Ta(this.u):Ta(Sa),this.g.onreadystatechange=$s(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Uc(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=Ls.FormData&&t instanceof Ls.FormData,!(0<=qs(Fc,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Bc(this),0<this.B&&((this.L=function(t){return ro&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=$s(this.ua,this)):this.A=na(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Uc(this,t)}},Ns.ua=function(){void 0!==Ps&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$o(this,"timeout"),this.abort(8))},Ns.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,$o(this,"complete"),$o(this,"abort"),$c(this))},Ns.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),$c(this,!0)),Lc.$.N.call(this)},Ns.La=function(){this.s||(this.G||this.v||this.l?jc(this):this.kb())},Ns.kb=function(){jc(this)},Ns.isActive=function(){return!!this.g},Ns.da=function(){try{return 2<zc(this)?this.g.status:-1}catch(t){return-1}},Ns.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ns.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pc(e)}},Ns.Ia=function(){return this.m},Ns.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ns=Wc.prototype).ra=8,Ns.H=1,Ns.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new Na(this,this.l,t);let s=this.s;if(this.U&&(s?(s=Eo(s),_o(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=el(this,r,e),Za(n=Xa(this.I),"RID",t),Za(n,"CVER",22),this.F&&Za(n,"X-HTTP-Session-Id",this.F),tl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(qc(s)))+"&"+e:this.o&&Kc(n,this.o,s)),Ic(this.i,r),this.bb&&Za(n,"TYPE","init"),this.P?(Za(n,"$req",e),Za(n,"SID","null"),r.aa=!0,Ma(r,n,null)):Ma(r,n,e),this.H=2}}else 3==this.H&&(t?Zc(this,t):0==this.j.length||yc(this.i)||Zc(this))},Ns.Ma=function(){if(this.u=null,sl(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=wa($s(this.jb,this),t)}},Ns.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ya(10),Qc(this),sl(this))},Ns.ib=function(){null!=this.v&&(this.v=null,Qc(this),il(this),ya(19))},Ns.pb=function(t){t?(this.l.info("Successfully pinged google.com"),ya(2)):(this.l.info("Failed to ping google.com"),ya(1))},Ns.isActive=function(){return!!this.h&&this.h.isActive(this)},(Ns=fl.prototype).Ba=function(){},Ns.Aa=function(){},Ns.za=function(){},Ns.ya=function(){},Ns.isActive=function(){return!0},Ns.Va=function(){},pl.prototype.g=function(t,e){return new gl(t,e)},zs(gl,jo),gl.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;ya(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=hl(t,null,t.Y),Yc(t)},gl.prototype.close=function(){Xc(this.g)},gl.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=zo(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&Yc(e)},gl.prototype.N=function(){this.g.h=null,delete this.j,Xc(this.g),delete this.g,gl.$.N.call(this)},zs(ml,ka),zs(yl,Aa),zs(vl,fl),vl.prototype.Ba=function(){$o(this.g,"a")},vl.prototype.Aa=function(t){$o(this.g,new ml(t))},vl.prototype.za=function(t){$o(this.g,new yl)},vl.prototype.ya=function(){$o(this.g,"b")},zs(wl,(function(){this.blockSize=-1})),wl.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},wl.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=n;)Il(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){Il(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){Il(this,i),r=0;break}}this.h=r,this.i+=e},wl.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var El={};function Tl(t){return-128<=t&&128>t?function(t,e){var n=El;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new bl([0|t],0>t?-1:0)}(t)}(t):new bl([0|t],0>t?-1:0)}function _l(t){if(isNaN(t)||!isFinite(t))return Cl;if(0>t)return Ol(_l(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Sl;return new bl(e,0)}var Sl=4294967296,Cl=Tl(0),kl=Tl(1),Al=Tl(16777216);function Dl(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Nl(t){return-1==t.h}function Ol(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new bl(n,~t.h).add(kl)}function Rl(t,e){return t.add(Ol(e))}function Pl(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ll(t,e){this.g=t,this.h=e}function Ml(t,e){if(Dl(e))throw Error("division by zero");if(Dl(t))return new Ll(Cl,Cl);if(Nl(t))return e=Ml(Ol(t),e),new Ll(Ol(e.g),Ol(e.h));if(Nl(e))return e=Ml(t,Ol(e)),new Ll(Ol(e.g),e.h);if(30<t.g.length){if(Nl(t)||Nl(e))throw Error("slowDivide_ only works with positive integers.");for(var n=kl,i=e;0>=i.X(t);)n=xl(n),i=xl(i);var r=Fl(n,1),s=Fl(i,1);for(i=Fl(i,2),n=Fl(n,2);!Dl(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=Fl(i,1),n=Fl(n,1)}return e=Rl(t,r.R(e)),new Ll(r,e)}for(r=Cl;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=_l(n)).R(e);Nl(o)||0<o.X(t);)o=(s=_l(n-=i)).R(e);Dl(s)&&(s=kl),r=r.add(s),t=Rl(t,o)}return new Ll(r,t)}function xl(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new bl(n,t.h)}function Fl(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new bl(r,t.h)}(Ns=bl.prototype).ea=function(){if(Nl(this))return-Ol(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Sl+i)*e,e*=Sl}return t},Ns.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Dl(this))return"0";if(Nl(this))return"-"+Ol(this).toString(t);for(var e=_l(Math.pow(t,6)),n=this,i="";;){var r=Ml(n,e).g,s=((0<(n=Rl(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Dl(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},Ns.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Ns.X=function(t){return Nl(t=Rl(this,t))?-1:Dl(t)?0:1},Ns.abs=function(){return Nl(this)?Ol(this):this},Ns.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new bl(n,-2147483648&n[n.length-1]?-1:0)},Ns.R=function(t){if(Dl(this)||Dl(t))return Cl;if(Nl(this))return Nl(t)?Ol(this).R(Ol(t)):Ol(Ol(this).R(t));if(Nl(t))return Ol(this.R(Ol(t)));if(0>this.X(Al)&&0>t.X(Al))return _l(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=t.D(r)>>>16,c=65535&t.D(r);n[2*i+2*r]+=o*c,Pl(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Pl(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Pl(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Pl(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new bl(n,0)},Ns.gb=function(t){return Ml(this,t).h},Ns.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new bl(n,this.h&t.h)},Ns.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new bl(n,this.h|t.h)},Ns.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new bl(n,this.h^t.h)},pl.prototype.createWebChannel=pl.prototype.g,gl.prototype.send=gl.prototype.u,gl.prototype.open=gl.prototype.m,gl.prototype.close=gl.prototype.close,Ia.NO_ERROR=0,Ia.TIMEOUT=8,Ia.HTTP_ERROR=6,ba.COMPLETE="complete",_a.EventType=Ca,Ca.OPEN="a",Ca.CLOSE="b",Ca.ERROR="c",Ca.MESSAGE="d",jo.prototype.listen=jo.prototype.O,Lc.prototype.listenOnce=Lc.prototype.P,Lc.prototype.getLastError=Lc.prototype.Sa,Lc.prototype.getLastErrorCode=Lc.prototype.Ia,Lc.prototype.getStatus=Lc.prototype.da,Lc.prototype.getResponseJson=Lc.prototype.Wa,Lc.prototype.getResponseText=Lc.prototype.ja,Lc.prototype.send=Lc.prototype.ha,Lc.prototype.setWithCredentials=Lc.prototype.Oa,wl.prototype.digest=wl.prototype.l,wl.prototype.reset=wl.prototype.reset,wl.prototype.update=wl.prototype.j,bl.prototype.add=bl.prototype.add,bl.prototype.multiply=bl.prototype.R,bl.prototype.modulo=bl.prototype.gb,bl.prototype.compare=bl.prototype.X,bl.prototype.toNumber=bl.prototype.ea,bl.prototype.toString=bl.prototype.toString,bl.prototype.getBits=bl.prototype.D,bl.fromNumber=_l,bl.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Ol(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=_l(Math.pow(n,8)),r=Cl,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=_l(Math.pow(n,o)),r=r.R(o).add(_l(a))):r=(r=r.R(i)).add(_l(a))}return r};var Ul=Rs.createWebChannelTransport=function(){return new pl},Vl=Rs.getStatEventTarget=function(){return fa()},jl=Rs.ErrorCode=Ia,$l=Rs.EventType=ba,Bl=Rs.Event=ha,zl=Rs.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Hl=Rs.FetchXmlHttpFactory=kc,ql=Rs.WebChannel=_a,Kl=Rs.XhrIo=Lc,Gl=(Rs.Md5=wl,Rs.Integer=bl);const Wl="@firebase/firestore";class Xl{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xl.UNAUTHENTICATED=new Xl(null),Xl.GOOGLE_CREDENTIALS=new Xl("google-credentials-uid"),Xl.FIRST_PARTY=new Xl("first-party-uid"),Xl.MOCK_USER=new Xl("mock-user");let Ql="10.1.0";const Jl=new z("@firebase/firestore");function Yl(){return Jl.logLevel}function Zl(t,...e){if(Jl.logLevel<=F.DEBUG){const n=e.map(nu);Jl.debug(`Firestore (${Ql}): ${t}`,...n)}}function tu(t,...e){if(Jl.logLevel<=F.ERROR){const n=e.map(nu);Jl.error(`Firestore (${Ql}): ${t}`,...n)}}function eu(t,...e){if(Jl.logLevel<=F.WARN){const n=e.map(nu);Jl.warn(`Firestore (${Ql}): ${t}`,...n)}}function nu(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function iu(t="Unexpected state"){const e=`FIRESTORE (${Ql}) INTERNAL ASSERTION FAILED: `+t;throw tu(e),new Error(e)}function ru(t,e){t||iu()}function su(t,e){return t}const ou={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class au extends m{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class cu{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class lu{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class uu{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Xl.UNAUTHENTICATED)))}shutdown(){}}class hu{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class du{constructor(t){this.t=t,this.currentUser=Xl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new cu;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new cu,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Zl("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Zl("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new cu)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Zl("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(ru("string"==typeof e.accessToken),new lu(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return ru(null===t||"string"==typeof t),new Xl(t)}}class fu{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=Xl.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class pu{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new fu(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(Xl.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gu{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mu{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&Zl("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,Zl("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Zl("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):Zl("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(ru("string"==typeof t.token),this.R=t.token,new gu(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function yu(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class vu{static V(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=yu(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function wu(t,e){return t<e?-1:t>e?1:0}function Iu(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class bu{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new au(ou.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new au(ou.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new au(ou.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new au(ou.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return bu.fromMillis(Date.now())}static fromDate(t){return bu.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new bu(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?wu(this.nanoseconds,t.nanoseconds):wu(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Eu{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Eu(t)}static min(){return new Eu(new bu(0,0))}static max(){return new Eu(new bu(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Tu{constructor(t,e,n){void 0===e?e=0:e>t.length&&iu(),void 0===n?n=t.length-e:n>t.length-e&&iu(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Tu.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Tu?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class _u extends Tu{construct(t,e,n){return new _u(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new au(ou.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new _u(e)}static emptyPath(){return new _u([])}}const Su=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cu extends Tu{construct(t,e,n){return new Cu(t,e,n)}static isValidIdentifier(t){return Su.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cu.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Cu(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new au(ou.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new au(ou.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new au(ou.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new au(ou.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Cu(e)}static emptyPath(){return new Cu([])}}class ku{constructor(t){this.path=t}static fromPath(t){return new ku(_u.fromString(t))}static fromName(t){return new ku(_u.fromString(t).popFirst(5))}static empty(){return new ku(_u.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===_u.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return _u.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new ku(new _u(t.slice()))}}function Au(t){return new Du(t.readTime,t.key,-1)}class Du{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Du(Eu.min(),ku.empty(),-1)}static max(){return new Du(Eu.max(),ku.empty(),-1)}}function Nu(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=ku.comparator(t.documentKey,e.documentKey),0!==n?n:wu(t.largestBatchId,e.largestBatchId))}const Ou="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ru{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Pu(t){if(t.code!==ou.FAILED_PRECONDITION||t.message!==Ou)throw t;Zl("LocalStore","Unexpectedly lost primary lease")}class Lu{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&iu(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Lu(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Lu?e:Lu.resolve(e)}catch(t){return Lu.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Lu.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Lu.reject(e)}static resolve(t){return new Lu(((e,n)=>{e(t)}))}static reject(t){return new Lu(((e,n)=>{n(t)}))}static waitFor(t){return new Lu(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Lu.resolve(!1);for(const n of t)e=e.next((t=>t?Lu.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Lu(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next((t=>{s[c]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new Lu(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}function Mu(t){return"IndexedDbTransactionError"===t.name}class xu{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.oe(t),this._e=t=>e.writeSequenceNumber(t))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}function Fu(t){return null==t}function Uu(t){return 0===t&&1/t==-1/0}xu.ae=-1;function Vu(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ju(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $u(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Bu{constructor(t,e){this.comparator=t,this.root=e||Hu.EMPTY}insert(t,e){return new Bu(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Hu.BLACK,null,null))}remove(t){return new Bu(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Hu.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new zu(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new zu(this.root,t,this.comparator,!1)}getReverseIterator(){return new zu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new zu(this.root,t,this.comparator,!0)}}class zu{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Hu{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Hu.RED,this.left=null!=i?i:Hu.EMPTY,this.right=null!=r?r:Hu.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new Hu(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Hu.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Hu.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Hu.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Hu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw iu();if(this.right.isRed())throw iu();const t=this.left.check();if(t!==this.right.check())throw iu();return t+(this.isRed()?0:1)}}Hu.EMPTY=null,Hu.RED=!0,Hu.BLACK=!1,Hu.EMPTY=new class{constructor(){this.size=0}get key(){throw iu()}get value(){throw iu()}get color(){throw iu()}get left(){throw iu()}get right(){throw iu()}copy(t,e,n,i,r){return this}insert(t,e,n){return new Hu(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class qu{constructor(t){this.comparator=t,this.data=new Bu(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Ku(this.data.getIterator())}getIteratorFrom(t){return new Ku(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof qu))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new qu(this.comparator);return e.data=t,e}}class Ku{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Gu{constructor(t){this.fields=t,t.sort(Cu.comparator)}static empty(){return new Gu([])}unionWith(t){let e=new qu(Cu.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Gu(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Iu(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Wu extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xu{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Wu("Invalid base64 string: "+t):t}}(t);return new Xu(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Xu(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return wu(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Xu.EMPTY_BYTE_STRING=new Xu("");const Qu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ju(t){if(ru(!!t),"string"==typeof t){let e=0;const n=Qu.exec(t);if(ru(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Yu(t.seconds),nanos:Yu(t.nanos)}}function Yu(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Zu(t){return"string"==typeof t?Xu.fromBase64String(t):Xu.fromUint8Array(t)}function th(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function eh(t){const e=t.mapValue.fields.__previous_value__;return th(e)?eh(e):e}function nh(t){const e=Ju(t.mapValue.fields.__local_write_time__.timestampValue);return new bu(e.seconds,e.nanos)}class ih{constructor(t,e,n,i,r,s,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class rh{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new rh("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof rh&&t.projectId===this.projectId&&t.database===this.database}}const sh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function oh(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?th(t)?4:yh(t)?9007199254740991:10:iu()}function ah(t,e){if(t===e)return!0;const n=oh(t);if(n!==oh(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return nh(t).isEqual(nh(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Ju(t.timestampValue),i=Ju(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Zu(t.bytesValue).isEqual(Zu(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Yu(t.geoPointValue.latitude)===Yu(e.geoPointValue.latitude)&&Yu(t.geoPointValue.longitude)===Yu(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Yu(t.integerValue)===Yu(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Yu(t.doubleValue),i=Yu(e.doubleValue);return n===i?Uu(n)===Uu(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Iu(t.arrayValue.values||[],e.arrayValue.values||[],ah);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Vu(n)!==Vu(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!ah(n[t],i[t])))return!1;return!0}(t,e);default:return iu()}}function ch(t,e){return void 0!==(t.values||[]).find((t=>ah(t,e)))}function lh(t,e){if(t===e)return 0;const n=oh(t),i=oh(e);if(n!==i)return wu(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return wu(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Yu(t.integerValue||t.doubleValue),i=Yu(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return uh(t.timestampValue,e.timestampValue);case 4:return uh(nh(t),nh(e));case 5:return wu(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Zu(t),i=Zu(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=wu(n[t],i[t]);if(0!==e)return e}return wu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=wu(Yu(t.latitude),Yu(e.latitude));return 0!==n?n:wu(Yu(t.longitude),Yu(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=lh(n[t],i[t]);if(e)return e}return wu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===sh.mapValue&&e===sh.mapValue)return 0;if(t===sh.mapValue)return 1;if(e===sh.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=wu(i[t],s[t]);if(0!==e)return e;const o=lh(n[i[t]],r[s[t]]);if(0!==o)return o}return wu(i.length,s.length)}(t.mapValue,e.mapValue);default:throw iu()}}function uh(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return wu(t,e);const n=Ju(t),i=Ju(e),r=wu(n.seconds,i.seconds);return 0!==r?r:wu(n.nanos,i.nanos)}function hh(t){return dh(t)}function dh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Ju(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Zu(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return ku.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=dh(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${dh(t.fields[r])}`;return n+"}"}(t.mapValue):iu()}function fh(t){return!!t&&"integerValue"in t}function ph(t){return!!t&&"arrayValue"in t}function gh(t){return!!t&&"mapValue"in t}function mh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ju(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=mh(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=mh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function yh(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class vh{constructor(t){this.value=t}static empty(){return new vh({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!gh(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=mh(e)}setAll(t){let e=Cu.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=mh(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());gh(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ah(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];gh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){ju(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new vh(mh(this.value))}}function wh(t){const e=[];return ju(t.fields,((t,n)=>{const i=new Cu([t]);if(gh(n)){const t=wh(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Gu(e)}class Ih{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new Ih(t,0,Eu.min(),Eu.min(),Eu.min(),vh.empty(),0)}static newFoundDocument(t,e,n,i){return new Ih(t,1,e,Eu.min(),n,i,0)}static newNoDocument(t,e){return new Ih(t,2,e,Eu.min(),Eu.min(),vh.empty(),0)}static newUnknownDocument(t,e){return new Ih(t,3,e,Eu.min(),Eu.min(),vh.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Eu.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=vh.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=vh.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Eu.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ih&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ih(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class bh{constructor(t,e){this.position=t,this.inclusive=e}}function Eh(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?ku.comparator(ku.fromName(o.referenceValue),n.key):lh(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Th(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ah(t.position[n],e.position[n]))return!1;return!0}class _h{constructor(t,e="asc"){this.field=t,this.dir=e}}function Sh(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Ch{}class kh extends Ch{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Lh(t,e,n):"array-contains"===e?new Uh(t,n):"in"===e?new Vh(t,n):"not-in"===e?new jh(t,n):"array-contains-any"===e?new $h(t,n):new kh(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Mh(t,n):new xh(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(lh(e,this.value)):null!==e&&oh(this.value)===oh(e)&&this.matchesComparison(lh(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return iu()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Ah extends Ch{constructor(t,e){super(),this.filters=t,this.op=e,this.ce=null}static create(t,e){return new Ah(t,e)}matches(t){return Dh(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.le((t=>t.isInequality()));return null!==t?t.field:null}le(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function Dh(t){return"and"===t.op}function Nh(t){return function(t){for(const e of t.filters)if(e instanceof Ah)return!1;return!0}(t)&&Dh(t)}function Oh(t){if(t instanceof kh)return t.field.canonicalString()+t.op.toString()+hh(t.value);if(Nh(t))return t.filters.map((t=>Oh(t))).join(",");{const e=t.filters.map((t=>Oh(t))).join(",");return`${t.op}(${e})`}}function Rh(t,e){return t instanceof kh?function(t,e){return e instanceof kh&&t.op===e.op&&t.field.isEqual(e.field)&&ah(t.value,e.value)}(t,e):t instanceof Ah?function(t,e){return e instanceof Ah&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Rh(n,e.filters[i])),!0)}(t,e):void iu()}function Ph(t){return t instanceof kh?function(t){return`${t.field.canonicalString()} ${t.op} ${hh(t.value)}`}(t):t instanceof Ah?function(t){return t.op.toString()+" {"+t.getFilters().map(Ph).join(" ,")+"}"}(t):"Filter"}class Lh extends kh{constructor(t,e,n){super(t,e,n),this.key=ku.fromName(n.referenceValue)}matches(t){const e=ku.comparator(t.key,this.key);return this.matchesComparison(e)}}class Mh extends kh{constructor(t,e){super(t,"in",e),this.keys=Fh(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class xh extends kh{constructor(t,e){super(t,"not-in",e),this.keys=Fh(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Fh(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>ku.fromName(t.referenceValue)))}class Uh extends kh{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ph(e)&&ch(e.arrayValue,this.value)}}class Vh extends kh{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&ch(this.value.arrayValue,e)}}class jh extends kh{constructor(t,e){super(t,"not-in",e)}matches(t){if(ch(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!ch(this.value.arrayValue,e)}}class $h extends kh{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ph(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>ch(this.value.arrayValue,t)))}}class Bh{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.he=null}}function zh(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Bh(t,e,n,i,r,s,o)}function Hh(t){const e=su(t);if(null===e.he){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Oh(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Fu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>hh(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>hh(t))).join(",")),e.he=t}return e.he}function qh(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Sh(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Rh(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Th(t.startAt,e.startAt)&&Th(t.endAt,e.endAt)}class Kh{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.Pe=null,this.Ie=null,this.startAt,this.endAt}}function Gh(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Wh(t){const e=su(t);if(null===e.Pe){e.Pe=[];const t=function(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.Pe.push(new _h(t)),e.Pe.push(new _h(Cu.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.Pe.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new _h(Cu.keyField(),t))}}}return e.Pe}function Xh(t){const e=su(t);if(!e.Ie)if("F"===e.limitType)e.Ie=zh(e.path,e.collectionGroup,Wh(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Wh(e)){const e="desc"===n.dir?"asc":"desc";t.push(new _h(n.field,e))}const n=e.endAt?new bh(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new bh(e.startAt.position,e.startAt.inclusive):null;e.Ie=zh(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.Ie}function Qh(t,e,n){return new Kh(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Jh(t,e){return qh(Xh(t),Xh(e))&&t.limitType===e.limitType}function Yh(t){return`${Hh(Xh(t))}|lt:${t.limitType}`}function Zh(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Ph(t))).join(", ")}]`),Fu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>hh(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>hh(t))).join(",")),`Target(${e})`}(Xh(t))}; limitType=${t.limitType})`}function td(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ku.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Wh(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Eh(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,Wh(t),e)||t.endAt&&!function(t,e,n){const i=Eh(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,Wh(t),e))}(t,e)}function ed(t,e,n){const i=t.field.isKeyField()?ku.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?lh(i,r):iu()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return iu()}}class nd{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ju(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return $u(this.inner)}size(){return this.innerSize}}const id=new Bu(ku.comparator);function rd(){return id}const sd=new Bu(ku.comparator);function od(...t){let e=sd;for(const n of t)e=e.insert(n.key,n);return e}function ad(t){let e=sd;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function cd(){return ud()}function ld(){return ud()}function ud(){return new nd((t=>t.toString()),((t,e)=>t.isEqual(e)))}const hd=new Bu(ku.comparator),dd=new qu(ku.comparator);function fd(...t){let e=dd;for(const n of t)e=e.add(n);return e}const pd=new qu(wu);function gd(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uu(e)?"-0":e}}function md(t){return{integerValue:""+t}}function yd(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Uu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?md(e):gd(t,e)}class vd{constructor(){this._=void 0}}function wd(t,e,n){return t instanceof Ed?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&th(e)&&(e=eh(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Td?_d(t,e):t instanceof Sd?Cd(t,e):function(t,e){const n=bd(t,e),i=Ad(n)+Ad(t.Te);return fh(n)&&fh(t.Te)?md(i):gd(t.serializer,i)}(t,e)}function Id(t,e,n){return t instanceof Td?_d(t,e):t instanceof Sd?Cd(t,e):n}function bd(t,e){return t instanceof kd?function(t){return fh(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Ed extends vd{}class Td extends vd{constructor(t){super(),this.elements=t}}function _d(t,e){const n=Dd(e);for(const e of t.elements)n.some((t=>ah(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Sd extends vd{constructor(t){super(),this.elements=t}}function Cd(t,e){let n=Dd(e);for(const e of t.elements)n=n.filter((t=>!ah(t,e)));return{arrayValue:{values:n}}}class kd extends vd{constructor(t,e){super(),this.serializer=t,this.Te=e}}function Ad(t){return Yu(t.integerValue||t.doubleValue)}function Dd(t){return ph(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Nd{constructor(t,e){this.field=t,this.transform=e}}class Od{constructor(t,e){this.version=t,this.transformResults=e}}class Rd{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Rd}static exists(t){return new Rd(void 0,t)}static updateTime(t){return new Rd(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Pd(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Ld{}function Md(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new qd(t.key,Rd.none()):new jd(t.key,t.data,Rd.none());{const n=t.data,i=vh.empty();let r=new qu(Cu.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new $d(t.key,i,new Gu(r.toArray()),Rd.none())}}function xd(t,e,n){t instanceof jd?function(t,e,n){const i=t.value.clone(),r=zd(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof $d?function(t,e,n){if(!Pd(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=zd(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Bd(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Fd(t,e,n,i){return t instanceof jd?function(t,e,n,i){if(!Pd(t.precondition,e))return n;const r=t.value.clone(),s=Hd(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof $d?function(t,e,n,i){if(!Pd(t.precondition,e))return n;const r=Hd(t.fieldTransforms,i,e),s=e.data;return s.setAll(Bd(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Pd(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Ud(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=bd(i.transform,t||null);null!=r&&(null===n&&(n=vh.empty()),n.set(i.field,r))}return n||null}function Vd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Iu(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Td&&e instanceof Td||t instanceof Sd&&e instanceof Sd?Iu(t.elements,e.elements,ah):t instanceof kd&&e instanceof kd?ah(t.Te,e.Te):t instanceof Ed&&e instanceof Ed}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jd extends Ld{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $d extends Ld{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Bd(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function zd(t,e,n){const i=new Map;ru(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Id(o,a,n[r]))}return i}function Hd(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,wd(t,s,e))}return i}class qd extends Ld{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Kd extends Ld{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gd{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&xd(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Fd(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Fd(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=ld();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Md(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Eu.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),fd())}isEqual(t){return this.batchId===t.batchId&&Iu(this.mutations,t.mutations,((t,e)=>Vd(t,e)))&&Iu(this.baseMutations,t.baseMutations,((t,e)=>Vd(t,e)))}}class Wd{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){ru(t.mutations.length===n.length);let i=hd;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new Wd(t,e,n,i)}}class Xd{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var Qd,Jd;(Jd=Qd||(Qd={}))[Jd.OK=0]="OK",Jd[Jd.CANCELLED=1]="CANCELLED",Jd[Jd.UNKNOWN=2]="UNKNOWN",Jd[Jd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jd[Jd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jd[Jd.NOT_FOUND=5]="NOT_FOUND",Jd[Jd.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jd[Jd.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jd[Jd.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jd[Jd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jd[Jd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jd[Jd.ABORTED=10]="ABORTED",Jd[Jd.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jd[Jd.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jd[Jd.INTERNAL=13]="INTERNAL",Jd[Jd.UNAVAILABLE=14]="UNAVAILABLE",Jd[Jd.DATA_LOSS=15]="DATA_LOSS",new Gl([4294967295,4294967295],0);class Yd{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Zd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tf(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ef(t,e){return Zd(t,e.toTimestamp())}function nf(t){return ru(!!t),Eu.fromTimestamp(function(t){const e=Ju(t);return new bu(e.seconds,e.nanos)}(t))}function rf(t,e){return function(t){return new _u(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function sf(t,e){return rf(t.databaseId,e.path)}function of(t){const e=function(t){const e=_u.fromString(t);return ru(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?_u.emptyPath():function(t){return ru(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function af(t,e,n){return{name:sf(t,e),fields:n.value.mapValue.fields}}function cf(t){let e=of(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ru(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=lf(t);return e instanceof Ah&&Nh(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new _h(uf(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Fu(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new bh(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new bh(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new Kh(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,l)}function lf(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=uf(t.unaryFilter.field);return kh.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=uf(t.unaryFilter.field);return kh.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=uf(t.unaryFilter.field);return kh.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=uf(t.unaryFilter.field);return kh.create(r,"!=",{nullValue:"NULL_VALUE"});default:return iu()}}(t):void 0!==t.fieldFilter?function(t){return kh.create(uf(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return iu()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Ah.create(t.compositeFilter.filters.map((t=>lf(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return iu()}}(t.compositeFilter.op))}(t):iu()}function uf(t){return Cu.fromServerFormat(t.fieldPath)}function hf(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class df{constructor(t){this.ct=t}}function ff(t){const e=cf({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Qh(e,e.limit,"L"):e}class pf{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(Yu(t.integerValue));else if("doubleValue"in t){const n=Yu(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),Uu(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(Zu(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?yh(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):iu()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),ku.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}pf.bt=new pf;class gf{constructor(){this.sn=new mf}addToCollectionParentIndex(t,e){return this.sn.add(e),Lu.resolve()}getCollectionParents(t,e){return Lu.resolve(this.sn.getEntries(e))}addFieldIndex(t,e){return Lu.resolve()}deleteFieldIndex(t,e){return Lu.resolve()}getDocumentsMatchingTarget(t,e){return Lu.resolve(null)}getIndexType(t,e){return Lu.resolve(0)}getFieldIndexes(t,e){return Lu.resolve([])}getNextCollectionGroupToUpdate(t){return Lu.resolve(null)}getMinOffset(t,e){return Lu.resolve(Du.min())}getMinOffsetFromCollectionGroup(t,e){return Lu.resolve(Du.min())}updateCollectionGroup(t,e,n){return Lu.resolve()}updateIndexEntries(t,e){return Lu.resolve()}}class mf{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new qu(_u.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new qu(_u.comparator)).toArray()}}new Uint8Array(0);class yf{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new yf(t,yf.DEFAULT_COLLECTION_PERCENTILE,yf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}yf.DEFAULT_COLLECTION_PERCENTILE=10,yf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yf.DEFAULT=new yf(41943040,yf.DEFAULT_COLLECTION_PERCENTILE,yf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yf.DISABLED=new yf(-1,0,0);class vf{constructor(t){this.Mn=t}next(){return this.Mn+=2,this.Mn}static xn(){return new vf(0)}static On(){return new vf(-1)}}class wf{constructor(){this.changes=new nd((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ih.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Lu.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class If{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class bf{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&Fd(n.mutation,t,Gu.empty(),bu.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,fd()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=fd()){const i=cd();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=od();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=cd();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,fd())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=rd();const s=ud(),o=ud();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof $d)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),Fd(o.mutation,e,o.mutation.getFieldMask(),bu.now())):s.set(e.key,Gu.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new If(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=ud();let i=new Bu(((t,e)=>t-e)),r=fd();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||Gu.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||fd()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=ld();c.forEach((t=>{if(!r.has(t)){const i=Md(e.get(t),n.get(t));null!==i&&l.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Lu.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return ku.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):Lu.resolve(cd());let o=-1,a=r;return s.next((e=>Lu.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?Lu.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,fd()))).next((t=>({batchId:o,changes:ad(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new ku(e)).next((t=>{let e=od();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let r=od();return this.indexManager.getCollectionParents(t,i).next((s=>Lu.forEach(s,(s=>{const o=function(t,e){return new Kh(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((r=>(i=r,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i)))).next((t=>{i.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Ih.newInvalidDocument(i)))}));let n=od();return t.forEach(((t,r)=>{const s=i.get(t);void 0!==s&&Fd(s.mutation,r,Gu.empty(),bu.now()),td(e,r)&&(n=n.insert(t,r))})),n}))}}class Ef{constructor(t){this.serializer=t,this.ar=new Map,this.ur=new Map}getBundleMetadata(t,e){return Lu.resolve(this.ar.get(e))}saveBundleMetadata(t,e){return this.ar.set(e.id,function(t){return{id:t.id,version:t.version,createTime:nf(t.createTime)}}(e)),Lu.resolve()}getNamedQuery(t,e){return Lu.resolve(this.ur.get(e))}saveNamedQuery(t,e){return this.ur.set(e.name,function(t){return{name:t.name,query:ff(t.bundledQuery),readTime:nf(t.readTime)}}(e)),Lu.resolve()}}class Tf{constructor(){this.overlays=new Bu(ku.comparator),this.cr=new Map}getOverlay(t,e){return Lu.resolve(this.overlays.get(e))}getOverlays(t,e){const n=cd();return Lu.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Lu.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.cr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.cr.delete(n)),Lu.resolve()}getOverlaysForCollection(t,e,n){const i=cd(),r=e.length+1,s=new ku(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Lu.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new Bu(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=cd(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=cd(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Lu.resolve(o)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.cr.get(i.largestBatchId).delete(n.key);this.cr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Xd(e,n));let r=this.cr.get(e);void 0===r&&(r=fd(),this.cr.set(e,r)),this.cr.set(e,r.add(n.key))}}class _f{constructor(){this.lr=new qu(Sf.hr),this.Pr=new qu(Sf.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(t,e){const n=new Sf(t,e);this.lr=this.lr.add(n),this.Pr=this.Pr.add(n)}Tr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Er(new Sf(t,e))}dr(t,e){t.forEach((t=>this.removeReference(t,e)))}Ar(t){const e=new ku(new _u([])),n=new Sf(e,t),i=new Sf(e,t+1),r=[];return this.Pr.forEachInRange([n,i],(t=>{this.Er(t),r.push(t.key)})),r}Rr(){this.lr.forEach((t=>this.Er(t)))}Er(t){this.lr=this.lr.delete(t),this.Pr=this.Pr.delete(t)}Vr(t){const e=new ku(new _u([])),n=new Sf(e,t),i=new Sf(e,t+1);let r=fd();return this.Pr.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Sf(t,0),n=this.lr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Sf{constructor(t,e){this.key=t,this.mr=e}static hr(t,e){return ku.comparator(t.key,e.key)||wu(t.mr,e.mr)}static Ir(t,e){return wu(t.mr,e.mr)||ku.comparator(t.key,e.key)}}class Cf{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.gr=1,this.pr=new qu(Sf.hr)}checkEmpty(t){return Lu.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.gr;this.gr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Gd(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.pr=this.pr.add(new Sf(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Lu.resolve(s)}lookupMutationBatch(t,e){return Lu.resolve(this.yr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.wr(n),r=i<0?0:i;return Lu.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Lu.resolve(0===this.mutationQueue.length?-1:this.gr-1)}getAllMutationBatches(t){return Lu.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Sf(e,0),i=new Sf(e,Number.POSITIVE_INFINITY),r=[];return this.pr.forEachInRange([n,i],(t=>{const e=this.yr(t.mr);r.push(e)})),Lu.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new qu(wu);return e.forEach((t=>{const e=new Sf(t,0),i=new Sf(t,Number.POSITIVE_INFINITY);this.pr.forEachInRange([e,i],(t=>{n=n.add(t.mr)}))})),Lu.resolve(this.Sr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;ku.isDocumentKey(r)||(r=r.child(""));const s=new Sf(new ku(r),0);let o=new qu(wu);return this.pr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.mr)),!0)}),s),Lu.resolve(this.Sr(o))}Sr(t){const e=[];return t.forEach((t=>{const n=this.yr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){ru(0===this.br(e.batchId,"removed")),this.mutationQueue.shift();let n=this.pr;return Lu.forEach(e.mutations,(i=>{const r=new Sf(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.pr=n}))}Cn(t){}containsKey(t,e){const n=new Sf(e,0),i=this.pr.firstAfterOrEqual(n);return Lu.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Lu.resolve()}br(t,e){return this.wr(t)}wr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}yr(t){const e=this.wr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class kf{constructor(t){this.Dr=t,this.docs=new Bu(ku.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.Dr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Lu.resolve(n?n.document.mutableCopy():Ih.newInvalidDocument(e))}getEntries(t,e){let n=rd();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ih.newInvalidDocument(t))})),Lu.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=rd();const s=e.path,o=new ku(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||Nu(Au(o),n)<=0||(i.has(o.key)||td(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Lu.resolve(r)}getAllFromCollectionGroup(t,e,n,i){iu()}vr(t,e){return Lu.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Af(this)}getSize(t){return Lu.resolve(this.size)}}class Af extends wf{constructor(t){super(),this.sr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.sr.addEntry(t,i)):this.sr.removeEntry(n)})),Lu.waitFor(e)}getFromCache(t,e){return this.sr.getEntry(t,e)}getAllFromCache(t,e){return this.sr.getEntries(t,e)}}class Df{constructor(t){this.persistence=t,this.Cr=new nd((t=>Hh(t)),qh),this.lastRemoteSnapshotVersion=Eu.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new _f,this.targetCount=0,this.Or=vf.xn()}forEachTarget(t,e){return this.Cr.forEach(((t,n)=>e(n))),Lu.resolve()}getLastRemoteSnapshotVersion(t){return Lu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Lu.resolve(this.Fr)}allocateTargetId(t){return this.highestTargetId=this.Or.next(),Lu.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Fr&&(this.Fr=e),Lu.resolve()}Ln(t){this.Cr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Or=new vf(e),this.highestTargetId=e),t.sequenceNumber>this.Fr&&(this.Fr=t.sequenceNumber)}addTargetData(t,e){return this.Ln(e),this.targetCount+=1,Lu.resolve()}updateTargetData(t,e){return this.Ln(e),Lu.resolve()}removeTargetData(t,e){return this.Cr.delete(e.target),this.Mr.Ar(e.targetId),this.targetCount-=1,Lu.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Cr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Cr.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Lu.waitFor(r).next((()=>i))}getTargetCount(t){return Lu.resolve(this.targetCount)}getTargetData(t,e){const n=this.Cr.get(e)||null;return Lu.resolve(n)}addMatchingKeys(t,e,n){return this.Mr.Tr(e,n),Lu.resolve()}removeMatchingKeys(t,e,n){this.Mr.dr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Lu.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Mr.Ar(e),Lu.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Mr.Vr(e);return Lu.resolve(n)}containsKey(t,e){return Lu.resolve(this.Mr.containsKey(e))}}class Nf{constructor(t,e){this.Nr={},this.overlays={},this.Br=new xu(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=t(this),this.kr=new Df(this),this.indexManager=new gf,this.remoteDocumentCache=function(t){return new kf(t)}((t=>this.referenceDelegate.qr(t))),this.serializer=new df(e),this.Qr=new Ef(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Tf,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Nr[t.toKey()];return n||(n=new Cf(e,this.referenceDelegate),this.Nr[t.toKey()]=n),n}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(t,e,n){Zl("MemoryPersistence","Starting transaction:",t);const i=new Of(this.Br.next());return this.referenceDelegate.Kr(),n(i).next((t=>this.referenceDelegate.$r(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ur(t,e){return Lu.or(Object.values(this.Nr).map((n=>()=>n.containsKey(t,e))))}}class Of extends Ru{constructor(t){super(),this.currentSequenceNumber=t}}class Rf{constructor(t){this.persistence=t,this.Wr=new _f,this.Gr=null}static zr(t){return new Rf(t)}get jr(){if(this.Gr)return this.Gr;throw iu()}addReference(t,e,n){return this.Wr.addReference(n,e),this.jr.delete(n.toString()),Lu.resolve()}removeReference(t,e,n){return this.Wr.removeReference(n,e),this.jr.add(n.toString()),Lu.resolve()}markPotentiallyOrphaned(t,e){return this.jr.add(e.toString()),Lu.resolve()}removeTarget(t,e){this.Wr.Ar(e.targetId).forEach((t=>this.jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Kr(){this.Gr=new Set}$r(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Lu.forEach(this.jr,(n=>{const i=ku.fromPath(n);return this.Hr(t,i).next((t=>{t||e.removeEntry(i,Eu.min())}))})).next((()=>(this.Gr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Hr(t,e).next((t=>{t?this.jr.delete(e.toString()):this.jr.add(e.toString())}))}qr(t){return 0}Hr(t,e){return Lu.or([()=>Lu.resolve(this.Wr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ur(t,e)])}}class Pf{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Li=n,this.ki=i}static qi(t,e){let n=fd(),i=fd();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Pf(t,e.fromCache,n,i)}}class Lf{constructor(){this.Qi=!1}initialize(t,e){this.Ki=t,this.indexManager=e,this.Qi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.$i(t,e).next((r=>r||this.Ui(t,e,i,n))).next((n=>n||this.Wi(t,e)))}$i(t,e){if(Gh(e))return Lu.resolve(null);let n=Xh(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=Qh(e,null,"F"),n=Xh(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=fd(...i);return this.Ki.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Gi(e,i);return this.zi(e,s,r,n.readTime)?this.$i(t,Qh(e,null,"F")):this.ji(t,s,e,n)}))))})))))}Ui(t,e,n,i){return Gh(e)||i.isEqual(Eu.min())?this.Wi(t,e):this.Ki.getDocuments(t,n).next((r=>{const s=this.Gi(e,r);return this.zi(e,s,n,i)?this.Wi(t,e):(Yl()<=F.DEBUG&&Zl("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zh(e)),this.ji(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=Eu.fromTimestamp(1e9===i?new bu(n+1,0):new bu(n,i));return new Du(r,ku.empty(),e)}(i,-1)))}))}Gi(t,e){let n=new qu(function(t){return(e,n)=>{let i=!1;for(const r of Wh(t)){const t=ed(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{td(t,i)&&(n=n.add(i))})),n}zi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Wi(t,e){return Yl()<=F.DEBUG&&Zl("QueryEngine","Using full collection scan to execute query:",Zh(e)),this.Ki.getDocumentsMatchingQuery(t,e,Du.min())}ji(t,e,n,i){return this.Ki.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Mf{constructor(t,e,n,i){this.persistence=t,this.Hi=e,this.serializer=i,this.Ji=new Bu(wu),this.Yi=new nd((t=>Hh(t)),qh),this.Zi=new Map,this.Xi=t.getRemoteDocumentCache(),this.kr=t.getTargetCache(),this.Qr=t.getBundleCache(),this.es(n)}es(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new bf(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ji)))}}async function xf(t,e){const n=su(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n.es(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=fd();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ts:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function Ff(t,e){const n=su(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class Uf{constructor(){this.activeTargetIds=pd}hs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ps(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ls(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Vf{constructor(){this.Hs=new Uf,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Hs.hs(t),this.Js[t]||"not-current"}updateQueryState(t,e,n){this.Js[t]=e}removeLocalQueryTarget(t){this.Hs.Ps(t)}isLocalQueryTarget(t){return this.Hs.activeTargetIds.has(t)}clearQueryState(t){delete this.Js[t]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(t){return this.Hs.activeTargetIds.has(t)}start(){return this.Hs=new Uf,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class jf{Ys(t){}shutdown(){}}class $f{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(t){this.ro.push(t)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){Zl("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ro)t(0)}no(){Zl("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ro)t(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Bf=null;function zf(){return null===Bf?Bf=268435456+Math.round(2147483648*Math.random()):Bf++,"0x"+Bf.toString(16)}const Hf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class qf{constructor(t){this.so=t.so,this.oo=t.oo}_o(t){this.ao=t}uo(t){this.co=t}onMessage(t){this.lo=t}close(){this.oo()}send(t){this.so(t)}ho(){this.ao()}Po(t){this.co(t)}Io(t){this.lo(t)}}const Kf="WebChannelConnection";class Gf extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.To=e+"://"+t.host,this.Eo=`projects/${n}/databases/${i}`,this.Ao="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Ro(){return!1}Vo(t,e,n,i,r){const s=zf(),o=this.mo(t,e);Zl("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Eo,"x-goog-request-params":this.Ao};return this.fo(a,i,r),this.po(t,o,a,n).then((e=>(Zl("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw eu("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}yo(t,e,n,i,r,s){return this.Vo(t,e,n,i,r)}fo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ql,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}mo(t,e){const n=Hf[t];return`${this.To}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}po(t,e,n,i){const r=zf();return new Promise(((s,o)=>{const a=new Kl;a.setWithCredentials(!0),a.listenOnce($l.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case jl.NO_ERROR:const e=a.getResponseJson();Zl(Kf,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),s(e);break;case jl.TIMEOUT:Zl(Kf,`RPC '${t}' ${r} timed out`),o(new au(ou.DEADLINE_EXCEEDED,"Request time out"));break;case jl.HTTP_ERROR:const n=a.getStatus();if(Zl(Kf,`RPC '${t}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(ou).indexOf(e)>=0?e:ou.UNKNOWN}(e.status);o(new au(t,e.message))}else o(new au(ou.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new au(ou.UNAVAILABLE,"Connection failed."));break;default:iu()}}finally{Zl(Kf,`RPC '${t}' ${r} completed.`)}}));const c=JSON.stringify(i);Zl(Kf,`RPC '${t}' ${r} sending request:`,i),a.send(e,"POST",c,n,15)}))}wo(t,e,n){const i=zf(),r=[this.To,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Ul(),o=Vl(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.xmlHttpFactory=new Hl({})),this.fo(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=r.join("");Zl(Kf,`Creating RPC '${t}' stream ${i}: ${l}`,a);const u=s.createWebChannel(l,a);let h=!1,d=!1;const f=new qf({so:e=>{d?Zl(Kf,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(h||(Zl(Kf,`Opening RPC '${t}' stream ${i} transport.`),u.open(),h=!0),Zl(Kf,`RPC '${t}' stream ${i} sending:`,e),u.send(e))},oo:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,ql.EventType.OPEN,(()=>{d||Zl(Kf,`RPC '${t}' stream ${i} transport opened.`)})),p(u,ql.EventType.CLOSE,(()=>{d||(d=!0,Zl(Kf,`RPC '${t}' stream ${i} transport closed`),f.Po())})),p(u,ql.EventType.ERROR,(e=>{d||(d=!0,eu(Kf,`RPC '${t}' stream ${i} transport errored:`,e),f.Po(new au(ou.UNAVAILABLE,"The operation could not be completed")))})),p(u,ql.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];ru(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Zl(Kf,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=Qd[t];if(void 0!==e)return function(t){if(void 0===t)return tu("GRPC error has no .code"),ou.UNKNOWN;switch(t){case Qd.OK:return ou.OK;case Qd.CANCELLED:return ou.CANCELLED;case Qd.UNKNOWN:return ou.UNKNOWN;case Qd.DEADLINE_EXCEEDED:return ou.DEADLINE_EXCEEDED;case Qd.RESOURCE_EXHAUSTED:return ou.RESOURCE_EXHAUSTED;case Qd.INTERNAL:return ou.INTERNAL;case Qd.UNAVAILABLE:return ou.UNAVAILABLE;case Qd.UNAUTHENTICATED:return ou.UNAUTHENTICATED;case Qd.INVALID_ARGUMENT:return ou.INVALID_ARGUMENT;case Qd.NOT_FOUND:return ou.NOT_FOUND;case Qd.ALREADY_EXISTS:return ou.ALREADY_EXISTS;case Qd.PERMISSION_DENIED:return ou.PERMISSION_DENIED;case Qd.FAILED_PRECONDITION:return ou.FAILED_PRECONDITION;case Qd.ABORTED:return ou.ABORTED;case Qd.OUT_OF_RANGE:return ou.OUT_OF_RANGE;case Qd.UNIMPLEMENTED:return ou.UNIMPLEMENTED;case Qd.DATA_LOSS:return ou.DATA_LOSS;default:return iu()}}(e)}(e),r=o.message;void 0===n&&(n=ou.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),d=!0,f.Po(new au(n,r)),u.close()}else Zl(Kf,`RPC '${t}' stream ${i} received:`,r),f.Io(r)}})),p(o,Bl.STAT_EVENT,(e=>{e.stat===zl.PROXY?Zl(Kf,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===zl.NOPROXY&&Zl(Kf,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.ho()}),0),f}}function Wf(){return"undefined"!=typeof document?document:null}function Xf(t){return new Yd(t,!0)}class Qf{constructor(t,e,n=1e3,i=1.5,r=6e4){this.ii=t,this.timerId=e,this.So=n,this.bo=i,this.Do=r,this.vo=0,this.Co=null,this.Fo=Date.now(),this.reset()}reset(){this.vo=0}Mo(){this.vo=this.Do}xo(t){this.cancel();const e=Math.floor(this.vo+this.Oo()),n=Math.max(0,Date.now()-this.Fo),i=Math.max(0,e-n);i>0&&Zl("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.vo} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Co=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Fo=Date.now(),t()))),this.vo*=this.bo,this.vo<this.So&&(this.vo=this.So),this.vo>this.Do&&(this.vo=this.Do)}No(){null!==this.Co&&(this.Co.skipDelay(),this.Co=null)}cancel(){null!==this.Co&&(this.Co.cancel(),this.Co=null)}Oo(){return(Math.random()-.5)*this.vo}}class Jf{constructor(t,e,n,i,r,s,o,a){this.ii=t,this.Bo=n,this.Lo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.ko=0,this.qo=null,this.Qo=null,this.stream=null,this.Ko=new Qf(t,e)}$o(){return 1===this.state||5===this.state||this.Uo()}Uo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Wo()}async stop(){this.$o()&&await this.close(0)}Go(){this.state=0,this.Ko.reset()}zo(){this.Uo()&&null===this.qo&&(this.qo=this.ii.enqueueAfterDelay(this.Bo,6e4,(()=>this.jo())))}Ho(t){this.Jo(),this.stream.send(t)}async jo(){if(this.Uo())return this.close(0)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}Yo(){this.Qo&&(this.Qo.cancel(),this.Qo=null)}async close(t,e){this.Jo(),this.Yo(),this.Ko.cancel(),this.ko++,4!==t?this.Ko.reset():e&&e.code===ou.RESOURCE_EXHAUSTED?(tu(e.toString()),tu("Using maximum backoff delay to prevent overloading the backend."),this.Ko.Mo()):e&&e.code===ou.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Zo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.uo(e)}Zo(){}auth(){this.state=1;const t=this.Xo(this.ko),e=this.ko;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.ko===e&&this.e_(t,n)}),(e=>{t((()=>{const t=new au(ou.UNKNOWN,"Fetching auth token failed: "+e.message);return this.t_(t)}))}))}e_(t,e){const n=this.Xo(this.ko);this.stream=this.n_(t,e),this.stream._o((()=>{n((()=>(this.state=2,this.Qo=this.ii.enqueueAfterDelay(this.Lo,1e4,(()=>(this.Uo()&&(this.state=3),Promise.resolve()))),this.listener._o())))})),this.stream.uo((t=>{n((()=>this.t_(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Wo(){this.state=5,this.Ko.xo((async()=>{this.state=0,this.start()}))}t_(t){return Zl("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Xo(t){return e=>{this.ii.enqueueAndForget((()=>this.ko===t?e():(Zl("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Yf extends Jf{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r,this.o_=!1}get __(){return this.o_}start(){this.o_=!1,this.lastStreamToken=void 0,super.start()}Zo(){this.o_&&this.a_([])}n_(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(ru(!!t.streamToken),this.lastStreamToken=t.streamToken,this.o_){this.Ko.reset();const e=function(t,e){return t&&t.length>0?(ru(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?nf(t.updateTime):nf(e);return n.isEqual(Eu.min())&&(n=nf(e)),new Od(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=nf(t.commitTime);return this.listener.u_(n,e)}return ru(!t.writeResults||0===t.writeResults.length),this.o_=!0,this.listener.c_()}l_(){const t={};t.database=function(t){return new _u(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.serializer),this.Ho(t)}a_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof jd)n={update:af(t,e.key,e.value)};else if(e instanceof qd)n={delete:sf(t,e.key)};else if(e instanceof $d)n={update:af(t,e.key,e.data),updateMask:hf(e.fieldMask)};else{if(!(e instanceof Kd))return iu();n={verify:sf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Ed)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Td)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Sd)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof kd)return{fieldPath:e.field.canonicalString(),increment:n.Te};throw iu()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ef(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:iu()}(t,e.precondition)),n}(this.serializer,t)))};this.Ho(e)}}class Zf extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.h_=!1}P_(){if(this.h_)throw new au(ou.FAILED_PRECONDITION,"The client has already been terminated.")}Vo(t,e,n){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.Vo(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ou.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new au(ou.UNKNOWN,t.toString())}))}yo(t,e,n,i){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.yo(t,e,n,r,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ou.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new au(ou.UNKNOWN,t.toString())}))}terminate(){this.h_=!0}}class tp{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.T_=0,this.E_=null,this.d_=!0}A_(){0===this.T_&&(this.R_("Unknown"),this.E_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.E_=null,this.V_("Backend didn't respond within 10 seconds."),this.R_("Offline"),Promise.resolve()))))}m_(t){"Online"===this.state?this.R_("Unknown"):(this.T_++,this.T_>=1&&(this.f_(),this.V_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.R_("Offline")))}set(t){this.f_(),this.T_=0,"Online"===t&&(this.d_=!1),this.R_(t)}R_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}V_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.d_?(tu(e),this.d_=!1):Zl("OnlineStateTracker",e)}f_(){null!==this.E_&&(this.E_.cancel(),this.E_=null)}}class ep{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.g_=[],this.p_=new Map,this.y_=new Set,this.w_=[],this.S_=r,this.S_.Ys((t=>{n.enqueueAndForget((async()=>{rp(this)&&(Zl("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=su(t);e.y_.add(4),await ip(e),e.b_.set("Unknown"),e.y_.delete(4),await np(e)}(this))}))})),this.b_=new tp(n,i)}}async function np(t){if(rp(t))for(const e of t.w_)await e(!0)}async function ip(t){for(const e of t.w_)await e(!1)}function rp(t){return 0===su(t).y_.size}async function sp(t,e,n){if(!Mu(e))throw e;t.y_.add(1),await ip(t),t.b_.set("Offline"),n||(n=()=>function(t){const e=su(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.kr.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Zl("RemoteStore","Retrying IndexedDB access"),await n(),t.y_.delete(1),await np(t)}))}function op(t,e){return e().catch((n=>sp(t,n,e)))}async function ap(t){const e=su(t),n=yp(e);let i=e.g_.length>0?e.g_[e.g_.length-1].batchId:-1;for(;cp(e);)try{const t=await Ff(e.localStore,i);if(null===t){0===e.g_.length&&n.zo();break}i=t.batchId,lp(e,t)}catch(t){await sp(e,t)}up(e)&&hp(e)}function cp(t){return rp(t)&&t.g_.length<10}function lp(t,e){t.g_.push(e);const n=yp(t);n.Uo()&&n.__&&n.a_(e.mutations)}function up(t){return rp(t)&&!yp(t).$o()&&t.g_.length>0}function hp(t){yp(t).start()}async function dp(t){yp(t).l_()}async function fp(t){const e=yp(t);for(const n of t.g_)e.a_(n.mutations)}async function pp(t,e,n){const i=t.g_.shift(),r=Wd.from(i,e,n);await op(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await ap(t)}async function gp(t,e){e&&yp(t).__&&await async function(t,e){if(function(t){return function(t){switch(t){default:return iu();case ou.CANCELLED:case ou.UNKNOWN:case ou.DEADLINE_EXCEEDED:case ou.RESOURCE_EXHAUSTED:case ou.INTERNAL:case ou.UNAVAILABLE:case ou.UNAUTHENTICATED:return!1;case ou.INVALID_ARGUMENT:case ou.NOT_FOUND:case ou.ALREADY_EXISTS:case ou.PERMISSION_DENIED:case ou.FAILED_PRECONDITION:case ou.ABORTED:case ou.OUT_OF_RANGE:case ou.UNIMPLEMENTED:case ou.DATA_LOSS:return!0}}(t)&&t!==ou.ABORTED}(e.code)){const n=t.g_.shift();yp(t).Go(),await op(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await ap(t)}}(t,e),up(t)&&hp(t)}async function mp(t,e){const n=su(t);n.asyncQueue.verifyOperationInProgress(),Zl("RemoteStore","RemoteStore received new credentials");const i=rp(n);n.y_.add(3),await ip(n),i&&n.b_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.y_.delete(3),await np(n)}function yp(t){return t.C_||(t.C_=function(t,e,n){const i=su(t);return i.P_(),new Yf(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{_o:dp.bind(null,t),uo:gp.bind(null,t),c_:fp.bind(null,t),u_:pp.bind(null,t)}),t.w_.push((async e=>{e?(t.C_.Go(),await ap(t)):(await t.C_.stop(),t.g_.length>0&&(Zl("RemoteStore",`Stopping write stream with ${t.g_.length} pending writes`),t.g_=[]))}))),t.C_}class vp{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new cu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new vp(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new au(ou.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wp(t,e){if(tu("AsyncQueue",`${e}: ${t}`),Mu(t))return new au(ou.UNAVAILABLE,`${e}: ${t}`);throw t}class Ip{constructor(){this.queries=new nd((t=>Yh(t)),Jh),this.onlineState="Unknown",this.O_=new Set}}class bp{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Ta={},this.Ea=new nd((t=>Yh(t)),Jh),this.da=new Map,this.Aa=new Set,this.Ra=new Bu(ku.comparator),this.Va=new Map,this.ma=new _f,this.fa={},this.ga=new Map,this.pa=vf.On(),this.onlineState="Unknown",this.ya=void 0}get isPrimaryClient(){return!0===this.ya}}function Ep(t,e,n){const i=su(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.Ea.forEach(((n,i)=>{const r=i.view.N_(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=su(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.N_(e)&&(i=!0)})),i&&function(t){t.O_.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.Ta.r_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Tp(t,e){const n=su(t),i=e.batch.batchId;try{const t=await function(t,e){const n=su(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.Xi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Lu.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);ru(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=fd();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Cp(n,i,null),Sp(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await kp(n,t)}catch(t){await Pu(t)}}async function _p(t,e,n){const i=su(t);try{const t=await function(t,e){const n=su(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(ru(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Cp(i,e,n),Sp(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await kp(i,t)}catch(n){await Pu(n)}}function Sp(t,e){(t.ga.get(e)||[]).forEach((t=>{t.resolve()})),t.ga.delete(e)}function Cp(t,e,n){const i=su(t);let r=i.fa[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.fa[i.currentUser.toKey()]=r}}async function kp(t,e,n){const i=su(t),r=[],s=[],o=[];i.Ea.isEmpty()||(i.Ea.forEach(((t,a)=>{o.push(i.wa(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=Pf.qi(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.Ta.r_(r),await async function(t,e){const n=su(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Lu.forEach(e,(e=>Lu.forEach(e.Li,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Lu.forEach(e.ki,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Mu(t))throw t;Zl("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ji.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(e,r)}}}(i.localStore,s))}async function Ap(t,e){const n=su(t);if(!n.currentUser.isEqual(e)){Zl("SyncEngine","User change. New user:",e.toKey());const t=await xf(n.localStore,e);n.currentUser=e,function(t,e){t.ga.forEach((t=>{t.forEach((t=>{t.reject(new au(ou.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ga.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await kp(n,t.ts)}}function Dp(t){const e=su(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Tp.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_p.bind(null,e),e}class Np{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Xf(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new Mf(t,e,n,i)}(this.persistence,new Lf,t.initialUser,this.serializer)}createPersistence(t){return new Nf(Rf.zr,this.serializer)}createSharedClientState(t){return new Vf}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Op{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Ep(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ap.bind(null,this.syncEngine),await async function(t,e){const n=su(t);e?(n.y_.delete(2),await np(n)):e||(n.y_.add(2),await ip(n),n.b_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Ip}createDatastore(t){const e=Xf(t.databaseInfo.databaseId),n=function(t){return new Gf(t)}(t.databaseInfo);return function(t,e,n,i){return new Zf(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new ep(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>Ep(this.syncEngine,t,0)),$f.v()?new $f:new jf)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new bp(t,e,n,i,r,s);return o&&(a.ya=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=su(t);Zl("RemoteStore","RemoteStore shutting down."),e.y_.add(5),await ip(e),e.S_.shutdown(),e.b_.set("Unknown")}(this.remoteStore)}}class Rp{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=Xl.UNAUTHENTICATED,this.clientId=vu.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Zl("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Zl("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new au(ou.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new cu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=wp(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Pp(t,e){t.asyncQueue.verifyOperationInProgress(),Zl("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await xf(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Lp(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Zl("FirestoreClient","Using user provided OfflineComponentProvider");try{await Pp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===ou.FAILED_PRECONDITION||t.code===ou.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;eu("Error using user provided cache. Falling back to memory cache: "+n),await Pp(t,new Np)}}else Zl("FirestoreClient","Using default OfflineComponentProvider"),await Pp(t,new Np);return t._offlineComponents}(t);Zl("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>mp(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>mp(e.remoteStore,n))),t._onlineComponents=e}function Mp(t){return async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Zl("FirestoreClient","Using user provided OnlineComponentProvider"),await Lp(t,t._uninitializedComponentsProvider._online)):(Zl("FirestoreClient","Using default OnlineComponentProvider"),await Lp(t,new Op))),t._onlineComponents}(t).then((t=>t.syncEngine))}function xp(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Fp=new Map;function Up(t,e,n){if(!n)throw new au(ou.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Vp(t){if(!ku.isDocumentKey(t))throw new au(ou.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function jp(t){if(ku.isDocumentKey(t))throw new au(ou.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function $p(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":iu()}function Bp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new au(ou.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=$p(t);throw new au(ou.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class zp{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new au(ou.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new au(ou.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new au(ou.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xp(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new au(ou.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new au(ou.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new au(ou.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Hp{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new au(ou.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new au(ou.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zp(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new uu;switch(t.type){case"firstParty":return new pu(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new au(ou.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Fp.get(t);e&&(Zl("ComponentProvider","Removing Datastore"),Fp.delete(t),e.terminate())}(this),Promise.resolve()}}class qp{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new qp(this.firestore,t,this._query)}}class Kp{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gp(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Kp(this.firestore,t,this._key)}}class Gp extends qp{constructor(t,e,n){super(t,e,function(t){return new Kh(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Kp(this.firestore,null,new ku(t))}withConverter(t){return new Gp(this.firestore,t,this._path)}}function Wp(t,e,...n){if(t=O(t),Up("collection","path",e),t instanceof Hp){const i=_u.fromString(e,...n);return jp(i),new Gp(t,null,i)}{if(!(t instanceof Kp||t instanceof Gp))throw new au(ou.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(_u.fromString(e,...n));return jp(i),new Gp(t.firestore,null,i)}}function Xp(t,e,...n){if(t=O(t),1===arguments.length&&(e=vu.V()),Up("doc","path",e),t instanceof Hp){const i=_u.fromString(e,...n);return Vp(i),new Kp(t,null,new ku(i))}{if(!(t instanceof Kp||t instanceof Gp))throw new au(ou.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(_u.fromString(e,...n));return Vp(i),new Kp(t.firestore,t instanceof Gp?t.converter:null,new ku(i))}}class Qp{constructor(){this.Wa=Promise.resolve(),this.Ga=[],this.za=!1,this.ja=[],this.Ha=null,this.Ja=!1,this.Ya=!1,this.Za=[],this.Ko=new Qf(this,"async_queue_retry"),this.Xa=()=>{const t=Wf();t&&Zl("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Ko.No()};const t=Wf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xa)}get isShuttingDown(){return this.za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.eu(),this.tu(t)}enterRestrictedMode(t){if(!this.za){this.za=!0,this.Ya=t||!1;const e=Wf();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Xa)}}enqueue(t){if(this.eu(),this.za)return new Promise((()=>{}));const e=new cu;return this.tu((()=>this.za&&this.Ya?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Ga.push(t),this.nu())))}async nu(){if(0!==this.Ga.length){try{await this.Ga[0](),this.Ga.shift(),this.Ko.reset()}catch(t){if(!Mu(t))throw t;Zl("AsyncQueue","Operation failed with retryable error: "+t)}this.Ga.length>0&&this.Ko.xo((()=>this.nu()))}}tu(t){const e=this.Wa.then((()=>(this.Ja=!0,t().catch((t=>{this.Ha=t,this.Ja=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw tu("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Ja=!1,t))))));return this.Wa=e,e}enqueueAfterDelay(t,e,n){this.eu(),this.Za.indexOf(t)>-1&&(e=0);const i=vp.createAndSchedule(this,t,e,n,(t=>this.ru(t)));return this.ja.push(i),i}eu(){this.Ha&&iu()}verifyOperationInProgress(){}async iu(){let t;do{t=this.Wa,await t}while(t!==this.Wa)}su(t){for(const e of this.ja)if(e.timerId===t)return!0;return!1}ou(t){return this.iu().then((()=>{this.ja.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.ja)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.iu()}))}_u(t){this.Za.push(t)}ru(t){const e=this.ja.indexOf(t);this.ja.splice(e,1)}}class Jp extends Hp{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Qp,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Zp(this),this._firestoreClient.terminate()}}function Yp(t,e){const n="string"==typeof t?t:e||"(default)",i=yt("object"==typeof t?t:Et(),"firestore").getImmediate({identifier:n});if(!i._initialized){const t=c("firestore");t&&function(t,e,n,i={}){var s;const o=(t=Bp(t,Hp))._getSettings(),a=`${e}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&eu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=Xl.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new au(ou.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Xl(o)}t._authCredentials=new hu(new lu(e,n))}}(i,...t)}return i}function Zp(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new ih(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,xp(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new Rp(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class tg{constructor(t){this._byteString=t}static fromBase64String(t){try{return new tg(Xu.fromBase64String(t))}catch(t){throw new au(ou.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new tg(Xu.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class eg{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new au(ou.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cu(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class ng{constructor(t){this._methodName=t}}class ig{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new au(ou.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new au(ou.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return wu(this._lat,t._lat)||wu(this._long,t._long)}}const rg=/^__.*__$/;class sg{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new $d(t,this.data,this.fieldMask,e,this.fieldTransforms):new jd(t,this.data,e,this.fieldTransforms)}}class og{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new $d(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function ag(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw iu()}}class cg{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.au(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get uu(){return this.settings.uu}cu(t){return new cg(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}lu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.cu({path:n,hu:!1});return i.Pu(t),i}Iu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.cu({path:n,hu:!1});return i.au(),i}Tu(t){return this.cu({path:void 0,hu:!0})}Eu(t){return bg(t,this.settings.methodName,this.settings.du||!1,this.path,this.settings.Au)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}au(){if(this.path)for(let t=0;t<this.path.length;t++)this.Pu(this.path.get(t))}Pu(t){if(0===t.length)throw this.Eu("Document fields must not be empty");if(ag(this.uu)&&rg.test(t))throw this.Eu('Document fields cannot begin and end with "__"')}}class lg{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Xf(t)}Ru(t,e,n,i=!1){return new cg({uu:t,methodName:e,Au:n,path:Cu.emptyPath(),hu:!1,du:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ug(t){const e=t._freezeSettings(),n=Xf(t._databaseId);return new lg(t._databaseId,!!e.ignoreUndefinedProperties,n)}function hg(t,e,n,i,r,s={}){const o=t.Ru(s.merge||s.mergeFields?2:0,e,n,r);yg("Data must be an object, but it was:",o,i);const a=gg(i,o);let c,l;if(s.merge)c=new Gu(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=vg(e,i,n);if(!o.contains(r))throw new au(ou.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Eg(t,r)||t.push(r)}c=new Gu(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new sg(new vh(a),c,l)}class dg extends ng{_toFieldTransform(t){if(2!==t.uu)throw 1===t.uu?t.Eu(`${this._methodName}() can only appear at the top level of your update data`):t.Eu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof dg}}class fg extends ng{_toFieldTransform(t){return new Nd(t.path,new Ed)}isEqual(t){return t instanceof fg}}function pg(t,e){if(mg(t=O(t)))return yg("Unsupported field value:",e,t),gg(t,e);if(t instanceof ng)return function(t,e){if(!ag(e.uu))throw e.Eu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Eu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.hu&&4!==e.uu)throw e.Eu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=pg(r,e.Tu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=O(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return yd(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=bu.fromDate(t);return{timestampValue:Zd(e.serializer,n)}}if(t instanceof bu){const n=new bu(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Zd(e.serializer,n)}}if(t instanceof ig)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof tg)return{bytesValue:tf(e.serializer,t._byteString)};if(t instanceof Kp){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.Eu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:rf(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Eu(`Unsupported field value: ${$p(t)}`)}(t,e)}function gg(t,e){const n={};return $u(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ju(t,((t,i)=>{const r=pg(i,e.lu(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function mg(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof bu||t instanceof ig||t instanceof tg||t instanceof Kp||t instanceof ng)}function yg(t,e,n){if(!mg(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=$p(n);throw"an object"===i?e.Eu(t+" a custom object"):e.Eu(t+" "+i)}}function vg(t,e,n){if((e=O(e))instanceof eg)return e._internalPath;if("string"==typeof e)return Ig(t,e);throw bg("Field path arguments must be of type string or ",t,!1,void 0,n)}const wg=new RegExp("[~\\*/\\[\\]]");function Ig(t,e,n){if(e.search(wg)>=0)throw bg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new eg(...e.split("."))._internalPath}catch(i){throw bg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function bg(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new au(ou.INVALID_ARGUMENT,a+t+c)}function Eg(t,e){return t.some((t=>t.isEqual(e)))}function Tg(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}function _g(t,e){return function(t,e){const n=new cu;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Dp(t);try{const t=await function(t,e){const n=su(t),i=bu.now(),r=e.reduce(((t,e)=>t.add(e.key)),fd());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=rd(),c=fd();return n.Xi.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=Ud(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new $d(t.key,e,wh(e.value.mapValue),Rd.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:ad(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.fa[t.currentUser.toKey()];i||(i=new Bu(wu)),i=i.insert(e,n),t.fa[t.currentUser.toKey()]=i}(i,t.batchId,n),await kp(i,t.changes),await ap(i.remoteStore)}catch(t){const e=wp(t,"Failed to persist write");n.reject(e)}}(await Mp(t),e,n))),n.promise}(function(t){return t._firestoreClient||Zp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}function Sg(){return new fg("serverTimestamp")}!function(t,e=!0){!function(t){Ql=t}(It),mt(new R("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Jp(new du(t.getProvider("auth-internal")),new mu(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new au(ou.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rh(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Tt(Wl,"4.1.0",t),Tt(Wl,"4.1.0","esm2017")}();const Cg=Yp(mn);async function kg(t){if("localhost"==window.location.hostname||"127.0.0.1"==window.location.hostname)return;let e=localStorage.getItem("analyticsID_v1");e||(e=Xp(Wp(Cg,"Analytics")).id,localStorage.setItem("analyticsID_v1",e),await function(t,e,n,...i){t=Bp(t,Kp);const r=Bp(t.firestore,Jp),s=ug(r);let o;return o="string"==typeof(e=O(e))||e instanceof eg?function(t,e,n,i,r,s){const o=t.Ru(1,e,n),a=[vg(e,i,n)],c=[r];if(s.length%2!=0)throw new au(ou.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(vg(e,s[t])),c.push(s[t+1]);const l=[],u=vh.empty();for(let t=a.length-1;t>=0;--t)if(!Eg(l,a[t])){const e=a[t];let n=c[t];n=O(n);const i=o.Iu(e);if(n instanceof dg)l.push(e);else{const t=pg(n,i);null!=t&&(l.push(e),u.set(e,t))}}const h=new Gu(l);return new og(u,h,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Ru(1,e,n);yg("Data must be an object, but it was:",r,i);const s=[],o=vh.empty();ju(i,((t,i)=>{const a=Ig(e,t,n);i=O(i);const c=r.Iu(a);if(i instanceof dg)s.push(a);else{const t=pg(i,c);null!=t&&(s.push(a),o.set(a,t))}}));const a=new Gu(s);return new og(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),_g(r,[o.toMutation(t._key,Rd.exists(!0))])}(Xp(Cg,"Analytics","_Aggregate"),{analyticsIDs:firebase.firestore.FieldValue.arrayUnion(e)})),await function(t,e){const n=Bp(t.firestore,Jp),i=Xp(t),r=Tg(t.converter,void 0);return _g(n,[hg(ug(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,Rd.exists(!1))]).then((()=>i))}(Wp(Cg,"Analytics")),Sg(),window.location.pathname}new URLSearchParams(document.location.search).get("source")&&kg();const Ag=es(mn),Dg=function(t=Et(),e=Ts){const n=yt(O(t),ws).getImmediate({identifier:e}),i=c("functions");return i&&function(t,e,n){!function(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}(O(t),e,n)}(n,...i),n}(mn),Ng=Yp(mn);function Og(t){document.querySelector("main").className=t?"loading":""}document.getElementById("signup").addEventListener("submit",(async t=>{Og(!0),t.preventDefault();const e=t.target,n=Object.fromEntries(new FormData(e).entries()),i=document.getElementById("error");if(i.innerText="",i.hidden=!0,n.password!=n.confirmPassword)return i.textContent="Your password does not match",i.hidden=!1,void Og(!1);(async function(t,e,n){var i;const r=Si(t),s={returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(null===(i=r._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled){const t=await Ei(r,s,"signUpPassword");o=Hi(r,t)}else o=Hi(r,s).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const t=await Ei(r,s,"signUpPassword");return Hi(r,t)}return Promise.reject(t)}));const a=await o.catch((t=>Promise.reject(t))),c=await qi._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(c.user),c})(Ag,n.email.trim().toLowerCase(),n.password).then((async t=>{const i=t.user;kg(i.uid),async function(t,{displayName:e,photoURL:n}){if(void 0===e&&void 0===n)return;const i=O(t),r={idToken:await i.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},s=await Kn(i,async function(t,e){return xn(t,"POST","/v1/accounts:update",e)}(i.auth,r));i.displayName=s.displayName||null,i.photoURL=s.photoUrl||null;const o=i.providerData.find((({providerId:t})=>"password"===t));o&&(o.displayName=i.displayName,o.photoURL=i.photoURL),await i._updateTokensIfNecessary(s)}(i,{displayName:n.firstName.trim()+" "+n.lastName.trim()});const r=("addUserRole",Ss(O(Dg),"addUserRole",undefined));await r({role:"student"});const s=Xp(Ng,"Users",i.uid);await function(t,e,n){t=Bp(t,Kp);const i=Bp(t.firestore,Jp),r=Tg(t.converter,e,n);return _g(i,[hg(ug(i),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,Rd.none())])}(s,{firstName:n.firstName.trim(),lastName:n.lastName.trim(),email:n.email.trim().toLowerCase(),role:"student",location:"WIZWBumUoo7Ywkc3pl2G",createdAt:Sg()}),await function(t,e=!1){return O(t).getIdToken(e)}(i,!0),e.reset(),Og(!1),window.location.href=location.origin+`/test-taker/${i.uid}`})).catch((t=>{var e=t.code,n=t.message;console.log(e,n),is.alert(t.message),Og(!1)}))}))})();